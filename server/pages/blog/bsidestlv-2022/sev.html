<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png?v=2"/><link rel="manifest" href="/static/favicons/site.webmanifest?v=2"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg?v=2" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>BSidesTLV 2022 CTF – SEV</title><meta name="robots" content="follow, index"/><meta name="description" content="Steal secret key and get the flag."/><meta property="og:url" content="https://sekai.team/blog/bsidestlv-2022/sev/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Project SEKAI"/><meta property="og:description" content="Steal secret key and get the flag."/><meta property="og:title" content="BSidesTLV 2022 CTF – SEV"/><meta property="og:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=BSidesTLV+2022+CTF+%E2%80%93+SEV&amp;desc=Steal+secret+key+and+get+the+flag.&amp;authors=Radewoosh"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/ProjectSEKAIctf"/><meta name="twitter:title" content="BSidesTLV 2022 CTF – SEV"/><meta name="twitter:description" content="Steal secret key and get the flag."/><meta name="twitter:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=BSidesTLV+2022+CTF+%E2%80%93+SEV&amp;desc=Steal+secret+key+and+get+the+flag.&amp;authors=Radewoosh"/><meta property="article:published_time" content="2022-07-01T00:00:00.000Z"/><link rel="canonical" href="https://sekai.team/blog/bsidestlv-2022/sev/"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sekai.team/blog/bsidestlv-2022/sev"
  },
  "headline": "BSidesTLV 2022 CTF – SEV",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://og-vercel-ruby.vercel.app/api/sekai?title=BSidesTLV+2022+CTF+%E2%80%93+SEV&desc=Steal+secret+key+and+get+the+flag.&authors=Radewoosh"
    }
  ],
  "datePublished": "2022-07-01T00:00:00.000Z",
  "dateModified": "2022-07-01T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Radewoosh"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Project SEKAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sekai.team/static/images/fullLogo.svg"
    }
  },
  "description": "Steal secret key and get the flag."
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/206f24680f6266ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/206f24680f6266ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-09a75c9ee2bd415e.js" defer=""></script><script src="/_next/static/chunks/main-b8c3e234d7065a2c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8cbc7cb85baf88e.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/29107295-a2d0c8e72019a3ed.js" defer=""></script><script src="/_next/static/chunks/545-f1dc6b53ce85b08b.js" defer=""></script><script src="/_next/static/chunks/930-1296a6163e1e3cc6.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-9a47024c9df525b8.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_buildManifest.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_ssgManifest.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Visit home page" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 468.7 215.63" height="80" width="auto"><defs><linearGradient id="fullLogo_svg__linear-gradient" x1="-7051.74" y1="5608.42" x2="-7051.74" y2="5392.1" gradientTransform="matrix(1 0 .15 -.99 6503.98 5547.9)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00e5ea"></stop><stop offset="1" stop-color="#00b5cc"></stop></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-2" x1="1498.32" y1="4428.84" x2="1497.92" y2="4311.82" gradientTransform="matrix(1 0 0 -1 -1107.01 4435.41)" xlink:href="#fullLogo_svg__linear-gradient"></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-3" x1="320.76" y1="14.17" x2="320.76" y2="47.97" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0069a5"></stop><stop offset="1" stop-color="#003d6b"></stop></linearGradient><style>.fullLogo_svg__cls-1{fill:#fff}</style></defs><g id="fullLogo_svg__Project_SEKAI_Wide_White" data-name="Project SEKAI Wide White"><path class="fullLogo_svg__cls-1" d="M107 117.14v-4c11.93 0 22.15-8.62 23.76-20l12.91-91.63h4.06l-13 92.14c-1.92 13.4-13.84 23.49-27.73 23.49Z"></path><path class="fullLogo_svg__cls-1" d="M97.43 98.3a16 16 0 0 1-16.26-18.72l8.68-61.42A21.78 21.78 0 0 1 110.77 0a16.34 16.34 0 0 1 12.57 5.5A16.36 16.36 0 0 1 127 18.72l-8.69 61.42c-1.39 10.01-10.77 18.16-20.88 18.16ZM110.77 4a17.63 17.63 0 0 0-17 14.72l-8.64 61.42a12 12 0 0 0 12.3 14.16 17.65 17.65 0 0 0 16.95-14.72l8.69-61.42a12.41 12.41 0 0 0-2.75-10A12.4 12.4 0 0 0 110.77 4ZM186.94 5.42l.56-3.91H162.99l-13.5 95.44H174l.57-4h-20.46l5.85-41.36h20.46l.56-4h-20.45l5.96-42.17h20.45zM266.73 1.51h-31.01l-.55 3.91h14.2l-12.95 91.53h4.06l12.93-91.53h12.77l.55-3.91zM212.61 1.51a15.86 15.86 0 0 0-15.24 13.24l-9.86 69.48a11.69 11.69 0 0 0 2.76 9.34 12.57 12.57 0 0 0 9.18 4.43h.2c6.38 0 11.65-5.57 15.15-9.28L211.9 86c-3.06 3.23-7.67 8.11-12.38 8a8.54 8.54 0 0 1-6.21-3 7.73 7.73 0 0 1-1.84-6.18l9.86-69.48a11.83 11.83 0 0 1 11.28-9.9h13.91l.55-3.91ZM37.08 5.58a12 12 0 0 0-9.26-4.06H13.5L0 97h4.06l6.41-45.37h10.84a15.87 15.87 0 0 0 15.24-13.29l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.26 23a11.74 11.74 0 0 1-11.27 9.8H11l6-42.13h10.85a7.94 7.94 0 0 1 8 9.33ZM75.09 5.58a12 12 0 0 0-9.26-4.06h-14.3L38 97h4l6.5-45.42h10L65 96.2h4l-6.6-45a16 16 0 0 0 12.16-12.86l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.25 23a11.76 11.76 0 0 1-11.28 9.8H49.07L55 5.42h10.86a7.94 7.94 0 0 1 8 9.33ZM223.75 215.47h-4.06l13.5-95.43h4.05l-13.49 95.43zM65.83 215.63a14.49 14.49 0 0 1-11-4.65 11.3 11.3 0 0 1-2.68-9.15l1.31-8.59 4.4-2.34-1.76 11.52a7.24 7.24 0 0 0 1.75 5.93 10.47 10.47 0 0 0 8 3.28c6.42 0 12.26-4.39 13-9.8l5.42-38.33-28.77 15.27 6.37-46c1-7.3 8.65-13.24 17-13.24a14.52 14.52 0 0 1 11 4.65 11.36 11.36 0 0 1 2.68 9.14l-1.2 8.68-4.35 2.34 1.64-11.6a7.29 7.29 0 0 0-1.74-6 10.5 10.5 0 0 0-8-3.28c-6.42 0-12.26 4.39-13 9.79l-5.29 38.27 28.8-15.28-6.52 46.1c-1.11 7.35-8.73 13.29-17.06 13.29ZM174.15 120.04h-4.51l-26.9 51.72 7.31-51.72H146l-13.5 95.43h4.05l4.5-31.8 10.61-20.4 12.61 52.2h4.11l-13.91-57.6 19.68-37.83zM205 215.47h4l-2.29-94.87v-.56h-4l-29.31 95.43h4.18l9.82-32h16.83Zm-16.37-36L203 132.68l1.13 46.81ZM132.58 123.94l.56-3.91h-24.52l-13.49 95.44h24.51l.56-4H99.75l5.85-41.36h20.45l.57-4h-20.46l5.97-42.17h20.45z"></path><path style="fill:url(#fullLogo_svg__linear-gradient)" d="M279.69 1.51h8.87l-32.09 213.93h-8.87L279.69 1.51z"></path><path d="M393.81 14.88C396 .34 331.4 1.5 296.53 1.5L283.6 87.67c33.36-1.94 99.5-2 97.21 13.27-1.14 7.58-5.53 7.29-6.1 11.08-1.52 10.14 70.94 5.62 81.15 4.52L434 73.6l34.7-43.29c-17.47 1.81-82.47 4.94-81.11-4.15.73-4.87 5.41-5.56 6.22-11.28Z" style="fill:url(#fullLogo_svg__linear-gradient-2)"></path><path d="m324.34 13-5.8 25.24A9.73 9.73 0 0 0 312 36c-4.66 0-8.43 2.82-8.42 6.27s3.8 6.24 8.46 6.22c4 0 7.4-2.12 8.23-4.92 0-.14.06-.28.09-.42l3.48-15.5q9.18 2.06 9.72 5.26a9 9 0 0 1-1.27 6.22 10.78 10.78 0 0 0 5.7-8.81q.48-5.88-13.65-17.32Z" style="fill:url(#fullLogo_svg__linear-gradient-3)"></path></g></svg></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/members/">Members</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/contests/">Contests</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags/">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">CTF 2023</a></div><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/members/">Members</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/contests/">Contests</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">CTF 2023</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-07-01T00:00:00.000Z">Friday, 1 July 2022</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">BSidesTLV 2022 CTF – SEV</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/00000000000000000000000000000009?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Radewoosh</dd><dt class="sr-only">Twitter</dt><dd><span class="text-gray-500">Algo and math I guess?</span></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><h2 id="sev-crypto-500"><a href="#sev-crypto-500" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>SEV (Crypto, 500)</h2>
<blockquote>
<p>Welcome to our secure confessions service. We got an annoymous tip that our customers&#x27; sins can be recovered. Please find what sin is hiding in our KE implementation.</p>
<p><code>nc sev.ctf.bsidestlv.com 3535</code></p>
<p>Attachments: <a target="_blank" rel="noopener noreferrer" href="https://ctf22.bsidestlv.com/files/59d7738c2641c85e2b05e5cbc1893086/code.zip?token=eyJ1c2VyX2lkIjoyODYsInRlYW1faWQiOjExNiwiZmlsZV9pZCI6OH0.Yr3wug.0zgiqGqtbCh9M-6eUY_DlcJQY5o">code.zip</a> <a target="_blank" rel="noopener noreferrer" href="https://ctf22.bsidestlv.com/files/9192622117171fc134bf3afd34cb31f1/session.pcap?token=eyJ1c2VyX2lkIjoyODYsInRlYW1faWQiOjExNiwiZmlsZV9pZCI6OX0.Yr3wug.WVniIuq_rSXKw3u0MKXZf3zZ6jc">session.pcap</a></p>
</blockquote>
<p><code>session.pcap</code> file contains an history of a communication between a client and the server:</p>
<pre><span style="color:#EF9A9A">Dg7ADYs5Yu71LzYF/AAJCCFrNT9LCZEKNOb4aYcRGbsqJeaCN4/Sv4Kqqcd5E46kiEKcd84pwJ+sJrfkO7ZCTkUzIiV1AvVbOSMrv9fHRHi8sJDXy6IIYeRbKrV8rQEA
Provide PoW to be forgiven: sha256(secret || nonce) == tag
Where len(secret) is 4. nonce and tag are provided as data:
ejBLSmF5cGpJTllyUWdFbQ==|A8zoQrrWIY8khG8NFXHBFW/IOz2v9fN0TtkdH3O7Um0=</span>
<span style="color:#90CAF9">amVQaw==
Ag==|AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFXpIhjPhJvBHkYjZsJwQvRH2tCYB8gyfsSxUweg7IWheZXc2UvB4ELB918rjFfw4=|AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABX0G/QAGJkGhwZMS71XSTa1gCHNiPHisAytIz2RMKl8EiR6ViMcZDFz3zbJyl3J4Y=</span>
<span style="color:#EF9A9A">ETtQGKvbgQi+2XLWNBT0iuUJrLW7m4Bygb5triaWj3Momg5LF4GNuH/H/fxWHBZXjmIiySoSXo/IdRlkX73vuWNhiUjmOUsFZxNXLP4B2e3gplFqkjYNhn2cFAp03TTz|4+qRIXALaaZCk7yq5iQEQyt/ChqLuWpizc/0hkCJzuo=</span>
<span style="color:#90CAF9">DovsN9mEHsSZ/yChmtzfRBDw6SXjwSSPTSWSgsa4wJ9GIEmcF8DNlSoxi5l5H6ZrQTt+pweN472ShhMlTQEw328EXaLbmt0C62CfCB9dAAG7fqE=|ViSMR4tOyjxQsoP4klviilAOFZPFTGVOvmtfkqsQcok=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: b68c2d5ababa5080b4105bf2fcde89060f92ff6512d5e321a2b102172d9fbc42</span>
<span style="color:#90CAF9">JmNyidFvtENv3LsvJgVl7D9G7Z+445yYRoDC6I8wSB29kpuZJGo92jGglry2ab61O8BGGnu0rw==|I8ppGR6Kt75CUhzxWCaOGXXg54FCTVFSLfw+qUBkYOo=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: d05c56b4692ccd47063fc6d12a3c00ff8ab332c7fb91a797a0862cb0e63e6826</span>
<span style="color:#90CAF9">wsMeqBQZdU5mf+vdhVYZ+pccL6T3/Rej8w1j++69iXsnpa5XjBkuraVDwA8FEaWyLrby8K4UmBeYvoekl9xDDXtjT1YOnBomuA==|5EFItaA9aE/sKdPqmOWehB+YuzSY8ylcM4sh9QscIwY=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: b07a7bc955aff2c8e58b7a4747b7519fa0d4a306648cc81ca79bd5ed724b12e4</span>
<span style="color:#90CAF9">JWOv0CMe/IWIeiI+HZq8CxI58nVBZiYHdW0X3n9D79QCqTmrV3tSTAlIPMUJ8yRSoevt4+ZHH8UPkHW0ew+F|JOXncbnsOIQG0qAUbNz5YEL+i6snXmDH2Wsg6Nr8tT0=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: 7ca4d4086a677a14adcce62cc45fc78ea60e787dbbb7b307c3e8ff5f4fa8fb09</span>
<span style="color:#90CAF9">DaKaH+g0YQFVSoc20sYgkEViShc6IFUpy5sWnZ6wLTVgnzfzGzQkdJ4Tmk62qr2wtn/2kj0RuRatsh3Pwq3AmU51sSEhXLqIULLnpvwJl/z0|gFXeRQw/TqTiffeT7Vrgt5moNZRtAnqjPnuSJmExsSs=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: 9d8b988dea424160cf3089a8a87aa4a1313da16619d5d5c0ace08d649e2e5310</span>
<span style="color:#90CAF9">AFQyWZ0EyEC2fzGEEyXjfQhRlA==|BP7opu0HHysi94IXc4Shw+mWFowGrz7L1hQv4SJxqrc=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: a8e4843b9ff167627f87c431151680675d74f14b12a8c12a6038c669588ee0c3</span>
<span style="color:#90CAF9">/SMw0AfL7BEPQIZgsT2Su3voQ6GWAIrRDuwehAk8n05+rR+8Ng0cq5YMX44qpXtZ1m2OJnUpBb1LjA==|VTCuEaanvKN/5klaQEGQ3cdSGei65hroORxBgpUSQnw=</span>
<span style="color:#EF9A9A">You are forgiven for sin confessed having sha256 digest: 6a4cde95ef46d6d184fd2c2a9be522acd02edb229d296c5ffbd292f68e389024</span></pre>
<p>We can guess, that the flag is in client’s confession, so our job is to decrypt it. To do this we will try to steal server’s secret key, which is constant and will be denoted here by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>To communicate we can choose one of two curves, <code>p256</code> and <code>p384</code>, for which there are two primes, let’s call them <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>. After reading <code>main.py</code> we realize that if we choose the first (smaller) curve, the point sent to the server (let’s call it <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span></span>) must lie <code>p256</code>, but instead of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, server will use <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> to calculate the shared key. This means that it won’t actually use <code>p384</code>, but some other curve (with the same prime number) and the shared key (let’s call it <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span></span>) will be equal to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>×</mo><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P \times s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>First of all, we need to know this <code>shared_key</code>. Let’s look at the code:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">send_debug</span><span class="token punctuation">(</span>ecdh<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    res <span class="token operator">=</span> ecdh<span class="token punctuation">.</span>public_key<span class="token punctuation">.</span>pubkey<span class="token punctuation">.</span>point <span class="token operator">*</span> ecdh<span class="token punctuation">.</span>private_key<span class="token punctuation">.</span>privkey<span class="token punctuation">.</span>secret_multiplier
</span><span class="code-line">    io<span class="token punctuation">.</span>writeData<span class="token punctuation">(</span><span class="token operator">*</span>ctx<span class="token punctuation">.</span>tx_encrypt<span class="token punctuation">(</span>res<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    ctx<span class="token punctuation">.</span>tx_ctx<span class="token punctuation">.</span>CTR<span class="token punctuation">.</span>val <span class="token operator">=</span> <span class="token number">0</span>
</span></code></pre></div>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">    <span class="token builtin">id</span> <span class="token operator">=</span> sha256<span class="token punctuation">(</span>ecdh<span class="token punctuation">.</span>public_key<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> debug<span class="token punctuation">:</span>
</span><span class="code-line">        send_debug<span class="token punctuation">(</span>ecdh<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">        io<span class="token punctuation">.</span>writeData<span class="token punctuation">(</span><span class="token operator">*</span>ctx<span class="token punctuation">.</span>tx_encrypt<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Welcome your pub fingerprint is </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#x27;latin1&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>Server sends to us two encrypted lines. One contains the shared key, and the other contains a welcome message, which we can know, as it contains a SHA256 of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span></span> which is chosen by us. These two lines happen to have the exact same length and it turns out, that this encryption is just xoring both of the lines with the same sequence of bytes. So, if we take the xor of these two lines and the welcoming message, we are left with the shared key.</p>
<p>Great, as <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>P</mi><mo>×</mo><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">S = P \times s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, we just have to solve the discrete logarithm problem. But that’s hard... So, what are the differences between standard version of this problem and the presented one? Firstly, we won’t be solving it on any specified curve (as <code>p384</code> for example), as our point comes from <code>p256</code> and the calculations will be performed modulo <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>. Secondly, we can send many points to the server and get many equations, with the same prime number, but on different curves (generated by the points of our choice).</p>
<p>Here we’ll make use of the algorithm to calculate the order of a point on elliptic curve. So, let’s look at the value of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ord</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{ord}(P)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">ord</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mclose">)</span></span></span></span></span> and let’s try to find its small divisor. Here by “small” we mean an iterable one, so let’s say smaller than a million. If there is such a divisor, and there is high probability that there is, then denote it by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span></span> and instead of looking at points <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span></span>, look at points <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>×</mo><mfrac><mrow><mtext>ord</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><mi>d</mi></mfrac></mrow><annotation encoding="application/x-tex">P \times {\text{ord}(P) \over d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>×</mo><mfrac><mrow><mtext>ord</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><mi>d</mi></mfrac></mrow><annotation encoding="application/x-tex">S \times {\text{ord}(P) \over d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>. For them we can solve the discrete logarithm problem easily, as the order of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>×</mo><mfrac><mrow><mtext>ord</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><mi>d</mi></mfrac></mrow><annotation encoding="application/x-tex">P \times {\text{ord}(P) \over d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> is small.</p>
<p>So, we have an equation <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>×</mo><mfrac><mrow><mtext>ord</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><mi>d</mi></mfrac><mo>×</mo><mi>k</mi><mo>=</mo><mi>S</mi><mo>×</mo><mfrac><mrow><mtext>ord</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><mi>d</mi></mfrac></mrow><annotation encoding="application/x-tex">P \times {\text{ord}(P) \over d} \times k = S \times {\text{ord}(P) \over d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>. Does it tell the exact value of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>? Of course no, but it tells us about the remainder of dividing <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span></span>. That actually gives us the whole solution, as if we collect enough congruences, we’ll be able to use Chinese remainder theorem to get the exact value of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>With everything thought out, we can start the attack. To calculate the order of curves we can use sage:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">from</span> sage<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>prandom <span class="token keyword">import</span> randrange
</span><span class="code-line"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
</span><span class="code-line"><span class="token keyword">import</span> signal
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">p384</span><span class="token punctuation">:</span>
</span><span class="code-line">    p <span class="token operator">=</span> <span class="token number">39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319</span>
</span><span class="code-line">    b <span class="token operator">=</span> <span class="token number">27580193559959705877849011840389048093056905856361568521428707301988689241309860865136260764883745107765439761230575</span>
</span><span class="code-line">    a <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span>
</span><span class="code-line">    Gx <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">&quot;AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B9859F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB7&quot;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">    Gy <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">&quot;3617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147CE9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F&quot;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">p256</span><span class="token punctuation">:</span>
</span><span class="code-line">    p <span class="token operator">=</span> <span class="token number">115792089210356248762697446949407573530086143415290314195533631308867097853951</span>
</span><span class="code-line">    b <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">&quot;5AC635D8 AA3A93E7 B3EBBD55 769886BC 651D06B0 CC53B0F63BCE3C3E 27D2604B&quot;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">    a <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span>
</span><span class="code-line">    Gx <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">&quot;6B17D1F2 E12C4247 F8BCE6E5 63A440F2 77037D81 2DEB33A0F4A13945 D898C296&quot;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">    Gy <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">&quot;4FE342E2 FE1A7F9B 8EE7EB4A 7C0F9E16 2BCE3357 6B315ECECBB64068 37BF51F5&quot;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">K <span class="token operator">=</span> GF<span class="token punctuation">(</span>p256<span class="token punctuation">.</span>p<span class="token punctuation">)</span>
</span><span class="code-line">P256 <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>K<span class="token punctuation">,</span> <span class="token punctuation">[</span>p256<span class="token punctuation">.</span>a<span class="token punctuation">,</span> p256<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">            P <span class="token operator">=</span> P256<span class="token punctuation">.</span>lift_x<span class="token punctuation">(</span>K<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">break</span>
</span><span class="code-line">        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">continue</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> P<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    b_ <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">*</span> y <span class="token operator">-</span> x <span class="token operator">^</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">%</span> p384<span class="token punctuation">.</span>p
</span><span class="code-line">    ec <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p384<span class="token punctuation">.</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> b_<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Calculating EC order&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    o <span class="token operator">=</span> ec<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>We had small problems with sage getting stuck, but we managed to collect 58 various points together with their order. We saved them in a file:</p>
<div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line"><span class="token number">89936635954347721082291662199830953644415701978674159588335797948725963360121</span>
</span><span class="code-line"><span class="token number">75603778932495181759544986564297344224164574459444354228241781117643409370328</span>
</span><span class="code-line"><span class="token number">39402006196394479212279040100143613805079739270465446667945677458609027261747300550436222500290897901412646071140521</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token number">94669244813001974863196163432068054052897736338944823404184997020382981219790</span>
</span><span class="code-line"><span class="token number">63246684792990410882044657474118318613402239831513202414041221302452475231147</span>
</span><span class="code-line"><span class="token number">39402006196394479212279040100143613805079739270465446667953428258142871094028478103699443071551088605265882646853173</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token number">30789509188003919664641197040026779665452432414110328926013251738811451876528</span>
</span><span class="code-line"><span class="token number">59959100322647307194286668737312561534119906525946272810561021041294062507683</span>
</span><span class="code-line"><span class="token number">39402006196394479212279040100143613805079739270465446667958033666035318438249614543376887412317906233830648430493355</span>
</span><span class="code-line"><span class="token punctuation">..</span>.
</span></code></pre></div>
<p>Now we are ready to read these curves from the file and talk with the server:</p>
<div class="relative"><pre><code class="language-python code-highlight"><span class="code-line">curves <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	o <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	curves<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> o<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">tries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token keyword">for</span> a <span class="token keyword">in</span> digits <span class="token operator">+</span> ascii_letters<span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">for</span> b <span class="token keyword">in</span> digits <span class="token operator">+</span> ascii_letters<span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">for</span> c <span class="token keyword">in</span> digits <span class="token operator">+</span> ascii_letters<span class="token punctuation">:</span>
</span><span class="code-line">			<span class="token keyword">for</span> d <span class="token keyword">in</span> digits <span class="token operator">+</span> ascii_letters<span class="token punctuation">:</span>
</span><span class="code-line">				tries<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">xorit</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>x<span class="token operator">^</span>y <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">calc_sol</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	conn <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">&#x27;sev.ctf.bsidestlv.com&#x27;</span><span class="token punctuation">,</span> <span class="token number">3535</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	take <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	take <span class="token operator">=</span> Data<span class="token punctuation">.</span>SplitData<span class="token punctuation">(</span>take<span class="token punctuation">)</span>
</span><span class="code-line">	prover <span class="token operator">=</span> PoW<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	prover<span class="token punctuation">.</span>nonce <span class="token operator">=</span> take<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">	<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tries<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">		trying <span class="token operator">=</span> tries<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
</span><span class="code-line">		<span class="token keyword">if</span> prover<span class="token punctuation">.</span>validate<span class="token punctuation">(</span>trying<span class="token punctuation">,</span> take<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">			conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span>trying<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b&#x27;\n&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">break</span>
</span><span class="code-line">	conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>Data<span class="token punctuation">.</span>JoinData<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">&#x27;big&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">&#x27;big&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">&#x27;big&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b&#x27;\n&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">	a <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	b <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	a <span class="token operator">=</span> Data<span class="token punctuation">.</span>SplitData<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</span><span class="code-line">	b <span class="token operator">=</span> Data<span class="token punctuation">.</span>SplitData<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
</span><span class="code-line">	a <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">	b <span class="token operator">=</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">	<span class="token builtin">id</span> <span class="token operator">=</span> sha256<span class="token punctuation">(</span>PointJacobi<span class="token punctuation">(</span>curve_map<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token string">&#x27;raw&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	c <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;Welcome your pub fingerprint is </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#x27;latin1&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">	shared <span class="token operator">=</span> xorit<span class="token punctuation">(</span>a<span class="token punctuation">,</span> xorit<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	x <span class="token operator">=</span> string_to_number<span class="token punctuation">(</span>shared<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">	y <span class="token operator">=</span> string_to_number<span class="token punctuation">(</span>shared<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">	conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">return</span><span class="token punctuation">(</span>PointJacobi<span class="token punctuation">(</span>curve_map<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PointJacobi<span class="token punctuation">(</span>curve_map<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">pool <span class="token operator">=</span> ThreadPool<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
</span><span class="code-line">sols <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>calc_sol<span class="token punctuation">,</span> curves<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">is_prime</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">if</span> v <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">	x <span class="token operator">=</span> <span class="token number">2</span>
</span><span class="code-line">	<span class="token keyword">while</span> x <span class="token operator">*</span> x <span class="token operator">&lt;=</span> v<span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">if</span> v <span class="token operator">%</span> x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">			<span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">		x <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">prod <span class="token operator">=</span> <span class="token number">1</span>
</span><span class="code-line">w <span class="token operator">=</span> <span class="token number">1</span>
</span><span class="code-line">r <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
</span><span class="code-line">	w <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token keyword">not</span> is_prime<span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">continue</span>
</span><span class="code-line">	take <span class="token operator">=</span> <span class="token boolean">None</span>
</span><span class="code-line">	<span class="token keyword">for</span> i <span class="token keyword">in</span> sols<span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">if</span> i<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">%</span> w <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">			take <span class="token operator">=</span> i
</span><span class="code-line">	<span class="token keyword">if</span> take <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">continue</span>
</span><span class="code-line">	<span class="token keyword">print</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">&#x27;will work&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">	a <span class="token operator">=</span> take<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>take<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">//</span> w<span class="token punctuation">)</span>
</span><span class="code-line">	b <span class="token operator">=</span> take<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>take<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">//</span> w<span class="token punctuation">)</span>
</span><span class="code-line">	u <span class="token operator">=</span> a
</span><span class="code-line">	<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> w <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">if</span> u <span class="token operator">==</span> b<span class="token punctuation">:</span>
</span><span class="code-line">			should <span class="token operator">=</span> j
</span><span class="code-line">			<span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> w<span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">while</span> <span class="token punctuation">(</span>r <span class="token operator">%</span> w<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>j <span class="token operator">%</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">				r <span class="token operator">+=</span> prod
</span><span class="code-line">			<span class="token keyword">break</span>
</span><span class="code-line">		u <span class="token operator">=</span> u <span class="token operator">+</span> a
</span><span class="code-line">	prod <span class="token operator">*=</span> w
</span><span class="code-line">	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;R is&#x27;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;Product is&#x27;</span><span class="token punctuation">,</span> prod<span class="token punctuation">)</span>
</span></code></pre></div>
<p>This gives us the desired value of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>:</p>
<div class="relative"><pre><code class="code-highlight"><span class="code-line">18430131452148989837577882252868373891854598671610031055403934843354901730409281854175550384893659770012714739087985
</span></code></pre></div>
<p>Using the point sent by the client in <code>session.pcap</code> to the server, we can calculate their shared key and use it to decrypt the confessions:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">x <span class="token operator">=</span> <span class="token number">10676930506344505873343842825136193063086736081417640908491244252777962392401494994145689818929842945737119139987214</span>
</span><span class="code-line">y <span class="token operator">=</span> <span class="token number">13515843335184786939328473707652274608813326314510139953701071845110611907135279260510778339890982259161016709883782</span>
</span><span class="code-line">prv_key <span class="token operator">=</span> Point<span class="token punctuation">(</span>curve_map<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">shared <span class="token operator">=</span> prv_key <span class="token operator">*</span> <span class="token number">18430131452148989837577882252868373891854598671610031055403934843354901730409281854175550384893659770012714739087985</span>
</span><span class="code-line">password <span class="token operator">=</span> number_to_string<span class="token punctuation">(</span>shared<span class="token punctuation">.</span>x<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curve_map<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>p<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">ctx <span class="token operator">=</span> session_context<span class="token punctuation">(</span>password<span class="token punctuation">,</span> Role<span class="token punctuation">.</span>Responder<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">msgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">b&#x27;DovsN9mEHsSZ/yChmtzfRBDw6SXjwSSPTSWSgsa4wJ9GIEmcF8DNlSoxi5l5H6ZrQTt+pweN472ShhMlTQEw328EXaLbmt0C62CfCB9dAAG7fqE=|ViSMR4tOyjxQsoP4klviilAOFZPFTGVOvmtfkqsQcok=&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token string">b&#x27;JmNyidFvtENv3LsvJgVl7D9G7Z+445yYRoDC6I8wSB29kpuZJGo92jGglry2ab61O8BGGnu0rw==|I8ppGR6Kt75CUhzxWCaOGXXg54FCTVFSLfw+qUBkYOo=&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token string">b&#x27;wsMeqBQZdU5mf+vdhVYZ+pccL6T3/Rej8w1j++69iXsnpa5XjBkuraVDwA8FEaWyLrby8K4UmBeYvoekl9xDDXtjT1YOnBomuA==|5EFItaA9aE/sKdPqmOWehB+YuzSY8ylcM4sh9QscIwY=&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token string">b&#x27;JWOv0CMe/IWIeiI+HZq8CxI58nVBZiYHdW0X3n9D79QCqTmrV3tSTAlIPMUJ8yRSoevt4+ZHH8UPkHW0ew+F|JOXncbnsOIQG0qAUbNz5YEL+i6snXmDH2Wsg6Nr8tT0=&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token string">b&#x27;DaKaH+g0YQFVSoc20sYgkEViShc6IFUpy5sWnZ6wLTVgnzfzGzQkdJ4Tmk62qr2wtn/2kj0RuRatsh3Pwq3AmU51sSEhXLqIULLnpvwJl/z0|gFXeRQw/TqTiffeT7Vrgt5moNZRtAnqjPnuSJmExsSs=&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token string">b&#x27;AFQyWZ0EyEC2fzGEEyXjfQhRlA==|BP7opu0HHysi94IXc4Shw+mWFowGrz7L1hQv4SJxqrc=&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token string">b&#x27;/SMw0AfL7BEPQIZgsT2Su3voQ6GWAIrRDuwehAk8n05+rR+8Ng0cq5YMX44qpXtZ1m2OJnUpBb1LjA==|VTCuEaanvKN/5klaQEGQ3cdSGei65hroORxBgpUSQnw=&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs<span class="token punctuation">:</span>
</span><span class="code-line">	msg <span class="token operator">=</span> Data<span class="token punctuation">.</span>SplitData<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">print</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>rx_decrypt<span class="token punctuation">(</span><span class="token operator">*</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div>
<blockquote>
<p>Once, I encrypted penguins using ECB. I can still hear them screaming in my dreams.
I find Lady LFSR&#x27;s irreducible polynomial irresistible.
Reusing primes to accelerate private key generation is my dirty pleasure.
Hardcoding passwords is one of my preferred pastime activities.
My clients&#x27; passwords are always stored encrypted with military grade encryption.
MD5 is my best bud.
<code>BSidesTLV2022{b3wear_7h3_1nv4lid_curv3_0r_l00s3_y0ur_51ns}</code></p>
</blockquote>
<h2 id="flag"><a href="#flag" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Flag</h2>
<div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">BSidesTLV2022<span class="token punctuation">{</span>b3wear_7h3_1nv4lid_curv3_0r_l00s3_y0ur_51ns<span class="token punctuation">}</span>
</span></code></pre></div></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fsekai.team%2Fblog%2Fbsidestlv-2022%2Fsev">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/blueset/sekai.team/blob/master/data/blog/bsidestlv-2022/sev.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/bsidestlv-2022/">BSidesTLV-2022</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/crypto/">Crypto</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ecc/">ECC</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/elliptic-curve/">Elliptic-Curve</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/bsidestlv-2022/intergalactic_communicator/">BSidesTLV 2022 CTF – Intergalactic Communicator</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/gdg-algiers-2022/mlm/">GDG Algiers CTF 2022 – MLM</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:project.sekai@sekai.team"><span class="sr-only"><span class="w-6">mail</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/project-sekai-ctf"><span class="sr-only"><span class="w-6">github</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/project-sekai-ctf/"><span class="sr-only"><span class="w-6">linkedin</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ProjectSEKAIctf"><span class="sr-only"><span class="w-6">twitter</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/169557"><span class="sr-only"><span class="w-6">ctftime</span></span><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M24 0v24H0V0h24Zm-3.077 3.077L7.067 3.076 16 12.816 10.369 19l-2.195-2.612 3.476-3.573-8.574-9.609v17.717h17.847V3.077Z" fill="currentColor" fill-rule="evenodd"></path></svg></a></div></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><a href="/">Project SEKAI</a><div> • </div><div>© 2024</div><div> • </div><div><a href="https://1a23.com">1A23 Studio</a></div></div><div class="mb-8 text-xs text-center text-gray-200 dark:text-gray-700">This website is in no way affiliated with any of the following individuals or organizations.<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a> © Timothy Lim and contributors; <a target="_blank" rel="noopener noreferrer" href="https://pjsekai.sega.jp/">Project SEKAI: Colorful Stage! feat. Hatsune Miku</a> © SEGA / © Craft Egg Inc. Developed by Colorful Palette; <a target="_blank" rel="noopener noreferrer" href="https://ec.crypton.co.jp/pages/prod/virtualsinger">Character Vocal Series</a> © Crypton Future Media, INC. <a target="_blank" rel="noopener noreferrer" href="https://www.piapro.net">www.piapro.net</a> All rights reserved.</div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var m=Object.create;var l=Object.defineProperty;var o=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty;var t=a=\u003el(a,\"__esModule\",{value:!0});var N=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=\u003e{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!d.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=o(s,n))||c.enumerable});return a},g=a=\u003ek(t(l(a!=null?m(p(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((f,i)=\u003e{i.exports=_jsx_runtime});var v={};u(v,{default:()=\u003ew,frontmatter:()=\u003ey});var e=g(r()),y={title:\"BSidesTLV 2022 CTF \\u2013 SEV\",date:\"2022-07-01\",draft:!1,authors:[\"radewoosh\"],tags:[\"BSidesTLV 2022\",\"Crypto\",\"ECC\",\"Elliptic Curve\"],summary:\"Steal secret key and get the flag.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",msub:\"msub\",mi:\"mi\",annotation:\"annotation\",mn:\"mn\",mo:\"mo\",pre:\"pre\",mtext:\"mtext\",mfrac:\"mfrac\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"sev-crypto-500\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#sev-crypto-500\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"SEV (Crypto, 500)\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Welcome to our secure confessions service. We got an annoymous tip that our customers' sins can be recovered. Please find what sin is hiding in our KE implementation.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"nc sev.ctf.bsidestlv.com 3535\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Attachments: \",(0,e.jsx)(n.a,{href:\"https://ctf22.bsidestlv.com/files/59d7738c2641c85e2b05e5cbc1893086/code.zip?token=eyJ1c2VyX2lkIjoyODYsInRlYW1faWQiOjExNiwiZmlsZV9pZCI6OH0.Yr3wug.0zgiqGqtbCh9M-6eUY_DlcJQY5o\",children:\"code.zip\"}),\" \",(0,e.jsx)(n.a,{href:\"https://ctf22.bsidestlv.com/files/9192622117171fc134bf3afd34cb31f1/session.pcap?token=eyJ1c2VyX2lkIjoyODYsInRlYW1faWQiOjExNiwiZmlsZV9pZCI6OX0.Yr3wug.WVniIuq_rSXKw3u0MKXZf3zZ6jc\",children:\"session.pcap\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"session.pcap\"}),\" file contains an history of a communication between a client and the server:\"]}),`\n`,(0,e.jsxs)(\"pre\",{children:[(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:`Dg7ADYs5Yu71LzYF/AAJCCFrNT9LCZEKNOb4aYcRGbsqJeaCN4/Sv4Kqqcd5E46kiEKcd84pwJ+sJrfkO7ZCTkUzIiV1AvVbOSMrv9fHRHi8sJDXy6IIYeRbKrV8rQEA\nProvide PoW to be forgiven: sha256(secret || nonce) == tag\nWhere len(secret) is 4. nonce and tag are provided as data:\nejBLSmF5cGpJTllyUWdFbQ==|A8zoQrrWIY8khG8NFXHBFW/IOz2v9fN0TtkdH3O7Um0=`}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:`amVQaw==\nAg==|AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFXpIhjPhJvBHkYjZsJwQvRH2tCYB8gyfsSxUweg7IWheZXc2UvB4ELB918rjFfw4=|AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABX0G/QAGJkGhwZMS71XSTa1gCHNiPHisAytIz2RMKl8EiR6ViMcZDFz3zbJyl3J4Y=`}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"ETtQGKvbgQi+2XLWNBT0iuUJrLW7m4Bygb5triaWj3Momg5LF4GNuH/H/fxWHBZXjmIiySoSXo/IdRlkX73vuWNhiUjmOUsFZxNXLP4B2e3gplFqkjYNhn2cFAp03TTz|4+qRIXALaaZCk7yq5iQEQyt/ChqLuWpizc/0hkCJzuo=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"DovsN9mEHsSZ/yChmtzfRBDw6SXjwSSPTSWSgsa4wJ9GIEmcF8DNlSoxi5l5H6ZrQTt+pweN472ShhMlTQEw328EXaLbmt0C62CfCB9dAAG7fqE=|ViSMR4tOyjxQsoP4klviilAOFZPFTGVOvmtfkqsQcok=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: b68c2d5ababa5080b4105bf2fcde89060f92ff6512d5e321a2b102172d9fbc42\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"JmNyidFvtENv3LsvJgVl7D9G7Z+445yYRoDC6I8wSB29kpuZJGo92jGglry2ab61O8BGGnu0rw==|I8ppGR6Kt75CUhzxWCaOGXXg54FCTVFSLfw+qUBkYOo=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: d05c56b4692ccd47063fc6d12a3c00ff8ab332c7fb91a797a0862cb0e63e6826\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"wsMeqBQZdU5mf+vdhVYZ+pccL6T3/Rej8w1j++69iXsnpa5XjBkuraVDwA8FEaWyLrby8K4UmBeYvoekl9xDDXtjT1YOnBomuA==|5EFItaA9aE/sKdPqmOWehB+YuzSY8ylcM4sh9QscIwY=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: b07a7bc955aff2c8e58b7a4747b7519fa0d4a306648cc81ca79bd5ed724b12e4\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"JWOv0CMe/IWIeiI+HZq8CxI58nVBZiYHdW0X3n9D79QCqTmrV3tSTAlIPMUJ8yRSoevt4+ZHH8UPkHW0ew+F|JOXncbnsOIQG0qAUbNz5YEL+i6snXmDH2Wsg6Nr8tT0=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: 7ca4d4086a677a14adcce62cc45fc78ea60e787dbbb7b307c3e8ff5f4fa8fb09\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"DaKaH+g0YQFVSoc20sYgkEViShc6IFUpy5sWnZ6wLTVgnzfzGzQkdJ4Tmk62qr2wtn/2kj0RuRatsh3Pwq3AmU51sSEhXLqIULLnpvwJl/z0|gFXeRQw/TqTiffeT7Vrgt5moNZRtAnqjPnuSJmExsSs=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: 9d8b988dea424160cf3089a8a87aa4a1313da16619d5d5c0ace08d649e2e5310\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"AFQyWZ0EyEC2fzGEEyXjfQhRlA==|BP7opu0HHysi94IXc4Shw+mWFowGrz7L1hQv4SJxqrc=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: a8e4843b9ff167627f87c431151680675d74f14b12a8c12a6038c669588ee0c3\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#90CAF9\"},children:\"/SMw0AfL7BEPQIZgsT2Su3voQ6GWAIrRDuwehAk8n05+rR+8Ng0cq5YMX44qpXtZ1m2OJnUpBb1LjA==|VTCuEaanvKN/5klaQEGQ3cdSGei65hroORxBgpUSQnw=\"}),`\n`,(0,e.jsx)(\"span\",{style:{color:\"#EF9A9A\"},children:\"You are forgiven for sin confessed having sha256 digest: 6a4cde95ef46d6d184fd2c2a9be522acd02edb229d296c5ffbd292f68e389024\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can guess, that the flag is in client\\u2019s confession, so our job is to decrypt it. To do this we will try to steal server\\u2019s secret key, which is constant and will be denoted here by \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\".\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"To communicate we can choose one of two curves, \",(0,e.jsx)(n.code,{children:\"p256\"}),\" and \",(0,e.jsx)(n.code,{children:\"p384\"}),\", for which there are two primes, let\\u2019s call them \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"p\"}),(0,e.jsx)(n.mn,{children:\"1\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"p_1\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\" and \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"p\"}),(0,e.jsx)(n.mn,{children:\"2\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"p_2\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\". After reading \",(0,e.jsx)(n.code,{children:\"main.py\"}),\" we realize that if we choose the first (smaller) curve, the point sent to the server (let\\u2019s call it \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"P\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"})]})})]})}),\") must lie \",(0,e.jsx)(n.code,{children:\"p256\"}),\", but instead of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"p\"}),(0,e.jsx)(n.mn,{children:\"1\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"p_1\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\", server will use \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"p\"}),(0,e.jsx)(n.mn,{children:\"2\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"p_2\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\" to calculate the shared key. This means that it won\\u2019t actually use \",(0,e.jsx)(n.code,{children:\"p384\"}),\", but some other curve (with the same prime number) and the shared key (let\\u2019s call it \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"S\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"S\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})})]})}),\") will be equal to \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P \\\\times s_k\"})]})})}),(0,e.jsxs)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})]})]})}),\".\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"First of all, we need to know this \",(0,e.jsx)(n.code,{children:\"shared_key\"}),\". Let\\u2019s look at the code:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"language-py code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"send_debug\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ecdh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    res \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" ecdh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"public_key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"pubkey\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"point \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" ecdh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"private_key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"privkey\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`secret_multiplier\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"writeData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"tx_encrypt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"res\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"to_bytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"tx_ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CTR\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"val \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"language-py code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"id\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" sha256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ecdh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"public_key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"to_string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"digest\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" debug\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        send_debug\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ecdh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"try\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        io\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"writeData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"tx_encrypt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"Welcome your pub fingerprint is '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"id\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"hex\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'latin1'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Server sends to us two encrypted lines. One contains the shared key, and the other contains a welcome message, which we can know, as it contains a SHA256 of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"P\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"})]})})]})}),\" which is chosen by us. These two lines happen to have the exact same length and it turns out, that this encryption is just xoring both of the lines with the same sequence of bytes. So, if we take the xor of these two lines and the welcoming message, we are left with the shared key.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Great, as \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mi,{children:\"S\"}),(0,e.jsx)(n.mo,{children:\"=\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"S = P \\\\times s_k\"})]})})}),(0,e.jsxs)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(n.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})]})]})}),\", we just have to solve the discrete logarithm problem. But that\\u2019s hard... So, what are the differences between standard version of this problem and the presented one? Firstly, we won\\u2019t be solving it on any specified curve (as \",(0,e.jsx)(n.code,{children:\"p384\"}),\" for example), as our point comes from \",(0,e.jsx)(n.code,{children:\"p256\"}),\" and the calculations will be performed modulo \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"p\"}),(0,e.jsx)(n.mn,{children:\"2\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"p_2\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\". Secondly, we can send many points to the server and get many equations, with the same prime number, but on different curves (generated by the points of our choice).\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Here we\\u2019ll make use of the algorithm to calculate the order of a point on elliptic curve. So, let\\u2019s look at the value of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mtext,{children:\"ord\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\text{ord}(P)\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(n.span,{className:\"mord text\",children:(0,e.jsx)(n.span,{className:\"mord\",children:\"ord\"})}),(0,e.jsx)(n.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mclose\",children:\")\"})]})})]})}),\" and let\\u2019s try to find its small divisor. Here by \\u201Csmall\\u201D we mean an iterable one, so let\\u2019s say smaller than a million. If there is such a divisor, and there is high probability that there is, then denote it by \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"d\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"d\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"d\"})]})})]})}),\" and instead of looking at points \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"P\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"})]})})]})}),\" and \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"S\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"S\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})})]})}),\", look at points \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.mfrac,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mtext,{children:\"ord\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(n.mi,{children:\"d\"})]})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P \\\\times {\\\\text{ord}(P) \\\\over d}\"})]})})}),(0,e.jsxs)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"1.355em\",verticalAlign:\"-0.345em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(n.span,{className:\"mfrac\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsxs)(n.span,{className:\"vlist\",style:{height:\"1.01em\"},children:[(0,e.jsxs)(n.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.485em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(n.span,{className:\"mord mtight\",children:[(0,e.jsx)(n.span,{className:\"mord text mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"ord\"})}),(0,e.jsx)(n.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(n.span,{})})})]})}),(0,e.jsx)(n.span,{className:\"mclose nulldelimiter\"})]})})]})]})]})}),\" and \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mi,{children:\"S\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.mfrac,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mtext,{children:\"ord\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(n.mi,{children:\"d\"})]})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"S \\\\times {\\\\text{ord}(P) \\\\over d}\"})]})})}),(0,e.jsxs)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"1.355em\",verticalAlign:\"-0.345em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(n.span,{className:\"mfrac\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsxs)(n.span,{className:\"vlist\",style:{height:\"1.01em\"},children:[(0,e.jsxs)(n.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.485em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(n.span,{className:\"mord mtight\",children:[(0,e.jsx)(n.span,{className:\"mord text mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"ord\"})}),(0,e.jsx)(n.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(n.span,{})})})]})}),(0,e.jsx)(n.span,{className:\"mclose nulldelimiter\"})]})})]})]})]})}),\". For them we can solve the discrete logarithm problem easily, as the order of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.mfrac,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mtext,{children:\"ord\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(n.mi,{children:\"d\"})]})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P \\\\times {\\\\text{ord}(P) \\\\over d}\"})]})})}),(0,e.jsxs)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"1.355em\",verticalAlign:\"-0.345em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(n.span,{className:\"mfrac\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsxs)(n.span,{className:\"vlist\",style:{height:\"1.01em\"},children:[(0,e.jsxs)(n.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.485em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(n.span,{className:\"mord mtight\",children:[(0,e.jsx)(n.span,{className:\"mord text mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"ord\"})}),(0,e.jsx)(n.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(n.span,{})})})]})}),(0,e.jsx)(n.span,{className:\"mclose nulldelimiter\"})]})})]})]})]})}),\" is small.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"So, we have an equation \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.mfrac,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mtext,{children:\"ord\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(n.mi,{children:\"d\"})]}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsx)(n.mi,{children:\"k\"}),(0,e.jsx)(n.mo,{children:\"=\"}),(0,e.jsx)(n.mi,{children:\"S\"}),(0,e.jsx)(n.mo,{children:\"\\xD7\"}),(0,e.jsxs)(n.mfrac,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mtext,{children:\"ord\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(n.mi,{children:\"P\"}),(0,e.jsx)(n.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(n.mi,{children:\"d\"})]})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"P \\\\times {\\\\text{ord}(P) \\\\over d} \\\\times k = S \\\\times {\\\\text{ord}(P) \\\\over d}\"})]})})}),(0,e.jsxs)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"1.355em\",verticalAlign:\"-0.345em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(n.span,{className:\"mfrac\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsxs)(n.span,{className:\"vlist\",style:{height:\"1.01em\"},children:[(0,e.jsxs)(n.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.485em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(n.span,{className:\"mord mtight\",children:[(0,e.jsx)(n.span,{className:\"mord text mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"ord\"})}),(0,e.jsx)(n.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(n.span,{})})})]})}),(0,e.jsx)(n.span,{className:\"mclose nulldelimiter\"})]})}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(n.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.7667em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(n.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"1.355em\",verticalAlign:\"-0.345em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(n.span,{className:\"mfrac\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsxs)(n.span,{className:\"vlist\",style:{height:\"1.01em\"},children:[(0,e.jsxs)(n.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(n.span,{style:{top:\"-3.485em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(n.span,{className:\"mord mtight\",children:[(0,e.jsx)(n.span,{className:\"mord text mtight\",children:(0,e.jsx)(n.span,{className:\"mord mtight\",children:\"ord\"})}),(0,e.jsx)(n.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"P\"}),(0,e.jsx)(n.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(n.span,{})})})]})}),(0,e.jsx)(n.span,{className:\"mclose nulldelimiter\"})]})})]})]})]})}),\". Does it tell the exact value of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\"? Of course no, but it tells us about the remainder of dividing \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\" by \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mi,{children:\"d\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"d\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"d\"})]})})]})}),\". That actually gives us the whole solution, as if we collect enough congruences, we\\u2019ll be able to use Chinese remainder theorem to get the exact value of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With everything thought out, we can start the attack. To calculate the order of curves we can use sage:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"language-py code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" sage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"misc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"prandom \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` randrange\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" tqdm \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` tqdm\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` signal\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"p384\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    p \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    b \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"27580193559959705877849011840389048093056905856361568521428707301988689241309860865136260764883745107765439761230575\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    a \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    Gx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B9859F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB7\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    Gy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"3617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147CE9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"p256\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    p \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"115792089210356248762697446949407573530086143415290314195533631308867097853951\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    b \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"5AC635D8 AA3A93E7 B3EBBD55 769886BC 651D06B0 CC53B0F63BCE3C3E 27D2604B\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    a \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    Gx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"6B17D1F2 E12C4247 F8BCE6E5 63A440F2 77037D81 2DEB33A0F4A13945 D898C296\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    Gy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"4FE342E2 FE1A7F9B 8EE7EB4A 7C0F9E16 2BCE3357 6B315ECECBB64068 37BF51F5\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"K \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" GF\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"p256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"P256 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" EllipticCurve\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"K\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"p256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"a\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" p256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"try\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            P \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" P256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"lift_x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"K\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"random_element\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"break\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"except\"}),\" Exception \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"as\"}),\" e\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" y \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" P\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"xy\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    b_ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"y \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" y \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" p384\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`p\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    ec \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" EllipticCurve\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"GF\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"p384\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b_\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"Calculating EC order\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    o \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" ec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"order\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"y\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"We had small problems with sage getting stuck, but we managed to collect 58 various points together with their order. We saved them in a file:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"89936635954347721082291662199830953644415701978674159588335797948725963360121\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"75603778932495181759544986564297344224164574459444354228241781117643409370328\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"39402006196394479212279040100143613805079739270465446667945677458609027261747300550436222500290897901412646071140521\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"94669244813001974863196163432068054052897736338944823404184997020382981219790\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"63246684792990410882044657474118318613402239831513202414041221302452475231147\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"39402006196394479212279040100143613805079739270465446667953428258142871094028478103699443071551088605265882646853173\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"30789509188003919664641197040026779665452432414110328926013251738811451876528\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"59959100322647307194286668737312561534119906525946272810561021041294062507683\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"39402006196394479212279040100143613805079739270465446667958033666035318438249614543376887412317906233830648430493355\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Now we are ready to read these curves from the file and talk with the server:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"curves \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"range\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"58\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"input\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ty \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"input\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\to \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"int\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"input\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"input\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tcurves\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" y\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" o\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"tries \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" a \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" digits \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" ascii_letters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" b \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" digits \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" ascii_letters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" c \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" digits \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" ascii_letters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" d \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" digits \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" ascii_letters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\ttries\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"a \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" b \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" c \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" d\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"xorit\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"bytes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),\"y \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"y \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"zip\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"calc_sol\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tconn \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" remote\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'sev.ctf.bsidestlv.com'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3535\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tconn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tconn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tconn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ttake \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" conn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ttake \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SplitData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tprover \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" PoW\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tprover\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"nonce \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" j \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"range\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"tries\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\ttrying \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" tries\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"j\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" prover\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"validate\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"trying\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tconn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"send\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"b64encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"trying\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"break\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tconn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"send\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"JoinData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"to_bytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" byteorder\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'big'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"to_bytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" byteorder\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'big'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"to_bytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" byteorder\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'big'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ta \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" conn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tb \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" conn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"recvline\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ta \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SplitData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tb \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SplitData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ta \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" a\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tb \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"id\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" sha256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"PointJacobi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"curve_map\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"to_bytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'raw'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"digest\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tc \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"Welcome your pub fingerprint is '}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"id\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"hex\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'latin1'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tshared \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" xorit\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" xorit\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" c\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" string_to_number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"shared\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"48\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ty \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" string_to_number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"shared\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"48\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tconn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"close\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"PointJacobi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"curve_map\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" PointJacobi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"curve_map\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" y\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pool \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" ThreadPool\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"sols \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" pool\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"calc_sol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" curves\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"is_prime\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"v\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" v \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c=\"}),\" v\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" v \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"prod \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"w \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"r \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tw \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"not\"}),\" is_prime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ttake \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"None\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" sols\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" w \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\ttake \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` i\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" take \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"is\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"None\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'will work'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\ta \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"//\"}),\" w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tb \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"take\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"//\"}),\" w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tu \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` a\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" j \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"range\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" w \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" u \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" b\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tshould \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` j\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"j\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"j \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" w\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\tr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),` prod\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"break\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tu \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" u \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),` a\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tprod \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*=\"}),` w\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'R is'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'Product is'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" prod\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"This gives us the desired value of \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsxs)(n.msub,{children:[(0,e.jsx)(n.mi,{children:\"s\"}),(0,e.jsx)(n.mi,{children:\"k\"})]})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord\",children:[(0,e.jsx)(n.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(n.span,{className:\"msupsub\",children:(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(n.span,{})})})]})})]})]})})]})}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`18430131452148989837577882252868373891854598671610031055403934843354901730409281854175550384893659770012714739087985\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Using the point sent by the client in \",(0,e.jsx)(n.code,{children:\"session.pcap\"}),\" to the server, we can calculate their shared key and use it to decrypt the confessions:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"language-py code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10676930506344505873343842825136193063086736081417640908491244252777962392401494994145689818929842945737119139987214\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"y \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"13515843335184786939328473707652274608813326314510139953701071845110611907135279260510778339890982259161016709883782\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"prv_key \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Point\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"curve_map\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" y\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"shared \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" prv_key \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"18430131452148989837577882252868373891854598671610031055403934843354901730409281854175550384893659770012714739087985\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"password \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" number_to_string\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"shared\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" curve_map\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ctx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" session_context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"password\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" Role\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Responder\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"msgs \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"b'DovsN9mEHsSZ/yChmtzfRBDw6SXjwSSPTSWSgsa4wJ9GIEmcF8DNlSoxi5l5H6ZrQTt+pweN472ShhMlTQEw328EXaLbmt0C62CfCB9dAAG7fqE=|ViSMR4tOyjxQsoP4klviilAOFZPFTGVOvmtfkqsQcok='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'JmNyidFvtENv3LsvJgVl7D9G7Z+445yYRoDC6I8wSB29kpuZJGo92jGglry2ab61O8BGGnu0rw==|I8ppGR6Kt75CUhzxWCaOGXXg54FCTVFSLfw+qUBkYOo='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'wsMeqBQZdU5mf+vdhVYZ+pccL6T3/Rej8w1j++69iXsnpa5XjBkuraVDwA8FEaWyLrby8K4UmBeYvoekl9xDDXtjT1YOnBomuA==|5EFItaA9aE/sKdPqmOWehB+YuzSY8ylcM4sh9QscIwY='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'JWOv0CMe/IWIeiI+HZq8CxI58nVBZiYHdW0X3n9D79QCqTmrV3tSTAlIPMUJ8yRSoevt4+ZHH8UPkHW0ew+F|JOXncbnsOIQG0qAUbNz5YEL+i6snXmDH2Wsg6Nr8tT0='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'DaKaH+g0YQFVSoc20sYgkEViShc6IFUpy5sWnZ6wLTVgnzfzGzQkdJ4Tmk62qr2wtn/2kj0RuRatsh3Pwq3AmU51sSEhXLqIULLnpvwJl/z0|gFXeRQw/TqTiffeT7Vrgt5moNZRtAnqjPnuSJmExsSs='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'AFQyWZ0EyEC2fzGEEyXjfQhRlA==|BP7opu0HHysi94IXc4Shw+mWFowGrz7L1hQv4SJxqrc='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:\"b'/SMw0AfL7BEPQIZgsT2Su3voQ6GWAIrRDuwehAk8n05+rR+8Ng0cq5YMX44qpXtZ1m2OJnUpBb1LjA==|VTCuEaanvKN/5klaQEGQ3cdSGei65hroORxBgpUSQnw='\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" msg \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" msgs\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tmsg \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SplitData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"msg\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"rx_decrypt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"msg\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[`Once, I encrypted penguins using ECB. I can still hear them screaming in my dreams.\nI find Lady LFSR's irreducible polynomial irresistible.\nReusing primes to accelerate private key generation is my dirty pleasure.\nHardcoding passwords is one of my preferred pastime activities.\nMy clients' passwords are always stored encrypted with military grade encryption.\nMD5 is my best bud.\n`,(0,e.jsx)(n.code,{children:\"BSidesTLV2022{b3wear_7h3_1nv4lid_curv3_0r_l00s3_y0ur_51ns}\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"flag\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#flag\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Flag\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"BSidesTLV2022\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"b3wear_7h3_1nv4lid_curv3_0r_l00s3_y0ur_51ns\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})})]})}}var w=b;return v;})();\n;return Component;","toc":[{"value":"SEV (Crypto, 500)","url":"#sev-crypto-500","depth":2},{"value":"Flag","url":"#flag","depth":2}],"frontMatter":{"readingTime":{"text":"13 min read","minutes":12.685,"time":761100,"words":2537},"slug":"bsidestlv-2022/sev","fileName":"bsidestlv-2022/sev.md","title":"BSidesTLV 2022 CTF – SEV","date":"2022-07-01T00:00:00.000Z","draft":false,"authors":["radewoosh"],"tags":["BSidesTLV 2022","Crypto","ECC","Elliptic Curve"],"summary":"Steal secret key and get the flag."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.19,"time":11400,"words":38},"slug":["radewoosh"],"fileName":"radewoosh.md","name":"Radewoosh","avatar":"https://www.gravatar.com/avatar/00000000000000000000000000000009?d=identicon\u0026s=256","specialties":["Crypto"],"codeforces":"https://codeforces.com/profile/Radewoosh","member":true,"retired":true,"description":"Algo and math I guess?","order":3,"date":null}],"prev":{"title":"BSidesTLV 2022 CTF – Intergalactic Communicator","date":"2022-06-30T00:00:00.000Z","draft":false,"authors":["thebadgod"],"tags":["BSidesTLV 2022","pwn","reverse","rc4"],"summary":"pwn too easy, rev cancer.","canonical":"https://spclr.ch/bsidestlv2022-writeups","slug":"bsidestlv-2022/intergalactic_communicator"},"next":{"title":"GDG Algiers CTF 2022 – MLM","date":"2022-10-09T00:00:00.000Z","draft":false,"authors":["sahuang"],"tags":["GDG Algiers 2022","Misc","Forensics","pcapng","AI","Bert"],"summary":"Analyze pcapng for BERT layer data, then predict flag with Masked Language Modelling.","canonical":"https://sahuang.github.io/writeups/gdg-algiers-ctf-2022","slug":"gdg-algiers-2022/mlm"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["bsidestlv-2022","sev"]},"buildId":"zs4rZRwOZcgSj8qsc8Zvy","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>