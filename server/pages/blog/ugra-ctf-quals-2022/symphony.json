{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var c=Object.create;var s=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var o=a=>s(a,\"__esModule\",{value:!0});var m=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports),f=(a,t)=>{o(a);for(var i in t)s(a,i,{get:t[i],enumerable:!0})},w=(a,t,i)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of d(t))!u.call(a,n)&&n!==\"default\"&&s(a,n,{get:()=>t[n],enumerable:!(i=h(t,n))||i.enumerable});return a},g=a=>w(o(s(a!=null?c(p(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var l=m((x,r)=>{r.exports=_jsx_runtime});var b={};f(b,{default:()=>N,frontmatter:()=>k});var e=g(l()),k={title:\"Ugra CTF Quals 2022 \\u2013 \\u0418\\u0433\\u0440\\u0430\\u0435\\u0442 \\u043A\\u0430\\u043A \\u0443\\u043C\\u0435\\u0435\\u0442\",date:\"2022-03-01\",draft:!1,authors:[\"blueset\",\"sahuang\"],tags:[\"Ugra CTF Quals 2022\",\"Misc\",\"PDF\",\"Music\",\"Audio Processing\",\"Talking Piano\"],summary:\"Talking piano illusion only works if you know the words, but what if you only sort of know them?\"};function y(a={}){let{wrapper:t}=a.components||{};return t?(0,e.jsx)(t,Object.assign({},a,{children:(0,e.jsx)(i,{})})):i();function i(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",code:\"code\",blockquote:\"blockquote\",p:\"p\",hr:\"hr\",img:\"img\",ul:\"ul\",li:\"li\",br:\"br\",sup:\"sup\",em:\"em\",pre:\"pre\",section:\"section\",ol:\"ol\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\u0438\\u0433\\u0440\\u0430\\u0435\\u0442-\\u043A\\u0430\\u043A-\\u0443\\u043C\\u0435\\u0435\\u0442-plays-the-best-he-can-symphony-350\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u0438\\u0433\\u0440\\u0430\\u0435\\u0442-\\u043A\\u0430\\u043A-\\u0443\\u043C\\u0435\\u0435\\u0442-plays-the-best-he-can-symphony-350\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u0418\\u0433\\u0440\\u0430\\u0435\\u0442 \\u043A\\u0430\\u043A \\u0443\\u043C\\u0435\\u0435\\u0442 (Plays the best he can, \",(0,e.jsx)(n.code,{children:\"symphony\"}),\", 350)\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u041E\\u0434\\u0438\\u043D \\u043A\\u043E\\u043C\\u043F\\u043E\\u0437\\u0438\\u0442\\u043E\\u0440 \\u043F\\u0440\\u0438 \\u0437\\u0430\\u0440\\u0443\\u0431\\u0435\\u0436\\u043D\\u043E\\u043C \\u0432\\u043E\\u0435\\u043D\\u043D\\u043E\\u043C \\u043E\\u0440\\u043A\\u0435\\u0441\\u0442\\u0440\\u0435, \\u0441\\u043E\\u0441\\u0442\\u043E\\u044F\\u0449\\u0435\\u043C \\u0438\\u0437 \\u043B\\u044E\\u0434\\u0435\\u0439 \\u043D\\u0430 \\u0431\\u0443\\u043A\\u0432\\u0443 Y, \\u043D\\u0430\\u043F\\u0438\\u0441\\u0430\\u043B \\u0441\\u0438\\u043C\\u0444\\u043E\\u043D\\u0438\\u044E.\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u041D\\u0435\\u043F\\u043E\\u0434\\u0433\\u043E\\u0442\\u043E\\u0432\\u043B\\u0435\\u043D\\u043D\\u043E\\u043C\\u0443 \\u0441\\u043B\\u0443\\u0448\\u0430\\u0442\\u0435\\u043B\\u044E \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u0442\\u0440\\u0443\\u0434\\u043D\\u043E \\u0440\\u0430\\u0441\\u0441\\u043B\\u044B\\u0448\\u0430\\u0442\\u044C \\u0432 \\u043D\\u0435\\u0439 \\u0432\\u0441\\u0451, \\u0447\\u0442\\u043E \\u043D\\u0443\\u0436\\u043D\\u043E, \\u043F\\u043E\\u044D\\u0442\\u043E\\u043C\\u0443 \\u0430\\u0432\\u0442\\u043E\\u0440 \\u043B\\u044E\\u0431\\u0435\\u0437\\u043D\\u043E \\u043F\\u0440\\u0435\\u0434\\u043B\\u0430\\u0433\\u0430\\u0435\\u0442 \\u043D\\u0430\\u0447\\u0430\\u0442\\u044C \\u0441 \\u0440\\u0430\\u0437\\u043C\\u0438\\u043D\\u043A\\u0438.\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.p,{children:\"One composer with a foreign military band, consisting of people with the letter Y, wrote a symphony.\"}),`\n`,(0,e.jsx)(n.p,{children:\"It can be difficult for an unprepared listener to hear everything that is needed in it, so the author kindly suggests starting with a warm-up.\"}),`\n`,(0,e.jsx)(n.p,{children:\"(Google Translate)\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Attachments: \",(0,e.jsx)(n.code,{children:\"symphony.pdf\"}),\", \",(0,e.jsx)(n.code,{children:\"warmup.pdf\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"See also: \",(0,e.jsx)(n.a,{href:\"https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/symphony/WRITEUP.md\",children:\"Official write-up (Russian)\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspecting the attachments, we can see the PDFs are sheet music with some rather intersting patterns: super fast \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Tempo\",children:\"tempo\"}),\" (1500 BPM), full bar \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Rest_(music)\",children:\"rests\"}),\" are written as 4 quarters rests instead of a full rest, all \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Musical_note\",children:\"notes\"}),\" are quarter notes, the \\u201C\",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Chord_(music)\",children:\"chords\"}),\"\\u201D are very packed and spans across an unusually wide range of \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Octave\",children:\"octaves\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/symphony/sheet.png\",alt:\"Preview of symphony.pdf\"})}),`\n`,(0,e.jsx)(n.p,{children:\"When I first saw the sheet, my first idea was to look for an Optical Music Recognition (OMR) tool and play it. However, due to the fact that the chords are too packed, no OMR tool we tried was able to handle them.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspecting further into the PDF files, the metadata suggests that the PDFs are generated with \",(0,e.jsx)(n.a,{href:\"http://lilypond.org/\",children:\"GNU LilyPond\"}),\", a music notation software. Although no LilyPond source was embeded, nor decompile tool was found for LilyPond PDFs, fortunately the PDF was drawn with rather simple elements: glyphs, lines and rectangles.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With the rather structural format of the sheets, we can parse the elements in the PDF and attempt to reconstruct a MIDI out of it.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"We first pulled out \",(0,e.jsx)(n.a,{href:\"https://pypi.org/project/pdfminer/\",children:\"PDFMiner\"}),\" to convert the PDF into XML for easier parsing.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"While reading the XML output, we realized that it defaults to \",(0,e.jsx)(n.code,{children:\"WinAnsiEncoding\"}),\" for non-standard fonts which can be confusing for CIDs less than 32, I adjusted the source for it to output the raw CID for any CID below 4. (The musical notation font embeded only has 4 glyphs: Note Head (\\u{1D158}), Quarter Rest (\\u{1D13D}), \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Time_signature#common_time\",children:\"Common Time\"}),\" (\\u{1D134}), and \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Clef#G-clefs\",children:\"G Clef\"}),\" (\\u{1D11E}).)\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"img\",{alt:\"A wireframe illustration of a parsed PDF page\",src:\"/static/images/ugra-ctf-quals-2022/symphony/wireframe.svg\"}),(0,e.jsx)(\"figcaption\",{children:\"A wireframe illustration of a parsed PDF page, colored in purple are the G Clefs, in red are the note heads, in green are the quater rests, and in black are the note stems.\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"As we know, the placement of G Clefs on the \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Staff_(music)\",children:\"staff\"}),\" signifies the key of all notes on the same staff, we can use the clefs as a reference to determine the key based on their relative Y-axis difference. Since the G Clefs are placed on the most common location, we can know that \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/C_(musical_note)#Middle_C\",children:\"middle C\"}),\" would be on the first \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Ledger_line\",children:\"ledger line\"}),\" below the staff.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With the following information, we can write a script to reconstruct the MIDI from the parsed PDF.\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Coordinate of the G Clefs, to determine the placement of staffs\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"Coordinate of the quarter rests and note stems, to determine which staff they belongs to, and\",(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(\"small\",{children:\"Find the G Clef that overlaps the most with the rest/note stem in Y-axis.\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Coordinates of the note heads, to determine which note stem they belong to, and their pitches.\",(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(\"small\",{children:\"Find which note stem overlaps with the note head, trace back to the G Clef on the same staff to fint the pitch with the Y-axis difference.\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Using the parsed timing and pitch information, we reconstructed the MIDI using \",(0,e.jsx)(n.a,{href:\"https://github.com/MarkCWirt/MIDIUtil\",children:\"MIDIUtil\"}),\". Opening the MIDI file with a \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Piano_roll\",children:\"Piano Roll\"}),\" editor, we can see a very characteristic pattern.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/symphony/piano-roll.png\",alt:\"Piano roll view of the reconstructed MIDI\"})}),`\n`,(0,e.jsx)(n.p,{children:\"The pattern resembles the shape we commonly see in spectrograms of human speech, of which we can further confirm when we plot the same MIDI with frequency as the Y-axis.\"}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"img\",{alt:\"A secton of the frequency plot of the music score\",src:\"/static/images/ugra-ctf-quals-2022/symphony/parsed-spectrogram.png\"}),(0,e.jsx)(\"figcaption\",{children:\"A secton of the frequency plot of the music score\"})]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"img\",{alt:\"A spectrogram of human speech\",src:\"/static/images/ugra-ctf-quals-2022/symphony/spectrogram.png\"}),(0,e.jsxs)(\"figcaption\",{children:[\"An example of a spectrogram of human speech\",(0,e.jsx)(n.sup,{children:(0,e.jsx)(n.a,{href:\"#user-content-fn-1\",id:\"user-content-fnref-1\",\"data-footnote-ref\":!0,\"aria-describedby\":\"footnote-label\",children:\"1\"})})]})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"This reminds me of \",(0,e.jsx)(n.em,{children:\"Talking Piano Illusion\"}),\" \\u2013 an \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Auditory_illusion\",children:\"auditory illusion\"}),\" where despite only hearing a piano playing, when some words are shown in front of you, the piano sound would turn into voice in your brain. This is conducted with the sound played on the piano matching with certain frequences of the spoken words. While listening to them alone would not make any sense, once the words are shown to you, your brain will automatically bridge the gap to allow you \\u201Chear\\u201D the words.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"However, the illusion would only work if you already know the words, but in an CTF, you are supposed to figure out what was actually spoken. We have tried to adjust the instruments and tempo to make it sound more like the speech, but with no promising result. As given in the \\u201Cwarm-up\\u201D sheet, the instrument is indicated as \\u201CBlown Bottle\\u201D, which is one of the \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/General_MIDI#Pipe\",children:\"General MIDI Program instruments\"}),\". We definitely tried that too, but it did not sound much better.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspired by \",(0,e.jsx)(n.a,{href:\"https://www.youtube.com/watch?v=3UnPEcfqduw\",children:\"Game & Gig\"}),\", we decided to try playing it with \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Sine_wave\",children:\"Sine Wave\"}),\" as the instrument. This time it sounds much better, despite that we still cannot make out the full flag. We used \",(0,e.jsx)(n.a,{href:\"https://github.com/Nekodigi/Midi/\",children:\"Nekodigi/Midi\"}),\" for this purpose, and this is what we got.\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"audio\",{style:{width:\"100%\"},src:\"/static/images/ugra-ctf-quals-2022/symphony/symphony.ogg\",controls:!0}),(0,e.jsx)(\"figcaption\",{children:\"symphony.ogg (860 KB)\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Since we know that this is going to be a flag, the format would be \",(0,e.jsx)(n.code,{children:\"ugra_<word>_<word>_..._<hex>\"}),\". So the first 5 clusters must be corresponding to U, G, R, A, and _. With this piece of information, we can partially recognize some of the words read.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"uniform, \",(0,e.jsx)(\"small\",{children:\"wauw\"}),\", romeo, \",(0,e.jsx)(\"small\",{children:\"awa\"}),\", underscore, \",(0,e.jsx)(\"small\",{children:\"owo\"}),\", \",(0,e.jsx)(\"small\",{children:\"aoao\"}),\", \",(0,e.jsx)(\"small\",{children:\"o-aa\"}),\", \",(0,e.jsx)(\"small\",{children:\"rourou\"}),\", underscore, \",(0,e.jsx)(\"small\",{children:\"aoao\"}),\", bravo, november, \",(0,e.jsx)(\"small\",{children:\"aotrao\"}),\", \",(0,e.jsx)(\"small\",{children:\"etrim\"}),\", \",(0,e.jsx)(\"small\",{children:\"aotrao\"}),\", romeo, underscore, \",(0,e.jsx)(\"small\",{children:\"ueiao\"}),\", \",(0,e.jsx)(\"small\",{children:\"yeo\"}),\", romeo, \",(0,e.jsx)(\"small\",{children:\"weio\"}),\", romeo, \",(0,e.jsx)(\"small\",{children:\"waowao\"}),\", \",(0,e.jsx)(\"small\",{children:\"wauw\"}),\", \",(0,e.jsx)(\"small\",{children:\"rokan\"}),\", \",(0,e.jsx)(\"small\",{children:\"uall\"}),\", underscore, \",(0,e.jsx)(\"small\",{children:\"wauw\"}),\", \",(0,e.jsx)(\"small\",{children:\"uoyo\"}),\", \",(0,e.jsx)(\"small\",{children:\"brovia\"}),\", \",(0,e.jsx)(\"small\",{children:\"brovia\"}),\", \",(0,e.jsx)(\"small\",{children:\"uoyo\"}),\", \",(0,e.jsx)(\"small\",{children:\"oh\"}),\", \",(0,e.jsx)(\"small\",{children:\"haka\"}),\", \",(0,e.jsx)(\"small\",{children:\"ayhao\"})]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"So, when do we read U as \\u201Cuniform\\u201D?\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"That\\u2019s right. It\\u2019s the \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/NATO_phonetic_alphabet\",children:\"NATO phonetic alphabet\"}),\", and now the first 5 words makes sense.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"uniform, golf, romeo, alfa, underscore...\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"And so does the \",(0,e.jsx)(n.em,{children:\"warmup\"}),\" audio.\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"audio\",{style:{width:\"100%\"},src:\"/static/images/ugra-ctf-quals-2022/symphony/warmup.ogg\",controls:!0}),(0,e.jsx)(\"figcaption\",{children:\"warmup.ogg (819 KB)\"})]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"alfa, bravo, charlie, delta, echo, foxtrot, golf, hotel\",(0,e.jsx)(n.sup,{children:(0,e.jsx)(n.a,{href:\"#user-content-fn-2\",id:\"user-content-fnref-2\",\"data-footnote-ref\":!0,\"aria-describedby\":\"footnote-label\",children:\"2\"})}),\", india, juliett, kilo, lima, mike, november, oscar, papa, quebec, romeo, sierra, tango, uniform, victor, whiskey, x-ray, yankee, zulu, underscore, zero, one, two, tree, four, five, six, seven, eight, niner\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"However, even we have the full alphabet, it is still hard for a human to match up one to another. We had to resort to comparing the flag against the alphabet using data.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Both \",(0,e.jsx)(n.em,{children:\"symphony\"}),\" and \",(0,e.jsx)(n.em,{children:\"warmup\"}),\" are pretty well divided between words. We can easilly break down the sheet into words when two clusters are over 5 \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Bar_(music)\",children:\"bars\"}),\" apart. Once we have the set of clusters in both sheets, we can compare the ones from \",(0,e.jsx)(n.em,{children:\"symphony\"}),\" against each cluster in \",(0,e.jsx)(n.em,{children:\"warmup\"}),\" and look for the most similar one note-by-note. The algorithm comparing them is rather simple:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"difference\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:'\"\"\"a claster is a list of notes, each note is a list of pitches played.\"\"\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    matched \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"range\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        matched \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"set\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"set\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" matched \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),` total\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Using this simple metric, we finally managed to find all the words in the flag.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now, let\\u2019s listen to \",(0,e.jsx)(n.em,{children:\"symphony\"}),\" again with the correct words.\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"audio\",{style:{width:\"100%\"},src:\"/static/images/ugra-ctf-quals-2022/symphony/symphony.ogg\",controls:!0}),(0,e.jsx)(\"figcaption\",{children:\"symphony.ogg (860 KB)\"})]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"uniform, golf, romeo, alfa, underscore, whiskey, alfa, victor, yankee, underscore, oscar, bravo, november, oscar, x-ray, india, oscar, uniform, sierra, underscore, sierra, quebec, uniform, india, romeo, romeo, echo, lima, sierra, underscore, foxtrot, four, zero, delta, delta, one, foxtrot, alfa,\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Can you hear it now? Congrats!\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Flag: \",(0,e.jsx)(n.code,{children:\"ugra_wavy_obnoxious_squirrels_f40dd1fa\"})]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Fun fact: Project SEKAI is the only team in the contest that solved this challenge.\"}),`\n`]}),`\n`,(0,e.jsxs)(n.section,{\"data-footnotes\":!0,className:\"footnotes\",children:[(0,e.jsxs)(n.h2,{id:\"footnote-label\",className:\"sr-only\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#footnote-label\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Footnotes\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{id:\"user-content-fn-1\",children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Can you figure out what\\u2019s said in this piece of audio clip? 4.2 seconds, 0 ~ 5 kHz. \",(0,e.jsx)(n.a,{href:\"#user-content-fnref-1\",\"data-footnote-backref\":!0,className:\"data-footnote-backref\",\"aria-label\":\"Back to content\",children:\"\\u21A9\\uFE0E\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{id:\"user-content-fn-2\",children:[`\n`,(0,e.jsxs)(n.p,{children:[\"this was pronunced as something like /\\u02C8h\\u014Dt\\u014D/ instead of /h\\u014D\\u02C8tel/. \",(0,e.jsx)(n.a,{href:\"#user-content-fnref-2\",\"data-footnote-backref\":!0,className:\"data-footnote-backref\",\"aria-label\":\"Back to content\",children:\"\\u21A9\\uFE0E\"})]}),`\n`]}),`\n`]}),`\n`]})]})}}var N=y;return b;})();\n;return Component;","toc":[{"value":"Играет как умеет (Plays the best he can, symphony, 350)","url":"#играет-как-умеет-plays-the-best-he-can-symphony-350","depth":2}],"frontMatter":{"readingTime":{"text":"8 min read","minutes":7.39,"time":443400,"words":1478},"slug":"ugra-ctf-quals-2022/symphony","fileName":"ugra-ctf-quals-2022/symphony.md","title":"Ugra CTF Quals 2022 – Играет как умеет","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","PDF","Music","Audio Processing","Talking Piano"],"summary":"Talking piano illusion only works if you know the words, but what if you only sort of know them?"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null},{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["sahuang"],"fileName":"sahuang.md","name":"sahuang","avatar":"https://www.gravatar.com/avatar/740255f8ddc8f903d3addafb219ea077?d=identicon&s=256","specialties":["Crypto","Reverse"],"github":"https://github.com/sahuang","linkedin":"https://www.linkedin.com/in/xiaohai-xu-1a8884138/","member":true,"order":0,"description":"Rhythm Gamer. Also the team founder.","date":null}],"prev":{"title":"MOCSCTF 2022 – full of orange","date":"2022-02-28T00:00:00.000Z","draft":false,"authors":["Johnathan"],"tags":["MOCSCTF 2022","pwn","heap","Shell","overflow","Binary Exploit"],"summary":"Heap overflow for shell.","canonical":"https://github.com/nhtri2003gmail/writeup-mocsctf2022.mocsctf.com-orange","slug":"mocsctf-2022/full-of-orange"},"next":{"title":"Ugra CTF Quals 2022 – Разборчивая змейка","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","Snake","QR Code"],"summary":"Picky snake, but the one being picky is actually not the snake.","slug":"ugra-ctf-quals-2022/snekpeek"}},"__N_SSG":true}