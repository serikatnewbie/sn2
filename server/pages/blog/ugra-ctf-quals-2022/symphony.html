<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png?v=2"/><link rel="manifest" href="/static/favicons/site.webmanifest?v=2"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg?v=2" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Ugra CTF Quals 2022 – Играет как умеет</title><meta name="robots" content="follow, index"/><meta name="description" content="Talking piano illusion only works if you know the words, but what if you only sort of know them?"/><meta property="og:url" content="https://sekai.team/blog/ugra-ctf-quals-2022/symphony/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Project SEKAI"/><meta property="og:description" content="Talking piano illusion only works if you know the words, but what if you only sort of know them?"/><meta property="og:title" content="Ugra CTF Quals 2022 – Играет как умеет"/><meta property="og:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=Ugra+CTF+Quals+2022+%E2%80%93+%D0%98%D0%B3%D1%80%D0%B0%D0%B5%D1%82+%D0%BA%D0%B0%D0%BA+%D1%83%D0%BC%D0%B5%D0%B5%D1%82&amp;desc=Talking+piano+illusion+only+works+if+you+know+the+words%2C+but+what+if+you+only+sort+of+know+them%3F&amp;authors=Eana%2C+sahuang"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/ProjectSEKAIctf"/><meta name="twitter:title" content="Ugra CTF Quals 2022 – Играет как умеет"/><meta name="twitter:description" content="Talking piano illusion only works if you know the words, but what if you only sort of know them?"/><meta name="twitter:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=Ugra+CTF+Quals+2022+%E2%80%93+%D0%98%D0%B3%D1%80%D0%B0%D0%B5%D1%82+%D0%BA%D0%B0%D0%BA+%D1%83%D0%BC%D0%B5%D0%B5%D1%82&amp;desc=Talking+piano+illusion+only+works+if+you+know+the+words%2C+but+what+if+you+only+sort+of+know+them%3F&amp;authors=Eana%2C+sahuang"/><meta property="article:published_time" content="2022-03-01T00:00:00.000Z"/><link rel="canonical" href="https://sekai.team/blog/ugra-ctf-quals-2022/symphony/"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sekai.team/blog/ugra-ctf-quals-2022/symphony"
  },
  "headline": "Ugra CTF Quals 2022 – Играет как умеет",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://og-vercel-ruby.vercel.app/api/sekai?title=Ugra+CTF+Quals+2022+%E2%80%93+%D0%98%D0%B3%D1%80%D0%B0%D0%B5%D1%82+%D0%BA%D0%B0%D0%BA+%D1%83%D0%BC%D0%B5%D0%B5%D1%82&desc=Talking+piano+illusion+only+works+if+you+know+the+words%2C+but+what+if+you+only+sort+of+know+them%3F&authors=Eana%2C+sahuang"
    }
  ],
  "datePublished": "2022-03-01T00:00:00.000Z",
  "dateModified": "2022-03-01T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Eana"
    },
    {
      "@type": "Person",
      "name": "sahuang"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Project SEKAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sekai.team/static/images/fullLogo.svg"
    }
  },
  "description": "Talking piano illusion only works if you know the words, but what if you only sort of know them?"
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/206f24680f6266ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/206f24680f6266ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-09a75c9ee2bd415e.js" defer=""></script><script src="/_next/static/chunks/main-b8c3e234d7065a2c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8cbc7cb85baf88e.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/29107295-a2d0c8e72019a3ed.js" defer=""></script><script src="/_next/static/chunks/545-f1dc6b53ce85b08b.js" defer=""></script><script src="/_next/static/chunks/930-1296a6163e1e3cc6.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-9a47024c9df525b8.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_buildManifest.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_ssgManifest.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Visit home page" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 468.7 215.63" height="80" width="auto"><defs><linearGradient id="fullLogo_svg__linear-gradient" x1="-7051.74" y1="5608.42" x2="-7051.74" y2="5392.1" gradientTransform="matrix(1 0 .15 -.99 6503.98 5547.9)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00e5ea"></stop><stop offset="1" stop-color="#00b5cc"></stop></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-2" x1="1498.32" y1="4428.84" x2="1497.92" y2="4311.82" gradientTransform="matrix(1 0 0 -1 -1107.01 4435.41)" xlink:href="#fullLogo_svg__linear-gradient"></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-3" x1="320.76" y1="14.17" x2="320.76" y2="47.97" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0069a5"></stop><stop offset="1" stop-color="#003d6b"></stop></linearGradient><style>.fullLogo_svg__cls-1{fill:#fff}</style></defs><g id="fullLogo_svg__Project_SEKAI_Wide_White" data-name="Project SEKAI Wide White"><path class="fullLogo_svg__cls-1" d="M107 117.14v-4c11.93 0 22.15-8.62 23.76-20l12.91-91.63h4.06l-13 92.14c-1.92 13.4-13.84 23.49-27.73 23.49Z"></path><path class="fullLogo_svg__cls-1" d="M97.43 98.3a16 16 0 0 1-16.26-18.72l8.68-61.42A21.78 21.78 0 0 1 110.77 0a16.34 16.34 0 0 1 12.57 5.5A16.36 16.36 0 0 1 127 18.72l-8.69 61.42c-1.39 10.01-10.77 18.16-20.88 18.16ZM110.77 4a17.63 17.63 0 0 0-17 14.72l-8.64 61.42a12 12 0 0 0 12.3 14.16 17.65 17.65 0 0 0 16.95-14.72l8.69-61.42a12.41 12.41 0 0 0-2.75-10A12.4 12.4 0 0 0 110.77 4ZM186.94 5.42l.56-3.91H162.99l-13.5 95.44H174l.57-4h-20.46l5.85-41.36h20.46l.56-4h-20.45l5.96-42.17h20.45zM266.73 1.51h-31.01l-.55 3.91h14.2l-12.95 91.53h4.06l12.93-91.53h12.77l.55-3.91zM212.61 1.51a15.86 15.86 0 0 0-15.24 13.24l-9.86 69.48a11.69 11.69 0 0 0 2.76 9.34 12.57 12.57 0 0 0 9.18 4.43h.2c6.38 0 11.65-5.57 15.15-9.28L211.9 86c-3.06 3.23-7.67 8.11-12.38 8a8.54 8.54 0 0 1-6.21-3 7.73 7.73 0 0 1-1.84-6.18l9.86-69.48a11.83 11.83 0 0 1 11.28-9.9h13.91l.55-3.91ZM37.08 5.58a12 12 0 0 0-9.26-4.06H13.5L0 97h4.06l6.41-45.37h10.84a15.87 15.87 0 0 0 15.24-13.29l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.26 23a11.74 11.74 0 0 1-11.27 9.8H11l6-42.13h10.85a7.94 7.94 0 0 1 8 9.33ZM75.09 5.58a12 12 0 0 0-9.26-4.06h-14.3L38 97h4l6.5-45.42h10L65 96.2h4l-6.6-45a16 16 0 0 0 12.16-12.86l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.25 23a11.76 11.76 0 0 1-11.28 9.8H49.07L55 5.42h10.86a7.94 7.94 0 0 1 8 9.33ZM223.75 215.47h-4.06l13.5-95.43h4.05l-13.49 95.43zM65.83 215.63a14.49 14.49 0 0 1-11-4.65 11.3 11.3 0 0 1-2.68-9.15l1.31-8.59 4.4-2.34-1.76 11.52a7.24 7.24 0 0 0 1.75 5.93 10.47 10.47 0 0 0 8 3.28c6.42 0 12.26-4.39 13-9.8l5.42-38.33-28.77 15.27 6.37-46c1-7.3 8.65-13.24 17-13.24a14.52 14.52 0 0 1 11 4.65 11.36 11.36 0 0 1 2.68 9.14l-1.2 8.68-4.35 2.34 1.64-11.6a7.29 7.29 0 0 0-1.74-6 10.5 10.5 0 0 0-8-3.28c-6.42 0-12.26 4.39-13 9.79l-5.29 38.27 28.8-15.28-6.52 46.1c-1.11 7.35-8.73 13.29-17.06 13.29ZM174.15 120.04h-4.51l-26.9 51.72 7.31-51.72H146l-13.5 95.43h4.05l4.5-31.8 10.61-20.4 12.61 52.2h4.11l-13.91-57.6 19.68-37.83zM205 215.47h4l-2.29-94.87v-.56h-4l-29.31 95.43h4.18l9.82-32h16.83Zm-16.37-36L203 132.68l1.13 46.81ZM132.58 123.94l.56-3.91h-24.52l-13.49 95.44h24.51l.56-4H99.75l5.85-41.36h20.45l.57-4h-20.46l5.97-42.17h20.45z"></path><path style="fill:url(#fullLogo_svg__linear-gradient)" d="M279.69 1.51h8.87l-32.09 213.93h-8.87L279.69 1.51z"></path><path d="M393.81 14.88C396 .34 331.4 1.5 296.53 1.5L283.6 87.67c33.36-1.94 99.5-2 97.21 13.27-1.14 7.58-5.53 7.29-6.1 11.08-1.52 10.14 70.94 5.62 81.15 4.52L434 73.6l34.7-43.29c-17.47 1.81-82.47 4.94-81.11-4.15.73-4.87 5.41-5.56 6.22-11.28Z" style="fill:url(#fullLogo_svg__linear-gradient-2)"></path><path d="m324.34 13-5.8 25.24A9.73 9.73 0 0 0 312 36c-4.66 0-8.43 2.82-8.42 6.27s3.8 6.24 8.46 6.22c4 0 7.4-2.12 8.23-4.92 0-.14.06-.28.09-.42l3.48-15.5q9.18 2.06 9.72 5.26a9 9 0 0 1-1.27 6.22 10.78 10.78 0 0 0 5.7-8.81q.48-5.88-13.65-17.32Z" style="fill:url(#fullLogo_svg__linear-gradient-3)"></path></g></svg></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/members/">Members</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/contests/">Contests</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags/">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">CTF 2023</a></div><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/members/">Members</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/contests/">Contests</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">CTF 2023</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-03-01T00:00:00.000Z">Tuesday, 1 March 2022</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Ugra CTF Quals 2022 – Играет как умеет</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Eana</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/blueset" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@blueset</a></dd></dl></li><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/740255f8ddc8f903d3addafb219ea077?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">sahuang</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://github.com/sahuang" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@sahuang</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><h2 id="играет-как-умеет-plays-the-best-he-can-symphony-350"><a href="#играет-как-умеет-plays-the-best-he-can-symphony-350" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Играет как умеет (Plays the best he can, <code>symphony</code>, 350)</h2>
<blockquote>
<p>Один композитор при зарубежном военном оркестре, состоящем из людей на букву Y, написал симфонию.</p>
<p>Неподготовленному слушателю может быть трудно расслышать в ней всё, что нужно, поэтому автор любезно предлагает начать с разминки.</p>
<hr/>
<p>One composer with a foreign military band, consisting of people with the letter Y, wrote a symphony.</p>
<p>It can be difficult for an unprepared listener to hear everything that is needed in it, so the author kindly suggests starting with a warm-up.</p>
<p>(Google Translate)</p>
<p>Attachments: <code>symphony.pdf</code>, <code>warmup.pdf</code></p>
</blockquote>
<p>See also: <a target="_blank" rel="noopener noreferrer" href="https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/symphony/WRITEUP.md">Official write-up (Russian)</a></p>
<p>Inspecting the attachments, we can see the PDFs are sheet music with some rather intersting patterns: super fast <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Tempo">tempo</a> (1500 BPM), full bar <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Rest_(music)">rests</a> are written as 4 quarters rests instead of a full rest, all <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Musical_note">notes</a> are quarter notes, the “<a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Chord_(music)">chords</a>” are very packed and spans across an unusually wide range of <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Octave">octaves</a>.</p>
<p><img src="/static/images/ugra-ctf-quals-2022/symphony/sheet.png" alt="Preview of symphony.pdf"/></p>
<p>When I first saw the sheet, my first idea was to look for an Optical Music Recognition (OMR) tool and play it. However, due to the fact that the chords are too packed, no OMR tool we tried was able to handle them.</p>
<p>Inspecting further into the PDF files, the metadata suggests that the PDFs are generated with <a target="_blank" rel="noopener noreferrer" href="http://lilypond.org/">GNU LilyPond</a>, a music notation software. Although no LilyPond source was embeded, nor decompile tool was found for LilyPond PDFs, fortunately the PDF was drawn with rather simple elements: glyphs, lines and rectangles.</p>
<p>With the rather structural format of the sheets, we can parse the elements in the PDF and attempt to reconstruct a MIDI out of it.</p>
<p>We first pulled out <a target="_blank" rel="noopener noreferrer" href="https://pypi.org/project/pdfminer/">PDFMiner</a> to convert the PDF into XML for easier parsing.</p>
<p>While reading the XML output, we realized that it defaults to <code>WinAnsiEncoding</code> for non-standard fonts which can be confusing for CIDs less than 32, I adjusted the source for it to output the raw CID for any CID below 4. (The musical notation font embeded only has 4 glyphs: Note Head (𝅘), Quarter Rest (𝄽), <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Time_signature#common_time">Common Time</a> (𝄴), and <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Clef#G-clefs">G Clef</a> (𝄞).)</p>
<figure><img alt="A wireframe illustration of a parsed PDF page" src="/static/images/ugra-ctf-quals-2022/symphony/wireframe.svg"/><figcaption>A wireframe illustration of a parsed PDF page, colored in purple are the G Clefs, in red are the note heads, in green are the quater rests, and in black are the note stems.</figcaption></figure>
<p>As we know, the placement of G Clefs on the <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Staff_(music)">staff</a> signifies the key of all notes on the same staff, we can use the clefs as a reference to determine the key based on their relative Y-axis difference. Since the G Clefs are placed on the most common location, we can know that <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/C_(musical_note)#Middle_C">middle C</a> would be on the first <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Ledger_line">ledger line</a> below the staff.</p>
<p>With the following information, we can write a script to reconstruct the MIDI from the parsed PDF.</p>
<ul>
<li>Coordinate of the G Clefs, to determine the placement of staffs</li>
<li>Coordinate of the quarter rests and note stems, to determine which staff they belongs to, and<br/>
<small>Find the G Clef that overlaps the most with the rest/note stem in Y-axis.</small></li>
<li>Coordinates of the note heads, to determine which note stem they belong to, and their pitches.<br/>
<small>Find which note stem overlaps with the note head, trace back to the G Clef on the same staff to fint the pitch with the Y-axis difference.</small></li>
</ul>
<p>Using the parsed timing and pitch information, we reconstructed the MIDI using <a target="_blank" rel="noopener noreferrer" href="https://github.com/MarkCWirt/MIDIUtil">MIDIUtil</a>. Opening the MIDI file with a <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Piano_roll">Piano Roll</a> editor, we can see a very characteristic pattern.</p>
<p><img src="/static/images/ugra-ctf-quals-2022/symphony/piano-roll.png" alt="Piano roll view of the reconstructed MIDI"/></p>
<p>The pattern resembles the shape we commonly see in spectrograms of human speech, of which we can further confirm when we plot the same MIDI with frequency as the Y-axis.</p>
<figure><img alt="A secton of the frequency plot of the music score" src="/static/images/ugra-ctf-quals-2022/symphony/parsed-spectrogram.png"/><figcaption>A secton of the frequency plot of the music score</figcaption></figure>
<figure><img alt="A spectrogram of human speech" src="/static/images/ugra-ctf-quals-2022/symphony/spectrogram.png"/><figcaption>An example of a spectrogram of human speech<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></figcaption></figure>
<p>This reminds me of <em>Talking Piano Illusion</em> – an <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Auditory_illusion">auditory illusion</a> where despite only hearing a piano playing, when some words are shown in front of you, the piano sound would turn into voice in your brain. This is conducted with the sound played on the piano matching with certain frequences of the spoken words. While listening to them alone would not make any sense, once the words are shown to you, your brain will automatically bridge the gap to allow you “hear” the words.</p>
<p>However, the illusion would only work if you already know the words, but in an CTF, you are supposed to figure out what was actually spoken. We have tried to adjust the instruments and tempo to make it sound more like the speech, but with no promising result. As given in the “warm-up” sheet, the instrument is indicated as “Blown Bottle”, which is one of the <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/General_MIDI#Pipe">General MIDI Program instruments</a>. We definitely tried that too, but it did not sound much better.</p>
<p>Inspired by <a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=3UnPEcfqduw">Game &amp; Gig</a>, we decided to try playing it with <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Sine_wave">Sine Wave</a> as the instrument. This time it sounds much better, despite that we still cannot make out the full flag. We used <a target="_blank" rel="noopener noreferrer" href="https://github.com/Nekodigi/Midi/">Nekodigi/Midi</a> for this purpose, and this is what we got.</p>
<figure><audio style="width:100%" src="/static/images/ugra-ctf-quals-2022/symphony/symphony.ogg" controls=""></audio><figcaption>symphony.ogg (860 KB)</figcaption></figure>
<p>Since we know that this is going to be a flag, the format would be <code>ugra_&lt;word&gt;_&lt;word&gt;_..._&lt;hex&gt;</code>. So the first 5 clusters must be corresponding to U, G, R, A, and _. With this piece of information, we can partially recognize some of the words read.</p>
<blockquote>
<p>uniform, <small>wauw</small>, romeo, <small>awa</small>, underscore, <small>owo</small>, <small>aoao</small>, <small>o-aa</small>, <small>rourou</small>, underscore, <small>aoao</small>, bravo, november, <small>aotrao</small>, <small>etrim</small>, <small>aotrao</small>, romeo, underscore, <small>ueiao</small>, <small>yeo</small>, romeo, <small>weio</small>, romeo, <small>waowao</small>, <small>wauw</small>, <small>rokan</small>, <small>uall</small>, underscore, <small>wauw</small>, <small>uoyo</small>, <small>brovia</small>, <small>brovia</small>, <small>uoyo</small>, <small>oh</small>, <small>haka</small>, <small>ayhao</small></p>
</blockquote>
<p>So, when do we read U as “uniform”?</p>
<p>That’s right. It’s the <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/NATO_phonetic_alphabet">NATO phonetic alphabet</a>, and now the first 5 words makes sense.</p>
<blockquote>
<p>uniform, golf, romeo, alfa, underscore...</p>
</blockquote>
<p>And so does the <em>warmup</em> audio.</p>
<figure><audio style="width:100%" src="/static/images/ugra-ctf-quals-2022/symphony/warmup.ogg" controls=""></audio><figcaption>warmup.ogg (819 KB)</figcaption></figure>
<blockquote>
<p>alfa, bravo, charlie, delta, echo, foxtrot, golf, hotel<sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>, india, juliett, kilo, lima, mike, november, oscar, papa, quebec, romeo, sierra, tango, uniform, victor, whiskey, x-ray, yankee, zulu, underscore, zero, one, two, tree, four, five, six, seven, eight, niner</p>
</blockquote>
<p>However, even we have the full alphabet, it is still hard for a human to match up one to another. We had to resort to comparing the flag against the alphabet using data.</p>
<p>Both <em>symphony</em> and <em>warmup</em> are pretty well divided between words. We can easilly break down the sheet into words when two clusters are over 5 <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Bar_(music)">bars</a> apart. Once we have the set of clusters in both sheets, we can compare the ones from <em>symphony</em> against each cluster in <em>warmup</em> and look for the most similar one note-by-note. The algorithm comparing them is rather simple:</p>
<div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">difference</span><span class="token punctuation">(</span>cluster1<span class="token punctuation">,</span> cluster2<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;a claster is a list of notes, each note is a list of pitches played.&quot;&quot;&quot;</span>
</span><span class="code-line">    total <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    matched <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cluster1<span class="token punctuation">)</span><span class="token punctuation">,</span> cluster2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> idx <span class="token operator">&gt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cluster1<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            total <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cluster2<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">continue</span>
</span><span class="code-line">        <span class="token keyword">if</span> idx <span class="token operator">&gt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cluster2<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            total <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cluster1<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">continue</span>
</span><span class="code-line">        total <span class="token operator">+=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cluster1<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cluster2<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        matched <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>cluster1<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">set</span><span class="token punctuation">(</span>cluster2<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> matched <span class="token operator">/</span> total
</span></code></pre></div>
<p>Using this simple metric, we finally managed to find all the words in the flag.</p>
<p>Now, let’s listen to <em>symphony</em> again with the correct words.</p>
<figure><audio style="width:100%" src="/static/images/ugra-ctf-quals-2022/symphony/symphony.ogg" controls=""></audio><figcaption>symphony.ogg (860 KB)</figcaption></figure>
<blockquote>
<p>uniform, golf, romeo, alfa, underscore, whiskey, alfa, victor, yankee, underscore, oscar, bravo, november, oscar, x-ray, india, oscar, uniform, sierra, underscore, sierra, quebec, uniform, india, romeo, romeo, echo, lima, sierra, underscore, foxtrot, four, zero, delta, delta, one, foxtrot, alfa,</p>
</blockquote>
<p>Can you hear it now? Congrats!</p>
<p>Flag: <code>ugra_wavy_obnoxious_squirrels_f40dd1fa</code></p>
<blockquote>
<p>Fun fact: Project SEKAI is the only team in the contest that solved this challenge.</p>
</blockquote>
<section data-footnotes="true" class="footnotes"><h2 id="footnote-label" class="sr-only"><a href="#footnote-label" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Footnotes</h2>
<ol>
<li id="user-content-fn-1">
<p>Can you figure out what’s said in this piece of audio clip? 4.2 seconds, 0 ~ 5 kHz. <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩︎</a></p>
</li>
<li id="user-content-fn-2">
<p>this was pronunced as something like /ˈhōtō/ instead of /hōˈtel/. <a href="#user-content-fnref-2" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩︎</a></p>
</li>
</ol>
</section></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fsekai.team%2Fblog%2Fugra-ctf-quals-2022%2Fsymphony">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/blueset/sekai.team/blob/master/data/blog/ugra-ctf-quals-2022/symphony.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ugra-ctf-quals-2022/">Ugra-CTF-Quals-2022</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/misc/">Misc</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/pdf/">PDF</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/music/">Music</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/audio-processing/">Audio-Processing</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/talking-piano/">Talking-Piano</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/mocsctf-2022/full-of-orange/">MOCSCTF 2022 – full of orange</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ugra-ctf-quals-2022/snekpeek/">Ugra CTF Quals 2022 – Разборчивая змейка</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:project.sekai@sekai.team"><span class="sr-only"><span class="w-6">mail</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/project-sekai-ctf"><span class="sr-only"><span class="w-6">github</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/project-sekai-ctf/"><span class="sr-only"><span class="w-6">linkedin</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ProjectSEKAIctf"><span class="sr-only"><span class="w-6">twitter</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/169557"><span class="sr-only"><span class="w-6">ctftime</span></span><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M24 0v24H0V0h24Zm-3.077 3.077L7.067 3.076 16 12.816 10.369 19l-2.195-2.612 3.476-3.573-8.574-9.609v17.717h17.847V3.077Z" fill="currentColor" fill-rule="evenodd"></path></svg></a></div></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><a href="/">Project SEKAI</a><div> • </div><div>© 2024</div><div> • </div><div><a href="https://1a23.com">1A23 Studio</a></div></div><div class="mb-8 text-xs text-center text-gray-200 dark:text-gray-700">This website is in no way affiliated with any of the following individuals or organizations.<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a> © Timothy Lim and contributors; <a target="_blank" rel="noopener noreferrer" href="https://pjsekai.sega.jp/">Project SEKAI: Colorful Stage! feat. Hatsune Miku</a> © SEGA / © Craft Egg Inc. Developed by Colorful Palette; <a target="_blank" rel="noopener noreferrer" href="https://ec.crypton.co.jp/pages/prod/virtualsinger">Character Vocal Series</a> © Crypton Future Media, INC. <a target="_blank" rel="noopener noreferrer" href="https://www.piapro.net">www.piapro.net</a> All rights reserved.</div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var c=Object.create;var s=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var o=a=\u003es(a,\"__esModule\",{value:!0});var m=(a,t)=\u003e()=\u003e(t||a((t={exports:{}}).exports,t),t.exports),f=(a,t)=\u003e{o(a);for(var i in t)s(a,i,{get:t[i],enumerable:!0})},w=(a,t,i)=\u003e{if(t\u0026\u0026typeof t==\"object\"||typeof t==\"function\")for(let n of d(t))!u.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026s(a,n,{get:()=\u003et[n],enumerable:!(i=h(t,n))||i.enumerable});return a},g=a=\u003ew(o(s(a!=null?c(p(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var l=m((x,r)=\u003e{r.exports=_jsx_runtime});var b={};f(b,{default:()=\u003eN,frontmatter:()=\u003ek});var e=g(l()),k={title:\"Ugra CTF Quals 2022 \\u2013 \\u0418\\u0433\\u0440\\u0430\\u0435\\u0442 \\u043A\\u0430\\u043A \\u0443\\u043C\\u0435\\u0435\\u0442\",date:\"2022-03-01\",draft:!1,authors:[\"blueset\",\"sahuang\"],tags:[\"Ugra CTF Quals 2022\",\"Misc\",\"PDF\",\"Music\",\"Audio Processing\",\"Talking Piano\"],summary:\"Talking piano illusion only works if you know the words, but what if you only sort of know them?\"};function y(a={}){let{wrapper:t}=a.components||{};return t?(0,e.jsx)(t,Object.assign({},a,{children:(0,e.jsx)(i,{})})):i();function i(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",code:\"code\",blockquote:\"blockquote\",p:\"p\",hr:\"hr\",img:\"img\",ul:\"ul\",li:\"li\",br:\"br\",sup:\"sup\",em:\"em\",pre:\"pre\",section:\"section\",ol:\"ol\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\u0438\\u0433\\u0440\\u0430\\u0435\\u0442-\\u043A\\u0430\\u043A-\\u0443\\u043C\\u0435\\u0435\\u0442-plays-the-best-he-can-symphony-350\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u0438\\u0433\\u0440\\u0430\\u0435\\u0442-\\u043A\\u0430\\u043A-\\u0443\\u043C\\u0435\\u0435\\u0442-plays-the-best-he-can-symphony-350\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u0418\\u0433\\u0440\\u0430\\u0435\\u0442 \\u043A\\u0430\\u043A \\u0443\\u043C\\u0435\\u0435\\u0442 (Plays the best he can, \",(0,e.jsx)(n.code,{children:\"symphony\"}),\", 350)\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u041E\\u0434\\u0438\\u043D \\u043A\\u043E\\u043C\\u043F\\u043E\\u0437\\u0438\\u0442\\u043E\\u0440 \\u043F\\u0440\\u0438 \\u0437\\u0430\\u0440\\u0443\\u0431\\u0435\\u0436\\u043D\\u043E\\u043C \\u0432\\u043E\\u0435\\u043D\\u043D\\u043E\\u043C \\u043E\\u0440\\u043A\\u0435\\u0441\\u0442\\u0440\\u0435, \\u0441\\u043E\\u0441\\u0442\\u043E\\u044F\\u0449\\u0435\\u043C \\u0438\\u0437 \\u043B\\u044E\\u0434\\u0435\\u0439 \\u043D\\u0430 \\u0431\\u0443\\u043A\\u0432\\u0443 Y, \\u043D\\u0430\\u043F\\u0438\\u0441\\u0430\\u043B \\u0441\\u0438\\u043C\\u0444\\u043E\\u043D\\u0438\\u044E.\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u041D\\u0435\\u043F\\u043E\\u0434\\u0433\\u043E\\u0442\\u043E\\u0432\\u043B\\u0435\\u043D\\u043D\\u043E\\u043C\\u0443 \\u0441\\u043B\\u0443\\u0448\\u0430\\u0442\\u0435\\u043B\\u044E \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u0442\\u0440\\u0443\\u0434\\u043D\\u043E \\u0440\\u0430\\u0441\\u0441\\u043B\\u044B\\u0448\\u0430\\u0442\\u044C \\u0432 \\u043D\\u0435\\u0439 \\u0432\\u0441\\u0451, \\u0447\\u0442\\u043E \\u043D\\u0443\\u0436\\u043D\\u043E, \\u043F\\u043E\\u044D\\u0442\\u043E\\u043C\\u0443 \\u0430\\u0432\\u0442\\u043E\\u0440 \\u043B\\u044E\\u0431\\u0435\\u0437\\u043D\\u043E \\u043F\\u0440\\u0435\\u0434\\u043B\\u0430\\u0433\\u0430\\u0435\\u0442 \\u043D\\u0430\\u0447\\u0430\\u0442\\u044C \\u0441 \\u0440\\u0430\\u0437\\u043C\\u0438\\u043D\\u043A\\u0438.\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.p,{children:\"One composer with a foreign military band, consisting of people with the letter Y, wrote a symphony.\"}),`\n`,(0,e.jsx)(n.p,{children:\"It can be difficult for an unprepared listener to hear everything that is needed in it, so the author kindly suggests starting with a warm-up.\"}),`\n`,(0,e.jsx)(n.p,{children:\"(Google Translate)\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Attachments: \",(0,e.jsx)(n.code,{children:\"symphony.pdf\"}),\", \",(0,e.jsx)(n.code,{children:\"warmup.pdf\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"See also: \",(0,e.jsx)(n.a,{href:\"https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/symphony/WRITEUP.md\",children:\"Official write-up (Russian)\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspecting the attachments, we can see the PDFs are sheet music with some rather intersting patterns: super fast \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Tempo\",children:\"tempo\"}),\" (1500 BPM), full bar \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Rest_(music)\",children:\"rests\"}),\" are written as 4 quarters rests instead of a full rest, all \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Musical_note\",children:\"notes\"}),\" are quarter notes, the \\u201C\",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Chord_(music)\",children:\"chords\"}),\"\\u201D are very packed and spans across an unusually wide range of \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Octave\",children:\"octaves\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/symphony/sheet.png\",alt:\"Preview of symphony.pdf\"})}),`\n`,(0,e.jsx)(n.p,{children:\"When I first saw the sheet, my first idea was to look for an Optical Music Recognition (OMR) tool and play it. However, due to the fact that the chords are too packed, no OMR tool we tried was able to handle them.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspecting further into the PDF files, the metadata suggests that the PDFs are generated with \",(0,e.jsx)(n.a,{href:\"http://lilypond.org/\",children:\"GNU LilyPond\"}),\", a music notation software. Although no LilyPond source was embeded, nor decompile tool was found for LilyPond PDFs, fortunately the PDF was drawn with rather simple elements: glyphs, lines and rectangles.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With the rather structural format of the sheets, we can parse the elements in the PDF and attempt to reconstruct a MIDI out of it.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"We first pulled out \",(0,e.jsx)(n.a,{href:\"https://pypi.org/project/pdfminer/\",children:\"PDFMiner\"}),\" to convert the PDF into XML for easier parsing.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"While reading the XML output, we realized that it defaults to \",(0,e.jsx)(n.code,{children:\"WinAnsiEncoding\"}),\" for non-standard fonts which can be confusing for CIDs less than 32, I adjusted the source for it to output the raw CID for any CID below 4. (The musical notation font embeded only has 4 glyphs: Note Head (\\u{1D158}), Quarter Rest (\\u{1D13D}), \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Time_signature#common_time\",children:\"Common Time\"}),\" (\\u{1D134}), and \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Clef#G-clefs\",children:\"G Clef\"}),\" (\\u{1D11E}).)\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"img\",{alt:\"A wireframe illustration of a parsed PDF page\",src:\"/static/images/ugra-ctf-quals-2022/symphony/wireframe.svg\"}),(0,e.jsx)(\"figcaption\",{children:\"A wireframe illustration of a parsed PDF page, colored in purple are the G Clefs, in red are the note heads, in green are the quater rests, and in black are the note stems.\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"As we know, the placement of G Clefs on the \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Staff_(music)\",children:\"staff\"}),\" signifies the key of all notes on the same staff, we can use the clefs as a reference to determine the key based on their relative Y-axis difference. Since the G Clefs are placed on the most common location, we can know that \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/C_(musical_note)#Middle_C\",children:\"middle C\"}),\" would be on the first \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Ledger_line\",children:\"ledger line\"}),\" below the staff.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With the following information, we can write a script to reconstruct the MIDI from the parsed PDF.\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Coordinate of the G Clefs, to determine the placement of staffs\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"Coordinate of the quarter rests and note stems, to determine which staff they belongs to, and\",(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(\"small\",{children:\"Find the G Clef that overlaps the most with the rest/note stem in Y-axis.\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Coordinates of the note heads, to determine which note stem they belong to, and their pitches.\",(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(\"small\",{children:\"Find which note stem overlaps with the note head, trace back to the G Clef on the same staff to fint the pitch with the Y-axis difference.\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Using the parsed timing and pitch information, we reconstructed the MIDI using \",(0,e.jsx)(n.a,{href:\"https://github.com/MarkCWirt/MIDIUtil\",children:\"MIDIUtil\"}),\". Opening the MIDI file with a \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Piano_roll\",children:\"Piano Roll\"}),\" editor, we can see a very characteristic pattern.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/symphony/piano-roll.png\",alt:\"Piano roll view of the reconstructed MIDI\"})}),`\n`,(0,e.jsx)(n.p,{children:\"The pattern resembles the shape we commonly see in spectrograms of human speech, of which we can further confirm when we plot the same MIDI with frequency as the Y-axis.\"}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"img\",{alt:\"A secton of the frequency plot of the music score\",src:\"/static/images/ugra-ctf-quals-2022/symphony/parsed-spectrogram.png\"}),(0,e.jsx)(\"figcaption\",{children:\"A secton of the frequency plot of the music score\"})]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"img\",{alt:\"A spectrogram of human speech\",src:\"/static/images/ugra-ctf-quals-2022/symphony/spectrogram.png\"}),(0,e.jsxs)(\"figcaption\",{children:[\"An example of a spectrogram of human speech\",(0,e.jsx)(n.sup,{children:(0,e.jsx)(n.a,{href:\"#user-content-fn-1\",id:\"user-content-fnref-1\",\"data-footnote-ref\":!0,\"aria-describedby\":\"footnote-label\",children:\"1\"})})]})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"This reminds me of \",(0,e.jsx)(n.em,{children:\"Talking Piano Illusion\"}),\" \\u2013 an \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Auditory_illusion\",children:\"auditory illusion\"}),\" where despite only hearing a piano playing, when some words are shown in front of you, the piano sound would turn into voice in your brain. This is conducted with the sound played on the piano matching with certain frequences of the spoken words. While listening to them alone would not make any sense, once the words are shown to you, your brain will automatically bridge the gap to allow you \\u201Chear\\u201D the words.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"However, the illusion would only work if you already know the words, but in an CTF, you are supposed to figure out what was actually spoken. We have tried to adjust the instruments and tempo to make it sound more like the speech, but with no promising result. As given in the \\u201Cwarm-up\\u201D sheet, the instrument is indicated as \\u201CBlown Bottle\\u201D, which is one of the \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/General_MIDI#Pipe\",children:\"General MIDI Program instruments\"}),\". We definitely tried that too, but it did not sound much better.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspired by \",(0,e.jsx)(n.a,{href:\"https://www.youtube.com/watch?v=3UnPEcfqduw\",children:\"Game \u0026 Gig\"}),\", we decided to try playing it with \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Sine_wave\",children:\"Sine Wave\"}),\" as the instrument. This time it sounds much better, despite that we still cannot make out the full flag. We used \",(0,e.jsx)(n.a,{href:\"https://github.com/Nekodigi/Midi/\",children:\"Nekodigi/Midi\"}),\" for this purpose, and this is what we got.\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"audio\",{style:{width:\"100%\"},src:\"/static/images/ugra-ctf-quals-2022/symphony/symphony.ogg\",controls:!0}),(0,e.jsx)(\"figcaption\",{children:\"symphony.ogg (860 KB)\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Since we know that this is going to be a flag, the format would be \",(0,e.jsx)(n.code,{children:\"ugra_\u003cword\u003e_\u003cword\u003e_..._\u003chex\u003e\"}),\". So the first 5 clusters must be corresponding to U, G, R, A, and _. With this piece of information, we can partially recognize some of the words read.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"uniform, \",(0,e.jsx)(\"small\",{children:\"wauw\"}),\", romeo, \",(0,e.jsx)(\"small\",{children:\"awa\"}),\", underscore, \",(0,e.jsx)(\"small\",{children:\"owo\"}),\", \",(0,e.jsx)(\"small\",{children:\"aoao\"}),\", \",(0,e.jsx)(\"small\",{children:\"o-aa\"}),\", \",(0,e.jsx)(\"small\",{children:\"rourou\"}),\", underscore, \",(0,e.jsx)(\"small\",{children:\"aoao\"}),\", bravo, november, \",(0,e.jsx)(\"small\",{children:\"aotrao\"}),\", \",(0,e.jsx)(\"small\",{children:\"etrim\"}),\", \",(0,e.jsx)(\"small\",{children:\"aotrao\"}),\", romeo, underscore, \",(0,e.jsx)(\"small\",{children:\"ueiao\"}),\", \",(0,e.jsx)(\"small\",{children:\"yeo\"}),\", romeo, \",(0,e.jsx)(\"small\",{children:\"weio\"}),\", romeo, \",(0,e.jsx)(\"small\",{children:\"waowao\"}),\", \",(0,e.jsx)(\"small\",{children:\"wauw\"}),\", \",(0,e.jsx)(\"small\",{children:\"rokan\"}),\", \",(0,e.jsx)(\"small\",{children:\"uall\"}),\", underscore, \",(0,e.jsx)(\"small\",{children:\"wauw\"}),\", \",(0,e.jsx)(\"small\",{children:\"uoyo\"}),\", \",(0,e.jsx)(\"small\",{children:\"brovia\"}),\", \",(0,e.jsx)(\"small\",{children:\"brovia\"}),\", \",(0,e.jsx)(\"small\",{children:\"uoyo\"}),\", \",(0,e.jsx)(\"small\",{children:\"oh\"}),\", \",(0,e.jsx)(\"small\",{children:\"haka\"}),\", \",(0,e.jsx)(\"small\",{children:\"ayhao\"})]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"So, when do we read U as \\u201Cuniform\\u201D?\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"That\\u2019s right. It\\u2019s the \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/NATO_phonetic_alphabet\",children:\"NATO phonetic alphabet\"}),\", and now the first 5 words makes sense.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"uniform, golf, romeo, alfa, underscore...\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"And so does the \",(0,e.jsx)(n.em,{children:\"warmup\"}),\" audio.\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"audio\",{style:{width:\"100%\"},src:\"/static/images/ugra-ctf-quals-2022/symphony/warmup.ogg\",controls:!0}),(0,e.jsx)(\"figcaption\",{children:\"warmup.ogg (819 KB)\"})]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"alfa, bravo, charlie, delta, echo, foxtrot, golf, hotel\",(0,e.jsx)(n.sup,{children:(0,e.jsx)(n.a,{href:\"#user-content-fn-2\",id:\"user-content-fnref-2\",\"data-footnote-ref\":!0,\"aria-describedby\":\"footnote-label\",children:\"2\"})}),\", india, juliett, kilo, lima, mike, november, oscar, papa, quebec, romeo, sierra, tango, uniform, victor, whiskey, x-ray, yankee, zulu, underscore, zero, one, two, tree, four, five, six, seven, eight, niner\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"However, even we have the full alphabet, it is still hard for a human to match up one to another. We had to resort to comparing the flag against the alphabet using data.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Both \",(0,e.jsx)(n.em,{children:\"symphony\"}),\" and \",(0,e.jsx)(n.em,{children:\"warmup\"}),\" are pretty well divided between words. We can easilly break down the sheet into words when two clusters are over 5 \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Bar_(music)\",children:\"bars\"}),\" apart. Once we have the set of clusters in both sheets, we can compare the ones from \",(0,e.jsx)(n.em,{children:\"symphony\"}),\" against each cluster in \",(0,e.jsx)(n.em,{children:\"warmup\"}),\" and look for the most similar one note-by-note. The algorithm comparing them is rather simple:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"difference\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token triple-quoted-string string\",children:'\"\"\"a claster is a list of notes, each note is a list of pitches played.\"\"\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    matched \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"range\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        total \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"max\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        matched \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"set\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"set\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cluster2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" matched \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),` total\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Using this simple metric, we finally managed to find all the words in the flag.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now, let\\u2019s listen to \",(0,e.jsx)(n.em,{children:\"symphony\"}),\" again with the correct words.\"]}),`\n`,(0,e.jsxs)(\"figure\",{children:[(0,e.jsx)(\"audio\",{style:{width:\"100%\"},src:\"/static/images/ugra-ctf-quals-2022/symphony/symphony.ogg\",controls:!0}),(0,e.jsx)(\"figcaption\",{children:\"symphony.ogg (860 KB)\"})]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"uniform, golf, romeo, alfa, underscore, whiskey, alfa, victor, yankee, underscore, oscar, bravo, november, oscar, x-ray, india, oscar, uniform, sierra, underscore, sierra, quebec, uniform, india, romeo, romeo, echo, lima, sierra, underscore, foxtrot, four, zero, delta, delta, one, foxtrot, alfa,\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Can you hear it now? Congrats!\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Flag: \",(0,e.jsx)(n.code,{children:\"ugra_wavy_obnoxious_squirrels_f40dd1fa\"})]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Fun fact: Project SEKAI is the only team in the contest that solved this challenge.\"}),`\n`]}),`\n`,(0,e.jsxs)(n.section,{\"data-footnotes\":!0,className:\"footnotes\",children:[(0,e.jsxs)(n.h2,{id:\"footnote-label\",className:\"sr-only\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#footnote-label\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Footnotes\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{id:\"user-content-fn-1\",children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Can you figure out what\\u2019s said in this piece of audio clip? 4.2 seconds, 0 ~ 5 kHz. \",(0,e.jsx)(n.a,{href:\"#user-content-fnref-1\",\"data-footnote-backref\":!0,className:\"data-footnote-backref\",\"aria-label\":\"Back to content\",children:\"\\u21A9\\uFE0E\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{id:\"user-content-fn-2\",children:[`\n`,(0,e.jsxs)(n.p,{children:[\"this was pronunced as something like /\\u02C8h\\u014Dt\\u014D/ instead of /h\\u014D\\u02C8tel/. \",(0,e.jsx)(n.a,{href:\"#user-content-fnref-2\",\"data-footnote-backref\":!0,className:\"data-footnote-backref\",\"aria-label\":\"Back to content\",children:\"\\u21A9\\uFE0E\"})]}),`\n`]}),`\n`]}),`\n`]})]})}}var N=y;return b;})();\n;return Component;","toc":[{"value":"Играет как умеет (Plays the best he can, symphony, 350)","url":"#играет-как-умеет-plays-the-best-he-can-symphony-350","depth":2}],"frontMatter":{"readingTime":{"text":"8 min read","minutes":7.39,"time":443400,"words":1478},"slug":"ugra-ctf-quals-2022/symphony","fileName":"ugra-ctf-quals-2022/symphony.md","title":"Ugra CTF Quals 2022 – Играет как умеет","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","PDF","Music","Audio Processing","Talking Piano"],"summary":"Talking piano illusion only works if you know the words, but what if you only sort of know them?"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon\u0026s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null},{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["sahuang"],"fileName":"sahuang.md","name":"sahuang","avatar":"https://www.gravatar.com/avatar/740255f8ddc8f903d3addafb219ea077?d=identicon\u0026s=256","specialties":["Crypto","Reverse"],"github":"https://github.com/sahuang","linkedin":"https://www.linkedin.com/in/xiaohai-xu-1a8884138/","member":true,"order":0,"description":"Rhythm Gamer. Also the team founder.","date":null}],"prev":{"title":"MOCSCTF 2022 – full of orange","date":"2022-02-28T00:00:00.000Z","draft":false,"authors":["Johnathan"],"tags":["MOCSCTF 2022","pwn","heap","Shell","overflow","Binary Exploit"],"summary":"Heap overflow for shell.","canonical":"https://github.com/nhtri2003gmail/writeup-mocsctf2022.mocsctf.com-orange","slug":"mocsctf-2022/full-of-orange"},"next":{"title":"Ugra CTF Quals 2022 – Разборчивая змейка","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","Snake","QR Code"],"summary":"Picky snake, but the one being picky is actually not the snake.","slug":"ugra-ctf-quals-2022/snekpeek"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["ugra-ctf-quals-2022","symphony"]},"buildId":"zs4rZRwOZcgSj8qsc8Zvy","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>