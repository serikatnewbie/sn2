<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png?v=2"/><link rel="manifest" href="/static/favicons/site.webmanifest?v=2"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg?v=2" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Ugra CTF Quals 2022 – cmap</title><meta name="robots" content="follow, index"/><meta name="description" content="CMap is CMap, but not all “CMap”s are CMap."/><meta property="og:url" content="https://sekai.team/blog/ugra-ctf-quals-2022/cmap/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Project SEKAI"/><meta property="og:description" content="CMap is CMap, but not all “CMap”s are CMap."/><meta property="og:title" content="Ugra CTF Quals 2022 – cmap"/><meta property="og:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=Ugra+CTF+Quals+2022+%E2%80%93+cmap&amp;desc=CMap+is+CMap%2C+but+not+all+%E2%80%9CCMap%E2%80%9Ds+are+CMap.&amp;authors=Eana"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/ProjectSEKAIctf"/><meta name="twitter:title" content="Ugra CTF Quals 2022 – cmap"/><meta name="twitter:description" content="CMap is CMap, but not all “CMap”s are CMap."/><meta name="twitter:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=Ugra+CTF+Quals+2022+%E2%80%93+cmap&amp;desc=CMap+is+CMap%2C+but+not+all+%E2%80%9CCMap%E2%80%9Ds+are+CMap.&amp;authors=Eana"/><meta property="article:published_time" content="2022-03-01T00:00:00.000Z"/><link rel="canonical" href="https://sekai.team/blog/ugra-ctf-quals-2022/cmap/"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sekai.team/blog/ugra-ctf-quals-2022/cmap"
  },
  "headline": "Ugra CTF Quals 2022 – cmap",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://og-vercel-ruby.vercel.app/api/sekai?title=Ugra+CTF+Quals+2022+%E2%80%93+cmap&desc=CMap+is+CMap%2C+but+not+all+%E2%80%9CCMap%E2%80%9Ds+are+CMap.&authors=Eana"
    }
  ],
  "datePublished": "2022-03-01T00:00:00.000Z",
  "dateModified": "2022-03-01T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Eana"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Project SEKAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sekai.team/static/images/fullLogo.svg"
    }
  },
  "description": "CMap is CMap, but not all “CMap”s are CMap."
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/206f24680f6266ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/206f24680f6266ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-09a75c9ee2bd415e.js" defer=""></script><script src="/_next/static/chunks/main-b8c3e234d7065a2c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8cbc7cb85baf88e.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/29107295-a2d0c8e72019a3ed.js" defer=""></script><script src="/_next/static/chunks/545-f1dc6b53ce85b08b.js" defer=""></script><script src="/_next/static/chunks/930-1296a6163e1e3cc6.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-9a47024c9df525b8.js" defer=""></script><script src="/_next/static/0wxHpwy3ehtFejYPlY-Z7/_buildManifest.js" defer=""></script><script src="/_next/static/0wxHpwy3ehtFejYPlY-Z7/_ssgManifest.js" defer=""></script><script src="/_next/static/0wxHpwy3ehtFejYPlY-Z7/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Visit home page" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 468.7 215.63" height="80" width="auto"><defs><linearGradient id="fullLogo_svg__linear-gradient" x1="-7051.74" y1="5608.42" x2="-7051.74" y2="5392.1" gradientTransform="matrix(1 0 .15 -.99 6503.98 5547.9)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00e5ea"></stop><stop offset="1" stop-color="#00b5cc"></stop></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-2" x1="1498.32" y1="4428.84" x2="1497.92" y2="4311.82" gradientTransform="matrix(1 0 0 -1 -1107.01 4435.41)" xlink:href="#fullLogo_svg__linear-gradient"></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-3" x1="320.76" y1="14.17" x2="320.76" y2="47.97" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0069a5"></stop><stop offset="1" stop-color="#003d6b"></stop></linearGradient><style>.fullLogo_svg__cls-1{fill:#fff}</style></defs><g id="fullLogo_svg__Project_SEKAI_Wide_White" data-name="Project SEKAI Wide White"><path class="fullLogo_svg__cls-1" d="M107 117.14v-4c11.93 0 22.15-8.62 23.76-20l12.91-91.63h4.06l-13 92.14c-1.92 13.4-13.84 23.49-27.73 23.49Z"></path><path class="fullLogo_svg__cls-1" d="M97.43 98.3a16 16 0 0 1-16.26-18.72l8.68-61.42A21.78 21.78 0 0 1 110.77 0a16.34 16.34 0 0 1 12.57 5.5A16.36 16.36 0 0 1 127 18.72l-8.69 61.42c-1.39 10.01-10.77 18.16-20.88 18.16ZM110.77 4a17.63 17.63 0 0 0-17 14.72l-8.64 61.42a12 12 0 0 0 12.3 14.16 17.65 17.65 0 0 0 16.95-14.72l8.69-61.42a12.41 12.41 0 0 0-2.75-10A12.4 12.4 0 0 0 110.77 4ZM186.94 5.42l.56-3.91H162.99l-13.5 95.44H174l.57-4h-20.46l5.85-41.36h20.46l.56-4h-20.45l5.96-42.17h20.45zM266.73 1.51h-31.01l-.55 3.91h14.2l-12.95 91.53h4.06l12.93-91.53h12.77l.55-3.91zM212.61 1.51a15.86 15.86 0 0 0-15.24 13.24l-9.86 69.48a11.69 11.69 0 0 0 2.76 9.34 12.57 12.57 0 0 0 9.18 4.43h.2c6.38 0 11.65-5.57 15.15-9.28L211.9 86c-3.06 3.23-7.67 8.11-12.38 8a8.54 8.54 0 0 1-6.21-3 7.73 7.73 0 0 1-1.84-6.18l9.86-69.48a11.83 11.83 0 0 1 11.28-9.9h13.91l.55-3.91ZM37.08 5.58a12 12 0 0 0-9.26-4.06H13.5L0 97h4.06l6.41-45.37h10.84a15.87 15.87 0 0 0 15.24-13.29l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.26 23a11.74 11.74 0 0 1-11.27 9.8H11l6-42.13h10.85a7.94 7.94 0 0 1 8 9.33ZM75.09 5.58a12 12 0 0 0-9.26-4.06h-14.3L38 97h4l6.5-45.42h10L65 96.2h4l-6.6-45a16 16 0 0 0 12.16-12.86l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.25 23a11.76 11.76 0 0 1-11.28 9.8H49.07L55 5.42h10.86a7.94 7.94 0 0 1 8 9.33ZM223.75 215.47h-4.06l13.5-95.43h4.05l-13.49 95.43zM65.83 215.63a14.49 14.49 0 0 1-11-4.65 11.3 11.3 0 0 1-2.68-9.15l1.31-8.59 4.4-2.34-1.76 11.52a7.24 7.24 0 0 0 1.75 5.93 10.47 10.47 0 0 0 8 3.28c6.42 0 12.26-4.39 13-9.8l5.42-38.33-28.77 15.27 6.37-46c1-7.3 8.65-13.24 17-13.24a14.52 14.52 0 0 1 11 4.65 11.36 11.36 0 0 1 2.68 9.14l-1.2 8.68-4.35 2.34 1.64-11.6a7.29 7.29 0 0 0-1.74-6 10.5 10.5 0 0 0-8-3.28c-6.42 0-12.26 4.39-13 9.79l-5.29 38.27 28.8-15.28-6.52 46.1c-1.11 7.35-8.73 13.29-17.06 13.29ZM174.15 120.04h-4.51l-26.9 51.72 7.31-51.72H146l-13.5 95.43h4.05l4.5-31.8 10.61-20.4 12.61 52.2h4.11l-13.91-57.6 19.68-37.83zM205 215.47h4l-2.29-94.87v-.56h-4l-29.31 95.43h4.18l9.82-32h16.83Zm-16.37-36L203 132.68l1.13 46.81ZM132.58 123.94l.56-3.91h-24.52l-13.49 95.44h24.51l.56-4H99.75l5.85-41.36h20.45l.57-4h-20.46l5.97-42.17h20.45z"></path><path style="fill:url(#fullLogo_svg__linear-gradient)" d="M279.69 1.51h8.87l-32.09 213.93h-8.87L279.69 1.51z"></path><path d="M393.81 14.88C396 .34 331.4 1.5 296.53 1.5L283.6 87.67c33.36-1.94 99.5-2 97.21 13.27-1.14 7.58-5.53 7.29-6.1 11.08-1.52 10.14 70.94 5.62 81.15 4.52L434 73.6l34.7-43.29c-17.47 1.81-82.47 4.94-81.11-4.15.73-4.87 5.41-5.56 6.22-11.28Z" style="fill:url(#fullLogo_svg__linear-gradient-2)"></path><path d="m324.34 13-5.8 25.24A9.73 9.73 0 0 0 312 36c-4.66 0-8.43 2.82-8.42 6.27s3.8 6.24 8.46 6.22c4 0 7.4-2.12 8.23-4.92 0-.14.06-.28.09-.42l3.48-15.5q9.18 2.06 9.72 5.26a9 9 0 0 1-1.27 6.22 10.78 10.78 0 0 0 5.7-8.81q.48-5.88-13.65-17.32Z" style="fill:url(#fullLogo_svg__linear-gradient-3)"></path></g></svg></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/members/">Members</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/contests/">Contests</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags/">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">CTF 2023</a></div><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/members/">Members</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/contests/">Contests</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">CTF 2023</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-03-01T00:00:00.000Z">Tuesday, 1 March 2022</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Ugra CTF Quals 2022 – cmap</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Eana</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/blueset" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@blueset</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><h2 id="cmap-i-ppc-150--cmap-ii-forensics-300"><a href="#cmap-i-ppc-150--cmap-ii-forensics-300" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>cmap I (PPC, 150) / cmap II (Forensics, 300)</h2>
<blockquote>
<p>На объекте X, даже одно название которого совершенно секретно, введены чрезвычайные меры информационной безопасности — все компьютеры отключили от сети. Теперь сотрудники Х передают данные только на бумажных носителях — с визой руководителя отдела.</p>
<p>Однако, быстро выяснилось, что передавать сверхточные чертежи таким образом без потерь не получится. Поэтому в стенах Х был разработан алгоритм потоковой отправки данных с использованием лазерной печати без потерь. Алгоритм настолько эффективен, что позволяет передавать даже цветные изображения с использованием лишь чёрно-белого принтера.</p>
<p>Нам всё же удалось достать один из секретных файлов. Только почему-то ничего не копируется. Помогите разобраться :(</p>
<p>Примечание. В этом задании два флага.</p>
<p>Примечание 2 (добавлено 28 февраля в 17:32). не все программы для просмотра PDF показывают содержимое файла корректно. Вы должны увидеть много букв на каждой странице. Если вы их не видите — например, в Chromium, попробуйте другую программу.</p>
<hr/>
<p>At facility X, even one name of which is top secret, emergency information security measures have been introduced - all computers have been disconnected from the network. Now employees of X transmit data only on paper - with the visa of the head of the department.</p>
<p>However, it quickly became clear that it would not be possible to transfer ultra-precise drawings in this way without loss. Therefore, within the walls of X, a data streaming algorithm was developed using lossless laser printing. The algorithm is so efficient that it can even transfer color images using only a black and white printer.</p>
<p>We still managed to get one of the secret files. For some reason, nothing is copied. Help me to understand :(</p>
<p>Note. There are two flags in this task.</p>
<p>Note 2 (added Feb 28 at 5:32 pm). Not all PDF viewers show the contents of a file correctly. You should see many letters on every page. If you do not see them - for example, in Chromium, try another program.</p>
<p>(Google Translate)</p>
</blockquote>
<blockquote>
<p>Нам стало известно, что алгоритм защищён от утечек — все файлы промаркированы, и, если хоть что-то попадёт в сеть, информатора быстро найдут. Узнайте, как работает эта защита.</p>
<hr/>
<p>It became known to us that the algorithm is protected from leaks - all files are marked, and if at least something gets into the network, the informant will be quickly found. Find out how this protection works.</p>
<p>(Google Translate)</p>
</blockquote>
<blockquote>
<p>Attachment: <code>cmap.pdf</code></p>
</blockquote>
<p>See also: Official write-up (Russian) of <a target="_blank" rel="noopener noreferrer" href="https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/cmap/WRITEUP.cmap1.md">cmap I</a> and <a target="_blank" rel="noopener noreferrer" href="https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/cmap/WRITEUP.cmap2.md">cmap II</a>.</p>
<p>First, when I see the problem with a PDF attachment, and the name suggesting CMap, it immediately reminds me of an article I wrote a while ago.</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://blog.1a23.com/2017/08/29/obfuscate-pdf-text-uncopiable-text-with-crafted-cmap/">Obfuscate PDF Text: Scramble Copied Text with Crafted CMap – 1A23 Blog</a></p>
<p>Basically, <a target="_blank" rel="noopener noreferrer" href="https://docs.microsoft.com/en-us/typography/opentype/spec/cmap">CMap</a> is a table of character codes and their corresponding glyph indices. It is a crutial component of OpenType standard, and being included in PDF embedded fonts for text interpretation.</p>
<p>Opening this PDF in Firefox, we can see a long chunk of ugly <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Letter_spacing">tracked</a> <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Round_hand">round hand</a> upper case letters.</p>
<p><img src="/static/images/ugra-ctf-quals-2022/cmap/example.png" alt="An extract of the PDF document"/></p>
<p>Inspecting this document with Adobe Acrobat Reader, the typeface used is a variant of <a target="_blank" rel="noopener noreferrer" href="https://fontsisland.com/font/monplesir-script">Monplesir Script</a>, a free <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Script_typeface">script typeface</a> designed for Russian Cyrillic script.</p>
<p>However, copying these texts would give something more absurd.</p>
<div class="relative"><pre><code class="language-sh code-highlight"><span class="code-line">$ pbpaste | python3 -c &quot;print(*(hex(ord(i))[2:].rjust(4, &#x27;0&#x27;) for i in input()))&quot;
</span><span class="code-line">1562 04e6 fb0a 1d27 145c 1562 1347 2f8a 0b0d fb0a 2f8a d0c6 0782 d0c6 d0c6 d0c6 d0c6 d0c6 190e 0782 0a74 0a74 fbcc 1d27 b9c2
</span></code></pre></div>
<p>Open the PDF in a text editor, we can find a section of text like this:</p>
<div class="relative"><pre><code class="language-pdf code-highlight"><span class="code-line">64 0 obj
</span><span class="code-line">&lt;&lt;/BaseEncoding /WinAnsiEncoding /Differences 66 0 R&gt;&gt;
</span><span class="code-line">endobj
</span><span class="code-line">
</span><span class="code-line">66 0 obj
</span><span class="code-line">[0 /uni010E 1 /uni0259 2 /uni040A 3 /uni04E6 4 /uni0581 5 /uni0782 6 /uni0785 7 /uni078B 8 /uni07B2 9 /uni07B8 10 /uni0909 11 /uni0A01 12 /uni0A22 13 /uni0A74 14 /uni0B0D 15 /uni122F 16 /uni1347 17 /uni145C 18 /uni154D 19 /uni1562 20 /uni1718 21 /uni1719 22 /uni190E 23 /uni191D 24 /uni1969 25 /uni196F 26 /uni19EC 27 /uni19ED 28 /uni19F2 29 /uni1D27 30 /uni1D32 31 /uni1D38 32 /uni1D6A 33 /uni1D7D 34 /uni213C 35 /uni2177 36 /uni23E8 37 /uni2B44 38 /uni2ED6 39 /uni2EFD 40 /uni2F8A 41 /uni3016 42 /uni303A 43 /uni30F8 44 /uni3101 45 /uni315E 46 /uni3BA7 47 /uni541F 48 /uni966C 49 /uni9982 50 /uniB9C2 51 /uniCD3B 52 /uniD0C6 53 /uniD188 54 /uniD1C3 55 /uniF960 56 /uniFB0A 57 /uniFB59 58 /uniFB9A 59 /uniFBBA 60 /uniFBCC 61 /uniFD5E 62 /uniFF18 63 /uniFF49]
</span><span class="code-line">endobj
</span></code></pre></div>
<p>Even if you know nothing about the PDF standard, it is quite obvious that this is a mapping of glyph indices to character codes, and everything here matches what we copied from the PDF. We now just need to find the real characters drawn in each glyph.</p>
<blockquote>
<p><strong>Sidenote</strong>:<br/>
<!-- -->This table above is actually a Font Encoding table instead of a CMap table<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>. In the official writeup, the author claimed that “cmap” refers to <a target="_blank" rel="noopener noreferrer" href="https://www.ctan.org/tex-archive/macros/latex/contrib/cmap">a <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LaTeX</mtext></mrow><annotation encoding="application/x-tex">\LaTeX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8988em;vertical-align:-0.2155em"></span><span class="mord text"><span class="mord textrm">L</span><span class="mspace" style="margin-right:-0.36em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6833em"><span style="top:-2.905em"><span class="pstrut" style="height:2.7em"></span><span class="mord"><span class="mord textrm mtight sizing reset-size6 size3">A</span></span></span></span></span></span><span class="mspace" style="margin-right:-0.15em"></span><span class="mord text"><span class="mord textrm">T</span><span class="mspace" style="margin-right:-0.1667em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4678em"><span style="top:-2.7845em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord textrm">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2155em"><span></span></span></span></span><span class="mspace" style="margin-right:-0.125em"></span><span class="mord textrm">X</span></span></span></span></span></span></span> package</a>, instead of the actual CMap table.</p>
</blockquote>
<p>To find out more of the embedded font in the PDF, we can use <a target="_blank" rel="noopener noreferrer" href="https://fontforge.org/en-US/">FontForge</a>, an open source font editor that can import PDF files and extract fonts from them.</p>
<p>Open the PDF in FontForge, then choose “Encoding” → “Compact” to hide all the non defined glyphs. We can see all the actual 64 glyphs shown in the defined order.</p>
<p><img src="/static/images/ugra-ctf-quals-2022/cmap/fontforge.png" alt="The font extracted from the PDF with FontForge"/></p>
<p>What we need to do now is to type out all the actual letters, and match them up with the code points we found in the encoding table. Then we can decode all the content in the PDF. In case you find any of the designs confusing, the <a target="_blank" rel="noopener noreferrer" href="https://fontsisland.com/font/monplesir-script">original typeface</a> is always there as a reference.</p>
<p>Interestingly, even a total of 64 glyphs are found in the embed font, the actual document is only using 37 of them, making it a Base36 instead of Base64. Decode the Base36 data, and save it as a PNG file, we can then find the first flag drawn on it.</p>
<p><img src="/static/images/ugra-ctf-quals-2022/cmap/cmap1.png" alt="Flag found from the decoded PNG image"/></p>
<p>Go back to FontForge and scroll down a bit more. Surprisingly there’s yet another flag.</p>
<p><img src="/static/images/ugra-ctf-quals-2022/cmap/cmap2.png" alt="Second half of the font extracted from the PDF with FontForge"/></p>
<p>Killing two birds with one stone. Not bad, huh?</p>
<section data-footnotes="true" class="footnotes"><h2 id="footnote-label" class="sr-only"><a href="#footnote-label" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Footnotes</h2>
<ol>
<li id="user-content-fn-1">
<p>Whitington, J. (2012). Text and Fonts. In <em>PDF explained: The ISO standarad for document exchange</em>. essay, O&#x27;Reilly. <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩︎</a></p>
</li>
</ol>
</section></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fsekai.team%2Fblog%2Fugra-ctf-quals-2022%2Fcmap">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/blueset/sekai.team/blob/master/data/blog/ugra-ctf-quals-2022/cmap.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ugra-ctf-quals-2022/">Ugra-CTF-Quals-2022</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/misc/">Misc</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/forensics/">Forensics</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/pdf/">PDF</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/cmap/">CMAP</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/font/">Font</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/encoding/">Encoding</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ugra-ctf-quals-2022/snekpeek/">Ugra CTF Quals 2022 – Разборчивая змейка</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ugra-ctf-quals-2022/noteasy03/">Ugra CTF Quals 2022 – noteasy03</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:project.sekai@sekai.team"><span class="sr-only"><span class="w-6">mail</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/project-sekai-ctf"><span class="sr-only"><span class="w-6">github</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/project-sekai-ctf/"><span class="sr-only"><span class="w-6">linkedin</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ProjectSEKAIctf"><span class="sr-only"><span class="w-6">twitter</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/169557"><span class="sr-only"><span class="w-6">ctftime</span></span><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M24 0v24H0V0h24Zm-3.077 3.077L7.067 3.076 16 12.816 10.369 19l-2.195-2.612 3.476-3.573-8.574-9.609v17.717h17.847V3.077Z" fill="currentColor" fill-rule="evenodd"></path></svg></a></div></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><a href="/">Project SEKAI</a><div> • </div><div>© 2024</div><div> • </div><div><a href="https://1a23.com">1A23 Studio</a></div></div><div class="mb-8 text-xs text-center text-gray-200 dark:text-gray-700">This website is in no way affiliated with any of the following individuals or organizations.<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a> © Timothy Lim and contributors; <a target="_blank" rel="noopener noreferrer" href="https://pjsekai.sega.jp/">Project SEKAI: Colorful Stage! feat. Hatsune Miku</a> © SEGA / © Craft Egg Inc. Developed by Colorful Palette; <a target="_blank" rel="noopener noreferrer" href="https://ec.crypton.co.jp/pages/prod/virtualsinger">Character Vocal Series</a> © Crypton Future Media, INC. <a target="_blank" rel="noopener noreferrer" href="https://www.piapro.net">www.piapro.net</a> All rights reserved.</div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var l=Object.create;var s=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var r=t=\u003es(t,\"__esModule\",{value:!0});var u=(t,a)=\u003e()=\u003e(a||t((a={exports:{}}).exports,a),a.exports),f=(t,a)=\u003e{r(t);for(var i in a)s(t,i,{get:a[i],enumerable:!0})},g=(t,a,i)=\u003e{if(a\u0026\u0026typeof a==\"object\"||typeof a==\"function\")for(let n of d(a))!m.call(t,n)\u0026\u0026n!==\"default\"\u0026\u0026s(t,n,{get:()=\u003ea[n],enumerable:!(i=h(a,n))||i.enumerable});return t},b=t=\u003eg(r(s(t!=null?l(p(t)):{},\"default\",t\u0026\u0026t.__esModule\u0026\u0026\"default\"in t?{get:()=\u003et.default,enumerable:!0}:{value:t,enumerable:!0})),t);var o=u((k,c)=\u003e{c.exports=_jsx_runtime});var N={};f(N,{default:()=\u003eF,frontmatter:()=\u003ew});var e=b(o()),w={title:\"Ugra CTF Quals 2022 \\u2013 cmap\",date:\"2022-03-01\",draft:!1,authors:[\"blueset\"],tags:[\"Ugra CTF Quals 2022\",\"Misc\",\"Forensics\",\"PDF\",\"CMAP\",\"Font\",\"Encoding\"],summary:\"CMap is CMap, but not all \\u201CCMap\\u201Ds are CMap.\"};function y(t={}){let{wrapper:a}=t.components||{};return a?(0,e.jsx)(a,Object.assign({},t,{children:(0,e.jsx)(i,{})})):i();function i(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",hr:\"hr\",code:\"code\",img:\"img\",pre:\"pre\",strong:\"strong\",br:\"br\",sup:\"sup\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mtext:\"mtext\",annotation:\"annotation\",section:\"section\",ol:\"ol\",li:\"li\",em:\"em\"},t.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"cmap-i-ppc-150--cmap-ii-forensics-300\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#cmap-i-ppc-150--cmap-ii-forensics-300\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"cmap I (PPC, 150) / cmap II (Forensics, 300)\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u041D\\u0430 \\u043E\\u0431\\u044A\\u0435\\u043A\\u0442\\u0435 X, \\u0434\\u0430\\u0436\\u0435 \\u043E\\u0434\\u043D\\u043E \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u043E\\u0442\\u043E\\u0440\\u043E\\u0433\\u043E \\u0441\\u043E\\u0432\\u0435\\u0440\\u0448\\u0435\\u043D\\u043D\\u043E \\u0441\\u0435\\u043A\\u0440\\u0435\\u0442\\u043D\\u043E, \\u0432\\u0432\\u0435\\u0434\\u0435\\u043D\\u044B \\u0447\\u0440\\u0435\\u0437\\u0432\\u044B\\u0447\\u0430\\u0439\\u043D\\u044B\\u0435 \\u043C\\u0435\\u0440\\u044B \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u043E\\u043D\\u043D\\u043E\\u0439 \\u0431\\u0435\\u0437\\u043E\\u043F\\u0430\\u0441\\u043D\\u043E\\u0441\\u0442\\u0438 \\u2014 \\u0432\\u0441\\u0435 \\u043A\\u043E\\u043C\\u043F\\u044C\\u044E\\u0442\\u0435\\u0440\\u044B \\u043E\\u0442\\u043A\\u043B\\u044E\\u0447\\u0438\\u043B\\u0438 \\u043E\\u0442 \\u0441\\u0435\\u0442\\u0438. \\u0422\\u0435\\u043F\\u0435\\u0440\\u044C \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0438 \\u0425 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u044E\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u043D\\u0430 \\u0431\\u0443\\u043C\\u0430\\u0436\\u043D\\u044B\\u0445 \\u043D\\u043E\\u0441\\u0438\\u0442\\u0435\\u043B\\u044F\\u0445 \\u2014 \\u0441 \\u0432\\u0438\\u0437\\u043E\\u0439 \\u0440\\u0443\\u043A\\u043E\\u0432\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u044F \\u043E\\u0442\\u0434\\u0435\\u043B\\u0430.\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u041E\\u0434\\u043D\\u0430\\u043A\\u043E, \\u0431\\u044B\\u0441\\u0442\\u0440\\u043E \\u0432\\u044B\\u044F\\u0441\\u043D\\u0438\\u043B\\u043E\\u0441\\u044C, \\u0447\\u0442\\u043E \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u0432\\u0430\\u0442\\u044C \\u0441\\u0432\\u0435\\u0440\\u0445\\u0442\\u043E\\u0447\\u043D\\u044B\\u0435 \\u0447\\u0435\\u0440\\u0442\\u0435\\u0436\\u0438 \\u0442\\u0430\\u043A\\u0438\\u043C \\u043E\\u0431\\u0440\\u0430\\u0437\\u043E\\u043C \\u0431\\u0435\\u0437 \\u043F\\u043E\\u0442\\u0435\\u0440\\u044C \\u043D\\u0435 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u0441\\u044F. \\u041F\\u043E\\u044D\\u0442\\u043E\\u043C\\u0443 \\u0432 \\u0441\\u0442\\u0435\\u043D\\u0430\\u0445 \\u0425 \\u0431\\u044B\\u043B \\u0440\\u0430\\u0437\\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u043D \\u0430\\u043B\\u0433\\u043E\\u0440\\u0438\\u0442\\u043C \\u043F\\u043E\\u0442\\u043E\\u043A\\u043E\\u0432\\u043E\\u0439 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0441 \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\\u043C \\u043B\\u0430\\u0437\\u0435\\u0440\\u043D\\u043E\\u0439 \\u043F\\u0435\\u0447\\u0430\\u0442\\u0438 \\u0431\\u0435\\u0437 \\u043F\\u043E\\u0442\\u0435\\u0440\\u044C. \\u0410\\u043B\\u0433\\u043E\\u0440\\u0438\\u0442\\u043C \\u043D\\u0430\\u0441\\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u044D\\u0444\\u0444\\u0435\\u043A\\u0442\\u0438\\u0432\\u0435\\u043D, \\u0447\\u0442\\u043E \\u043F\\u043E\\u0437\\u0432\\u043E\\u043B\\u044F\\u0435\\u0442 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u0432\\u0430\\u0442\\u044C \\u0434\\u0430\\u0436\\u0435 \\u0446\\u0432\\u0435\\u0442\\u043D\\u044B\\u0435 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F \\u0441 \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\\u043C \\u043B\\u0438\\u0448\\u044C \\u0447\\u0451\\u0440\\u043D\\u043E-\\u0431\\u0435\\u043B\\u043E\\u0433\\u043E \\u043F\\u0440\\u0438\\u043D\\u0442\\u0435\\u0440\\u0430.\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u041D\\u0430\\u043C \\u0432\\u0441\\u0451 \\u0436\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0434\\u043E\\u0441\\u0442\\u0430\\u0442\\u044C \\u043E\\u0434\\u0438\\u043D \\u0438\\u0437 \\u0441\\u0435\\u043A\\u0440\\u0435\\u0442\\u043D\\u044B\\u0445 \\u0444\\u0430\\u0439\\u043B\\u043E\\u0432. \\u0422\\u043E\\u043B\\u044C\\u043A\\u043E \\u043F\\u043E\\u0447\\u0435\\u043C\\u0443-\\u0442\\u043E \\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043A\\u043E\\u043F\\u0438\\u0440\\u0443\\u0435\\u0442\\u0441\\u044F. \\u041F\\u043E\\u043C\\u043E\\u0433\\u0438\\u0442\\u0435 \\u0440\\u0430\\u0437\\u043E\\u0431\\u0440\\u0430\\u0442\\u044C\\u0441\\u044F :(\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u041F\\u0440\\u0438\\u043C\\u0435\\u0447\\u0430\\u043D\\u0438\\u0435. \\u0412 \\u044D\\u0442\\u043E\\u043C \\u0437\\u0430\\u0434\\u0430\\u043D\\u0438\\u0438 \\u0434\\u0432\\u0430 \\u0444\\u043B\\u0430\\u0433\\u0430.\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u041F\\u0440\\u0438\\u043C\\u0435\\u0447\\u0430\\u043D\\u0438\\u0435 2 (\\u0434\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u043E 28 \\u0444\\u0435\\u0432\\u0440\\u0430\\u043B\\u044F \\u0432 17:32). \\u043D\\u0435 \\u0432\\u0441\\u0435 \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u044B \\u0434\\u043B\\u044F \\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0430 PDF \\u043F\\u043E\\u043A\\u0430\\u0437\\u044B\\u0432\\u0430\\u044E\\u0442 \\u0441\\u043E\\u0434\\u0435\\u0440\\u0436\\u0438\\u043C\\u043E\\u0435 \\u0444\\u0430\\u0439\\u043B\\u0430 \\u043A\\u043E\\u0440\\u0440\\u0435\\u043A\\u0442\\u043D\\u043E. \\u0412\\u044B \\u0434\\u043E\\u043B\\u0436\\u043D\\u044B \\u0443\\u0432\\u0438\\u0434\\u0435\\u0442\\u044C \\u043C\\u043D\\u043E\\u0433\\u043E \\u0431\\u0443\\u043A\\u0432 \\u043D\\u0430 \\u043A\\u0430\\u0436\\u0434\\u043E\\u0439 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0435. \\u0415\\u0441\\u043B\\u0438 \\u0432\\u044B \\u0438\\u0445 \\u043D\\u0435 \\u0432\\u0438\\u0434\\u0438\\u0442\\u0435 \\u2014 \\u043D\\u0430\\u043F\\u0440\\u0438\\u043C\\u0435\\u0440, \\u0432 Chromium, \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0434\\u0440\\u0443\\u0433\\u0443\\u044E \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0443.\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.p,{children:\"At facility X, even one name of which is top secret, emergency information security measures have been introduced - all computers have been disconnected from the network. Now employees of X transmit data only on paper - with the visa of the head of the department.\"}),`\n`,(0,e.jsx)(n.p,{children:\"However, it quickly became clear that it would not be possible to transfer ultra-precise drawings in this way without loss. Therefore, within the walls of X, a data streaming algorithm was developed using lossless laser printing. The algorithm is so efficient that it can even transfer color images using only a black and white printer.\"}),`\n`,(0,e.jsx)(n.p,{children:\"We still managed to get one of the secret files. For some reason, nothing is copied. Help me to understand :(\"}),`\n`,(0,e.jsx)(n.p,{children:\"Note. There are two flags in this task.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Note 2 (added Feb 28 at 5:32 pm). Not all PDF viewers show the contents of a file correctly. You should see many letters on every page. If you do not see them - for example, in Chromium, try another program.\"}),`\n`,(0,e.jsx)(n.p,{children:\"(Google Translate)\"}),`\n`]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"\\u041D\\u0430\\u043C \\u0441\\u0442\\u0430\\u043B\\u043E \\u0438\\u0437\\u0432\\u0435\\u0441\\u0442\\u043D\\u043E, \\u0447\\u0442\\u043E \\u0430\\u043B\\u0433\\u043E\\u0440\\u0438\\u0442\\u043C \\u0437\\u0430\\u0449\\u0438\\u0449\\u0451\\u043D \\u043E\\u0442 \\u0443\\u0442\\u0435\\u0447\\u0435\\u043A \\u2014 \\u0432\\u0441\\u0435 \\u0444\\u0430\\u0439\\u043B\\u044B \\u043F\\u0440\\u043E\\u043C\\u0430\\u0440\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u044B, \\u0438, \\u0435\\u0441\\u043B\\u0438 \\u0445\\u043E\\u0442\\u044C \\u0447\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u043F\\u0430\\u0434\\u0451\\u0442 \\u0432 \\u0441\\u0435\\u0442\\u044C, \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0442\\u043E\\u0440\\u0430 \\u0431\\u044B\\u0441\\u0442\\u0440\\u043E \\u043D\\u0430\\u0439\\u0434\\u0443\\u0442. \\u0423\\u0437\\u043D\\u0430\\u0439\\u0442\\u0435, \\u043A\\u0430\\u043A \\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u0435\\u0442 \\u044D\\u0442\\u0430 \\u0437\\u0430\\u0449\\u0438\\u0442\\u0430.\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.p,{children:\"It became known to us that the algorithm is protected from leaks - all files are marked, and if at least something gets into the network, the informant will be quickly found. Find out how this protection works.\"}),`\n`,(0,e.jsx)(n.p,{children:\"(Google Translate)\"}),`\n`]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Attachment: \",(0,e.jsx)(n.code,{children:\"cmap.pdf\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"See also: Official write-up (Russian) of \",(0,e.jsx)(n.a,{href:\"https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/cmap/WRITEUP.cmap1.md\",children:\"cmap I\"}),\" and \",(0,e.jsx)(n.a,{href:\"https://github.com/teamteamdev/ugractf-2022-quals/blob/master/tasks/cmap/WRITEUP.cmap2.md\",children:\"cmap II\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"First, when I see the problem with a PDF attachment, and the name suggesting CMap, it immediately reminds me of an article I wrote a while ago.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://blog.1a23.com/2017/08/29/obfuscate-pdf-text-uncopiable-text-with-crafted-cmap/\",children:\"Obfuscate PDF Text: Scramble Copied Text with Crafted CMap \\u2013 1A23 Blog\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Basically, \",(0,e.jsx)(n.a,{href:\"https://docs.microsoft.com/en-us/typography/opentype/spec/cmap\",children:\"CMap\"}),\" is a table of character codes and their corresponding glyph indices. It is a crutial component of OpenType standard, and being included in PDF embedded fonts for text interpretation.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Opening this PDF in Firefox, we can see a long chunk of ugly \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Letter_spacing\",children:\"tracked\"}),\" \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Round_hand\",children:\"round hand\"}),\" upper case letters.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/cmap/example.png\",alt:\"An extract of the PDF document\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Inspecting this document with Adobe Acrobat Reader, the typeface used is a variant of \",(0,e.jsx)(n.a,{href:\"https://fontsisland.com/font/monplesir-script\",children:\"Monplesir Script\"}),\", a free \",(0,e.jsx)(n.a,{href:\"https://en.wikipedia.org/wiki/Script_typeface\",children:\"script typeface\"}),\" designed for Russian Cyrillic script.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"However, copying these texts would give something more absurd.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"language-sh code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ pbpaste | python3 -c \"print(*(hex(ord(i))[2:].rjust(4, '0') for i in input()))\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`1562 04e6 fb0a 1d27 145c 1562 1347 2f8a 0b0d fb0a 2f8a d0c6 0782 d0c6 d0c6 d0c6 d0c6 d0c6 190e 0782 0a74 0a74 fbcc 1d27 b9c2\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Open the PDF in a text editor, we can find a section of text like this:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"language-pdf code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`64 0 obj\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\u003c\u003c/BaseEncoding /WinAnsiEncoding /Differences 66 0 R\u003e\u003e\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`endobj\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`66 0 obj\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[0 /uni010E 1 /uni0259 2 /uni040A 3 /uni04E6 4 /uni0581 5 /uni0782 6 /uni0785 7 /uni078B 8 /uni07B2 9 /uni07B8 10 /uni0909 11 /uni0A01 12 /uni0A22 13 /uni0A74 14 /uni0B0D 15 /uni122F 16 /uni1347 17 /uni145C 18 /uni154D 19 /uni1562 20 /uni1718 21 /uni1719 22 /uni190E 23 /uni191D 24 /uni1969 25 /uni196F 26 /uni19EC 27 /uni19ED 28 /uni19F2 29 /uni1D27 30 /uni1D32 31 /uni1D38 32 /uni1D6A 33 /uni1D7D 34 /uni213C 35 /uni2177 36 /uni23E8 37 /uni2B44 38 /uni2ED6 39 /uni2EFD 40 /uni2F8A 41 /uni3016 42 /uni303A 43 /uni30F8 44 /uni3101 45 /uni315E 46 /uni3BA7 47 /uni541F 48 /uni966C 49 /uni9982 50 /uniB9C2 51 /uniCD3B 52 /uniD0C6 53 /uniD188 54 /uniD1C3 55 /uniF960 56 /uniFB0A 57 /uniFB59 58 /uniFB9A 59 /uniFBBA 60 /uniFBCC 61 /uniFD5E 62 /uniFF18 63 /uniFF49]\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`endobj\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Even if you know nothing about the PDF standard, it is quite obvious that this is a mapping of glyph indices to character codes, and everything here matches what we copied from the PDF. We now just need to find the real characters drawn in each glyph.\"}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Sidenote\"}),\":\",(0,e.jsx)(n.br,{}),`\n`,\"This table above is actually a Font Encoding table instead of a CMap table\",(0,e.jsx)(n.sup,{children:(0,e.jsx)(n.a,{href:\"#user-content-fn-1\",id:\"user-content-fnref-1\",\"data-footnote-ref\":!0,\"aria-describedby\":\"footnote-label\",children:\"1\"})}),\". In the official writeup, the author claimed that \\u201Ccmap\\u201D refers to \",(0,e.jsxs)(n.a,{href:\"https://www.ctan.org/tex-archive/macros/latex/contrib/cmap\",children:[\"a \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsx)(n.mrow,{children:(0,e.jsx)(n.mtext,{children:\"LaTeX\"})}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\LaTeX\"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\"0.8988em\",verticalAlign:\"-0.2155em\"}}),(0,e.jsxs)(n.span,{className:\"mord text\",children:[(0,e.jsx)(n.span,{className:\"mord textrm\",children:\"L\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"-0.36em\"}}),(0,e.jsx)(n.span,{className:\"vlist-t\",children:(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.6833em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.905em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsx)(n.span,{className:\"mord textrm mtight sizing reset-size6 size3\",children:\"A\"})})]})})})}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"-0.15em\"}}),(0,e.jsxs)(n.span,{className:\"mord text\",children:[(0,e.jsx)(n.span,{className:\"mord textrm\",children:\"T\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"-0.1667em\"}}),(0,e.jsxs)(n.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(n.span,{className:\"vlist-r\",children:[(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.4678em\"},children:(0,e.jsxs)(n.span,{style:{top:\"-2.7845em\"},children:[(0,e.jsx)(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:(0,e.jsx)(n.span,{className:\"mord textrm\",children:\"E\"})})]})}),(0,e.jsx)(n.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(n.span,{className:\"vlist-r\",children:(0,e.jsx)(n.span,{className:\"vlist\",style:{height:\"0.2155em\"},children:(0,e.jsx)(n.span,{})})})]}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\"-0.125em\"}}),(0,e.jsx)(n.span,{className:\"mord textrm\",children:\"X\"})]})]})]})})]})}),\" package\"]}),\", instead of the actual CMap table.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"To find out more of the embedded font in the PDF, we can use \",(0,e.jsx)(n.a,{href:\"https://fontforge.org/en-US/\",children:\"FontForge\"}),\", an open source font editor that can import PDF files and extract fonts from them.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Open the PDF in FontForge, then choose \\u201CEncoding\\u201D \\u2192 \\u201CCompact\\u201D to hide all the non defined glyphs. We can see all the actual 64 glyphs shown in the defined order.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/cmap/fontforge.png\",alt:\"The font extracted from the PDF with FontForge\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"What we need to do now is to type out all the actual letters, and match them up with the code points we found in the encoding table. Then we can decode all the content in the PDF. In case you find any of the designs confusing, the \",(0,e.jsx)(n.a,{href:\"https://fontsisland.com/font/monplesir-script\",children:\"original typeface\"}),\" is always there as a reference.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Interestingly, even a total of 64 glyphs are found in the embed font, the actual document is only using 37 of them, making it a Base36 instead of Base64. Decode the Base36 data, and save it as a PNG file, we can then find the first flag drawn on it.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/cmap/cmap1.png\",alt:\"Flag found from the decoded PNG image\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Go back to FontForge and scroll down a bit more. Surprisingly there\\u2019s yet another flag.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/ugra-ctf-quals-2022/cmap/cmap2.png\",alt:\"Second half of the font extracted from the PDF with FontForge\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Killing two birds with one stone. Not bad, huh?\"}),`\n`,(0,e.jsxs)(n.section,{\"data-footnotes\":!0,className:\"footnotes\",children:[(0,e.jsxs)(n.h2,{id:\"footnote-label\",className:\"sr-only\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#footnote-label\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Footnotes\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{id:\"user-content-fn-1\",children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Whitington, J. (2012). Text and Fonts. In \",(0,e.jsx)(n.em,{children:\"PDF explained: The ISO standarad for document exchange\"}),\". essay, O'Reilly. \",(0,e.jsx)(n.a,{href:\"#user-content-fnref-1\",\"data-footnote-backref\":!0,className:\"data-footnote-backref\",\"aria-label\":\"Back to content\",children:\"\\u21A9\\uFE0E\"})]}),`\n`]}),`\n`]}),`\n`]})]})}}var F=y;return N;})();\n;return Component;","toc":[{"value":"cmap I (PPC, 150) / cmap II (Forensics, 300)","url":"#cmap-i-ppc-150--cmap-ii-forensics-300","depth":2}],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.605,"time":336300,"words":1121},"slug":"ugra-ctf-quals-2022/cmap","fileName":"ugra-ctf-quals-2022/cmap.md","title":"Ugra CTF Quals 2022 – cmap","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Ugra CTF Quals 2022","Misc","Forensics","PDF","CMAP","Font","Encoding"],"summary":"CMap is CMap, but not all “CMap”s are CMap."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon\u0026s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null}],"prev":{"title":"Ugra CTF Quals 2022 – Разборчивая змейка","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","Snake","QR Code"],"summary":"Picky snake, but the one being picky is actually not the snake.","slug":"ugra-ctf-quals-2022/snekpeek"},"next":{"title":"Ugra CTF Quals 2022 – noteasy03","date":"2022-03-02T00:00:00.000Z","draft":false,"authors":["yanhu"],"tags":["Ugra CTF Quals 2022","Crypto","ECC","Elliptic Curve","Misc","Cipher","Caesar"],"summary":"Single table substitution on Elliptic Curve","canonical":"https://yanhuijessica.github.io/Chictf-Writeups/crypto/noteasy03/","slug":"ugra-ctf-quals-2022/noteasy03"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["ugra-ctf-quals-2022","cmap"]},"buildId":"0wxHpwy3ehtFejYPlY-Z7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>