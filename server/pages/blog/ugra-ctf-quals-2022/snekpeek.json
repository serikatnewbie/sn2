{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var c=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var r=n=>c(n,\"__esModule\",{value:!0});var g=(n,s)=>()=>(s||n((s={exports:{}}).exports,s),s.exports),u=(n,s)=>{r(n);for(var t in s)c(n,t,{get:s[t],enumerable:!0})},k=(n,s,t)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let a of d(s))!m.call(n,a)&&a!==\"default\"&&c(n,a,{get:()=>s[a],enumerable:!(t=h(s,a))||t.enumerable});return n},N=n=>k(r(c(n!=null?o(p(n)):{},\"default\",n&&n.__esModule&&\"default\"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var i=g((D,l)=>{l.exports=_jsx_runtime});var f={};u(f,{default:()=>y,frontmatter:()=>w});var e=N(i()),w={title:\"Ugra CTF Quals 2022 \\u2013 \\u0420\\u0430\\u0437\\u0431\\u043E\\u0440\\u0447\\u0438\\u0432\\u0430\\u044F \\u0437\\u043C\\u0435\\u0439\\u043A\\u0430\",date:\"2022-03-01\",draft:!1,authors:[\"blueset\",\"sahuang\"],tags:[\"Ugra CTF Quals 2022\",\"Misc\",\"Snake\",\"QR Code\"],summary:\"Picky snake, but the one being picky is actually not the snake.\"};function b(n={}){let{wrapper:s}=n.components||{};return s?(0,e.jsx)(s,Object.assign({},n,{children:(0,e.jsx)(t,{})})):t();function t(){let a=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",code:\"code\",blockquote:\"blockquote\",p:\"p\",hr:\"hr\",pre:\"pre\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mn:\"mn\",mo:\"mo\",annotation:\"annotation\"},n.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(a.h2,{id:\"\\u0440\\u0430\\u0437\\u0431\\u043E\\u0440\\u0447\\u0438\\u0432\\u0430\\u044F-\\u0437\\u043C\\u0435\\u0439\\u043A\\u0430-picky-snake-snekpeek-250\",children:[(0,e.jsx)(a.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u0440\\u0430\\u0437\\u0431\\u043E\\u0440\\u0447\\u0438\\u0432\\u0430\\u044F-\\u0437\\u043C\\u0435\\u0439\\u043A\\u0430-picky-snake-snekpeek-250\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\u0420\\u0430\\u0437\\u0431\\u043E\\u0440\\u0447\\u0438\\u0432\\u0430\\u044F \\u0437\\u043C\\u0435\\u0439\\u043A\\u0430 (Picky snake \",(0,e.jsx)(a.code,{children:\"snekpeek\"}),\", 250)\"]}),`\n`,(0,e.jsxs)(a.blockquote,{children:[`\n`,(0,e.jsx)(a.p,{children:\"\\u0427\\u0435\\u043C \\u0431\\u043B\\u0438\\u0436\\u0435 \\u0440\\u0435\\u043A\\u043E\\u0440\\u0434, \\u0442\\u0435\\u043C \\u0438\\u043D\\u0442\\u0435\\u0440\\u0435\\u0441\\u043D\\u0435\\u0435 \\u0438\\u0433\\u0440\\u0430\\u0442\\u044C.\"}),`\n`,(0,e.jsx)(a.hr,{}),`\n`,(0,e.jsx)(a.p,{children:\"The closer the record, the more interesting it is to play.\"}),`\n`,(0,e.jsx)(a.p,{children:\"(Google Translate)\"}),`\n`,(0,e.jsx)(a.p,{children:(0,e.jsx)(a.a,{href:\"https://snekpeek.q.2022.ugractf.ru/8619d4ed7f8a85b7/\",children:\"https://snekpeek.q.2022.ugractf.ru/8619d4ed7f8a85b7/\"})}),`\n`]}),`\n`,(0,e.jsxs)(a.p,{children:[\"Opening the web page, we can see a \",(0,e.jsx)(a.a,{href:\"https://en.wikipedia.org/wiki/Snake_(video_game_genre)\",children:\"Snake game\"}),\", on a 42\\xD742 board, with a high score of 17600. The game awards 10 points for every target eaten.\"]}),`\n`,(0,e.jsx)(a.p,{children:\"When playing the game, the webpage opens a WebSocet connection to the game server, which communicates the game state to the client.\"}),`\n`,(0,e.jsx)(a.pre,{children:(0,e.jsxs)(a.code,{className:\"language-websocket code-highlight\",children:[(0,e.jsx)(a.span,{className:\"code-line\",children:`>>> {\"size\": 42, \"target\": [7, 7], \"head\": [28, 28], \"tail\": \"DDD\", \"score\": 0}\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`<<< U\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`>>> {\"size\": 42, \"target\": [7, 7], \"head\": [28, 27], \"tail\": \"DDD\", \"score\": 0}\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`<<< U\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`>>> {\"size\": 42, \"target\": [7, 7], \"head\": [28, 26], \"tail\": \"DDD\", \"score\": 0}\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`<<< U\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`>>> {\"size\": 42, \"target\": [7, 7], \"head\": [28, 25], \"tail\": \"DDD\", \"score\": 0}\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`...\n`})]})}),`\n`,(0,e.jsx)(a.p,{children:\"The server sends the entire game state, including the target, the entire snake position and posture, and the current score, which made the automation much easier.\"}),`\n`,(0,e.jsx)(a.p,{children:\"Initially, we took the high score as a hint, and looked all over the place for a snake AI trying to beat the game. However, the server connection has not be stable, and the game resets upon disconnection.\"}),`\n`,(0,e.jsx)(a.p,{children:\"Later on, the author updated the game which allows sending multiple instructions at once, so that it can speed up the process a bit.\"}),`\n`,(0,e.jsxs)(a.p,{children:[\"Afterwards, we realized that as we can send batch instructions, we can actually draw an \",(0,e.jsx)(a.a,{href:\"https://en.wikipedia.org/wiki/Eulerian_path\",children:\"Eularian path\"}),\" that covers the entire board and program the snake to follow it.\"]}),`\n`,(0,e.jsx)(a.p,{children:\"One example of the path is shown below.\"}),`\n`,(0,e.jsx)(a.pre,{children:(0,e.jsxs)(a.code,{className:\"code-highlight\",children:[(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u256D\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256E\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2502\\u256D\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256F\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2191\\u2570\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256E\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2502\\u256D\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256F\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2502\\u2570\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256E\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2191\\u256D\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256F\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2502\\u2570\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256E\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\\u2570\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u256F\n`})]})}),`\n`,(0,e.jsx)(a.p,{children:\"The strategy worked pretty well, but we hit a strange error message when we are almost beating the game.\"}),`\n`,(0,e.jsx)(a.pre,{className:\"language-json\",children:(0,e.jsxs)(a.code,{className:\"language-json code-highlight\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token property\",children:'\"size\"'}),(0,e.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token number\",children:\"42\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(a.span,{className:\"token property\",children:'\"target\"'}),(0,e.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token null keyword\",children:\"null\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(a.span,{className:\"token property\",children:'\"head\"'}),(0,e.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(a.span,{className:\"token number\",children:\"36\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(a.span,{className:\"token number\",children:\"36\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),` \n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token property\",children:'\"tail\"'}),(0,e.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token string\",children:'\"...\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(a.span,{className:\"token property\",children:'\"score\"'}),(0,e.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token number\",children:\"13590\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),` \n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token property\",children:'\"error\"'}),(0,e.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token string\",children:'\"Unable to place new target because all permitted target locations are already occupied by snek\"'}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.span,{className:\"math math-inline\",children:(0,e.jsxs)(a.span,{className:\"katex\",children:[(0,e.jsx)(a.span,{className:\"katex-mathml\",children:(0,e.jsx)(a.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mn,{children:\"42\"}),(0,e.jsx)(a.mo,{children:\"\\xD7\"}),(0,e.jsx)(a.mn,{children:\"42\"}),(0,e.jsx)(a.mo,{children:\"=\"}),(0,e.jsx)(a.mn,{children:\"1764\"})]}),(0,e.jsx)(a.annotation,{encoding:\"application/x-tex\",children:\"42 \\\\times 42 = 1764\"})]})})}),(0,e.jsxs)(a.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(a.span,{className:\"base\",children:[(0,e.jsx)(a.span,{className:\"strut\",style:{height:\"0.7278em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(a.span,{className:\"mord\",children:\"42\"}),(0,e.jsx)(a.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(a.span,{className:\"mbin\",children:\"\\xD7\"}),(0,e.jsx)(a.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(a.span,{className:\"base\",children:[(0,e.jsx)(a.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,e.jsx)(a.span,{className:\"mord\",children:\"42\"}),(0,e.jsx)(a.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(a.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(a.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(a.span,{className:\"base\",children:[(0,e.jsx)(a.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,e.jsx)(a.span,{className:\"mord\",children:\"1764\"})]})]})]})}),\", and we are far from filling the entire board. The error message mentions \\u201Cpermitted target locations\\u201D, which made me think that there must be something special about where the targets appear.\"]}),`\n`,(0,e.jsx)(a.p,{children:\"Extracting all the past target locations from the traffic log, and plot them on a 42\\xD742 grid, it turns out to be something very \\u201Cinteresting\\u201D.\"}),`\n`,(0,e.jsx)(\"img\",{src:\"/static/images/ugra-ctf-quals-2022/snekpeek/qr.png\",alt:\"A plot of all target locations in a game play, which appears to be a QR Code\",style:{width:\"100%\",imageRendering:\"pixelated\"}}),`\n`,(0,e.jsxs)(a.p,{children:[\"A QR Code, and they are nice enough to \",(0,e.jsx)(a.a,{href:\"https://www.qrcode.com/en/howto/code.html\",children:\"pad\"}),\" it! That explains why it says \\u201Cpicky\\u201D in the title.\"]}),`\n`,(0,e.jsx)(a.p,{children:\"Scan it, and there\\u2019s the flag.\"})]})}}var y=b;return f;})();\n;return Component;","toc":[{"value":"Разборчивая змейка (Picky snake snekpeek, 250)","url":"#разборчивая-змейка-picky-snake-snekpeek-250","depth":2}],"frontMatter":{"readingTime":{"text":"3 min read","minutes":2.57,"time":154200,"words":514},"slug":"ugra-ctf-quals-2022/snekpeek","fileName":"ugra-ctf-quals-2022/snekpeek.md","title":"Ugra CTF Quals 2022 – Разборчивая змейка","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","Snake","QR Code"],"summary":"Picky snake, but the one being picky is actually not the snake."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null},{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["sahuang"],"fileName":"sahuang.md","name":"sahuang","avatar":"https://www.gravatar.com/avatar/740255f8ddc8f903d3addafb219ea077?d=identicon&s=256","specialties":["Crypto","Reverse"],"github":"https://github.com/sahuang","linkedin":"https://www.linkedin.com/in/xiaohai-xu-1a8884138/","member":true,"order":0,"description":"Rhythm Gamer. Also the team founder.","date":null}],"prev":{"title":"Ugra CTF Quals 2022 – Играет как умеет","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset","sahuang"],"tags":["Ugra CTF Quals 2022","Misc","PDF","Music","Audio Processing","Talking Piano"],"summary":"Talking piano illusion only works if you know the words, but what if you only sort of know them?","slug":"ugra-ctf-quals-2022/symphony"},"next":{"title":"Ugra CTF Quals 2022 – cmap","date":"2022-03-01T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Ugra CTF Quals 2022","Misc","Forensics","PDF","CMAP","Font","Encoding"],"summary":"CMap is CMap, but not all “CMap”s are CMap.","slug":"ugra-ctf-quals-2022/cmap"}},"__N_SSG":true}