<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png?v=2"/><link rel="manifest" href="/static/favicons/site.webmanifest?v=2"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg?v=2" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>WolvSec CTF – CPA-Secure Diffie–Hellman?</title><meta name="robots" content="follow, index"/><meta name="description" content="Small subgroup attack on Diffie-Hellman...?"/><meta property="og:url" content="https://sekai.team/blog/wolvsec-ctf/cpa/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Project SEKAI"/><meta property="og:description" content="Small subgroup attack on Diffie-Hellman...?"/><meta property="og:title" content="WolvSec CTF – CPA-Secure Diffie–Hellman?"/><meta property="og:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=WolvSec+CTF+%E2%80%93+CPA-Secure+Diffie%E2%80%93Hellman%3F&amp;desc=Small+subgroup+attack+on+Diffie-Hellman...%3F&amp;authors=sahuang"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/ProjectSEKAIctf"/><meta name="twitter:title" content="WolvSec CTF – CPA-Secure Diffie–Hellman?"/><meta name="twitter:description" content="Small subgroup attack on Diffie-Hellman...?"/><meta name="twitter:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=WolvSec+CTF+%E2%80%93+CPA-Secure+Diffie%E2%80%93Hellman%3F&amp;desc=Small+subgroup+attack+on+Diffie-Hellman...%3F&amp;authors=sahuang"/><meta property="article:published_time" content="2022-03-26T00:00:00.000Z"/><link rel="canonical" href="https://sekai.team/blog/wolvsec-ctf/cpa/"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sekai.team/blog/wolvsec-ctf/cpa"
  },
  "headline": "WolvSec CTF – CPA-Secure Diffie–Hellman?",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://og-vercel-ruby.vercel.app/api/sekai?title=WolvSec+CTF+%E2%80%93+CPA-Secure+Diffie%E2%80%93Hellman%3F&desc=Small+subgroup+attack+on+Diffie-Hellman...%3F&authors=sahuang"
    }
  ],
  "datePublished": "2022-03-26T00:00:00.000Z",
  "dateModified": "2022-03-26T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "sahuang"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Project SEKAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sekai.team/static/images/fullLogo.svg"
    }
  },
  "description": "Small subgroup attack on Diffie-Hellman...?"
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/206f24680f6266ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/206f24680f6266ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-09a75c9ee2bd415e.js" defer=""></script><script src="/_next/static/chunks/main-b8c3e234d7065a2c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8cbc7cb85baf88e.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/29107295-a2d0c8e72019a3ed.js" defer=""></script><script src="/_next/static/chunks/545-f1dc6b53ce85b08b.js" defer=""></script><script src="/_next/static/chunks/930-1296a6163e1e3cc6.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-9a47024c9df525b8.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_buildManifest.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_ssgManifest.js" defer=""></script><script src="/_next/static/zs4rZRwOZcgSj8qsc8Zvy/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Visit home page" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 468.7 215.63" height="80" width="auto"><defs><linearGradient id="fullLogo_svg__linear-gradient" x1="-7051.74" y1="5608.42" x2="-7051.74" y2="5392.1" gradientTransform="matrix(1 0 .15 -.99 6503.98 5547.9)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00e5ea"></stop><stop offset="1" stop-color="#00b5cc"></stop></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-2" x1="1498.32" y1="4428.84" x2="1497.92" y2="4311.82" gradientTransform="matrix(1 0 0 -1 -1107.01 4435.41)" xlink:href="#fullLogo_svg__linear-gradient"></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-3" x1="320.76" y1="14.17" x2="320.76" y2="47.97" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0069a5"></stop><stop offset="1" stop-color="#003d6b"></stop></linearGradient><style>.fullLogo_svg__cls-1{fill:#fff}</style></defs><g id="fullLogo_svg__Project_SEKAI_Wide_White" data-name="Project SEKAI Wide White"><path class="fullLogo_svg__cls-1" d="M107 117.14v-4c11.93 0 22.15-8.62 23.76-20l12.91-91.63h4.06l-13 92.14c-1.92 13.4-13.84 23.49-27.73 23.49Z"></path><path class="fullLogo_svg__cls-1" d="M97.43 98.3a16 16 0 0 1-16.26-18.72l8.68-61.42A21.78 21.78 0 0 1 110.77 0a16.34 16.34 0 0 1 12.57 5.5A16.36 16.36 0 0 1 127 18.72l-8.69 61.42c-1.39 10.01-10.77 18.16-20.88 18.16ZM110.77 4a17.63 17.63 0 0 0-17 14.72l-8.64 61.42a12 12 0 0 0 12.3 14.16 17.65 17.65 0 0 0 16.95-14.72l8.69-61.42a12.41 12.41 0 0 0-2.75-10A12.4 12.4 0 0 0 110.77 4ZM186.94 5.42l.56-3.91H162.99l-13.5 95.44H174l.57-4h-20.46l5.85-41.36h20.46l.56-4h-20.45l5.96-42.17h20.45zM266.73 1.51h-31.01l-.55 3.91h14.2l-12.95 91.53h4.06l12.93-91.53h12.77l.55-3.91zM212.61 1.51a15.86 15.86 0 0 0-15.24 13.24l-9.86 69.48a11.69 11.69 0 0 0 2.76 9.34 12.57 12.57 0 0 0 9.18 4.43h.2c6.38 0 11.65-5.57 15.15-9.28L211.9 86c-3.06 3.23-7.67 8.11-12.38 8a8.54 8.54 0 0 1-6.21-3 7.73 7.73 0 0 1-1.84-6.18l9.86-69.48a11.83 11.83 0 0 1 11.28-9.9h13.91l.55-3.91ZM37.08 5.58a12 12 0 0 0-9.26-4.06H13.5L0 97h4.06l6.41-45.37h10.84a15.87 15.87 0 0 0 15.24-13.29l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.26 23a11.74 11.74 0 0 1-11.27 9.8H11l6-42.13h10.85a7.94 7.94 0 0 1 8 9.33ZM75.09 5.58a12 12 0 0 0-9.26-4.06h-14.3L38 97h4l6.5-45.42h10L65 96.2h4l-6.6-45a16 16 0 0 0 12.16-12.86l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.25 23a11.76 11.76 0 0 1-11.28 9.8H49.07L55 5.42h10.86a7.94 7.94 0 0 1 8 9.33ZM223.75 215.47h-4.06l13.5-95.43h4.05l-13.49 95.43zM65.83 215.63a14.49 14.49 0 0 1-11-4.65 11.3 11.3 0 0 1-2.68-9.15l1.31-8.59 4.4-2.34-1.76 11.52a7.24 7.24 0 0 0 1.75 5.93 10.47 10.47 0 0 0 8 3.28c6.42 0 12.26-4.39 13-9.8l5.42-38.33-28.77 15.27 6.37-46c1-7.3 8.65-13.24 17-13.24a14.52 14.52 0 0 1 11 4.65 11.36 11.36 0 0 1 2.68 9.14l-1.2 8.68-4.35 2.34 1.64-11.6a7.29 7.29 0 0 0-1.74-6 10.5 10.5 0 0 0-8-3.28c-6.42 0-12.26 4.39-13 9.79l-5.29 38.27 28.8-15.28-6.52 46.1c-1.11 7.35-8.73 13.29-17.06 13.29ZM174.15 120.04h-4.51l-26.9 51.72 7.31-51.72H146l-13.5 95.43h4.05l4.5-31.8 10.61-20.4 12.61 52.2h4.11l-13.91-57.6 19.68-37.83zM205 215.47h4l-2.29-94.87v-.56h-4l-29.31 95.43h4.18l9.82-32h16.83Zm-16.37-36L203 132.68l1.13 46.81ZM132.58 123.94l.56-3.91h-24.52l-13.49 95.44h24.51l.56-4H99.75l5.85-41.36h20.45l.57-4h-20.46l5.97-42.17h20.45z"></path><path style="fill:url(#fullLogo_svg__linear-gradient)" d="M279.69 1.51h8.87l-32.09 213.93h-8.87L279.69 1.51z"></path><path d="M393.81 14.88C396 .34 331.4 1.5 296.53 1.5L283.6 87.67c33.36-1.94 99.5-2 97.21 13.27-1.14 7.58-5.53 7.29-6.1 11.08-1.52 10.14 70.94 5.62 81.15 4.52L434 73.6l34.7-43.29c-17.47 1.81-82.47 4.94-81.11-4.15.73-4.87 5.41-5.56 6.22-11.28Z" style="fill:url(#fullLogo_svg__linear-gradient-2)"></path><path d="m324.34 13-5.8 25.24A9.73 9.73 0 0 0 312 36c-4.66 0-8.43 2.82-8.42 6.27s3.8 6.24 8.46 6.22c4 0 7.4-2.12 8.23-4.92 0-.14.06-.28.09-.42l3.48-15.5q9.18 2.06 9.72 5.26a9 9 0 0 1-1.27 6.22 10.78 10.78 0 0 0 5.7-8.81q.48-5.88-13.65-17.32Z" style="fill:url(#fullLogo_svg__linear-gradient-3)"></path></g></svg></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/members/">Members</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/contests/">Contests</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags/">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">CTF 2023</a></div><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/members/">Members</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/contests/">Contests</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">CTF 2023</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-03-26T00:00:00.000Z">Saturday, 26 March 2022</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">WolvSec CTF – CPA-Secure Diffie–Hellman?</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/740255f8ddc8f903d3addafb219ea077?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">sahuang</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://github.com/sahuang" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@sahuang</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><h2 id="cpa-secure-diffiehellman"><a href="#cpa-secure-diffiehellman" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>CPA-Secure Diffie–Hellman?</h2>
<blockquote>
<p>Alice and Bob have implemented their own CPA-Secure Diffie–Hellman key exchange in an effort to ensure nobody can send messages to Alice that appear to be signed by Bob. Their prime is large and they are using sha-256. Despite this someone is impersonating Bob. He is convinced someone has constructed a second pre-image attack on sha-256. Do you agree with his conclusion?</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://dhe-medium-bvel4oasra-uc.a.run.app/">https://dhe-medium-bvel4oasra-uc.a.run.app/</a></p>
</blockquote>
<p>Personally I think this is the best challenge in the whole CTF – The only Crypto problem that I learned something new. Most of their other challenges are either boring or guessy.</p>
<p>We were provided with the following script. I removed website part for simplicity.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
</span><span class="code-line"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
</span><span class="code-line"><span class="token keyword">from</span> hmac <span class="token keyword">import</span> new
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># ephemerals live on as seeds!</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># wrap flag in wsc{}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Someone has cracked sha-256 and has started impersonating me to Alice on the internet!</span>
</span><span class="code-line"><span class="token comment"># Here&#x27;s the oracle they proved sha-256 is forgeable on</span>
</span><span class="code-line"><span class="token comment"># Guess the internet will just have to move on to sha-512 or more likely sha-3</span>
</span><span class="code-line">
</span><span class="code-line">key <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token string">&#x27;0&#x27;</span> <span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token string">&#x27;1&#x27;</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string">&#x27;2&#x27;</span> <span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">,</span> <span class="token string">&#x27;3&#x27;</span> <span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">,</span> <span class="token string">&#x27;4&#x27;</span> <span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">,</span> <span class="token string">&#x27;5&#x27;</span> <span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">,</span> <span class="token string">&#x27;6&#x27;</span> <span class="token punctuation">:</span> <span class="token number">6</span> <span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;a&#x27;</span> <span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">&#x27;b&#x27;</span> <span class="token punctuation">:</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token string">&#x27;c&#x27;</span> <span class="token punctuation">:</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token string">&#x27;d&#x27;</span> <span class="token punctuation">:</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token string">&#x27;e&#x27;</span> <span class="token punctuation">:</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token string">&#x27;f&#x27;</span> <span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token string">&#x27;g&#x27;</span> <span class="token punctuation">:</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token string">&#x27;h&#x27;</span> <span class="token punctuation">:</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token string">&#x27;i&#x27;</span> <span class="token punctuation">:</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token string">&#x27;j&#x27;</span> <span class="token punctuation">:</span> <span class="token number">79</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k&#x27;</span> <span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">&#x27;l&#x27;</span> <span class="token punctuation">:</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token string">&#x27;m&#x27;</span> <span class="token punctuation">:</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token string">&#x27;n&#x27;</span> <span class="token punctuation">:</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token string">&#x27;o&#x27;</span> <span class="token punctuation">:</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token string">&#x27;p&#x27;</span> <span class="token punctuation">:</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token string">&#x27;q&#x27;</span> <span class="token punctuation">:</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token string">&#x27;r&#x27;</span> <span class="token punctuation">:</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token string">&#x27;s&#x27;</span> <span class="token punctuation">:</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token string">&#x27;t&#x27;</span> <span class="token punctuation">:</span> <span class="token number">89</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;u&#x27;</span> <span class="token punctuation">:</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token string">&#x27;v&#x27;</span> <span class="token punctuation">:</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token string">&#x27;w&#x27;</span> <span class="token punctuation">:</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token string">&#x27;x&#x27;</span> <span class="token punctuation">:</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token string">&#x27;y&#x27;</span> <span class="token punctuation">:</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token string">&#x27;z&#x27;</span> <span class="token punctuation">:</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token string">&#x27;_&#x27;</span> <span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token string">&#x27;#&#x27;</span> <span class="token punctuation">:</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token string">&#x27;$&#x27;</span> <span class="token punctuation">:</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token string">&#x27;!&#x27;</span> <span class="token punctuation">:</span> <span class="token number">99</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">bytes_to_long_flag</span><span class="token punctuation">(</span>bytes_in<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    long_out <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">    <span class="token keyword">for</span> b <span class="token keyword">in</span> bytes_in<span class="token punctuation">:</span>
</span><span class="code-line">        long_out <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>long_out<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">long_to_bytes_flag</span><span class="token punctuation">(</span>long_in<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    new_map <span class="token operator">=</span> <span class="token punctuation">{</span>v<span class="token punctuation">:</span> k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> key<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</span><span class="code-line">    list_long_in <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_in<span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line">    str_out <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">    i <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_long_in<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> list_long_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">:</span>
</span><span class="code-line">            str_out <span class="token operator">+=</span> new_map<span class="token punctuation">[</span>list_long_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">            str_out <span class="token operator">+=</span> new_map<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>list_long_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>list_long_in<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line">            i <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">        i <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">    <span class="token keyword">return</span> str_out<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;utf_8&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">diffie_hellman</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    p <span class="token operator">=</span> <span class="token number">6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span>
</span><span class="code-line">    g <span class="token operator">=</span> <span class="token number">5016207480195436608185086499540165384974370357935113494710347988666301733433042648065896850128295520758870894508726377746919372737683286439372142539002903041</span>
</span><span class="code-line">    B <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>b<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token comment">#unused in our protocal</span>
</span><span class="code-line">    s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>b<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
</span><span class="code-line">    message <span class="token operator">=</span> <span class="token string">b&#x27;My totally secure message to Alice&#x27;</span>
</span><span class="code-line">    password <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</span><span class="code-line">    my_hmac <span class="token operator">=</span> new<span class="token punctuation">(</span>key<span class="token operator">=</span>password<span class="token punctuation">,</span> msg <span class="token operator">=</span> message<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>sha256<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>my_hmac<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    A <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;A&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token keyword">not</span> A<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token string">&quot;Missing required query string parameter: A&quot;</span>
</span><span class="code-line">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">            result <span class="token operator">=</span> diffie_hellman<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token keyword">return</span> result
</span><span class="code-line">        <span class="token keyword">except</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token string">&quot;A must be an integer: &quot;</span> <span class="token operator">+</span> A<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;flag.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">flag <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">b <span class="token operator">=</span> bytes_to_long_flag<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#x27;utf-8&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Someone mentioned CPA-Security to me... No idea what that has to do with this</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># All the homies hate 521</span>
</span></code></pre></div>
<p>Let us first check each function.</p>
<p><code>bytes_to_long_flag</code> – Takes flag as byte string and turns it into a long number <code>b</code> according to the <code>key</code> map.</p>
<p><code>long_to_bytes_flag</code> – We will use it in the end to convert the number <code>b</code> back to flag.</p>
<p><code>diffie_hellman</code> – This is the function we need to focus on. We are given an encryption scheme where <code>p</code> is known. We can choose arbitrary <code>A</code> and the server will compute the following:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>b<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token comment"># b is what we need to attack</span>
</span><span class="code-line">message <span class="token operator">=</span> <span class="token string">b&#x27;My totally secure message to Alice&#x27;</span> <span class="token comment"># Fixed message</span>
</span><span class="code-line">password <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</span><span class="code-line">my_hmac <span class="token operator">=</span> new<span class="token punctuation">(</span>key<span class="token operator">=</span>password<span class="token punctuation">,</span> msg <span class="token operator">=</span> message<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>sha256<span class="token punctuation">)</span> <span class="token comment"># hmac on the fixed message</span>
</span><span class="code-line"><span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>my_hmac<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>On the website, we can provide chosen <code>A</code> and it will return the value of <code>diffie_hellman(A)</code> which is the digest of hmac.</p>
<p>Spent some time playing around with the website, we observed that inputting <code>A = 1</code> and <code>A = -1</code> yield different results, meaning that <code>b</code> is odd. (Since <code>pow(A,b,p)</code> needs to be different.) Our intuition was to do some oracle kind of attack, which sounds like a good starting point.</p>
<p><img src="/static/images/wolvsec-ctf/cpa/discord_chat.png" alt="Discord chat"/></p>
<blockquote>
<p>the way to solve this would be<br/>
<!-- -->first put 1 and then -1<br/>
<!-- -->you get different outputs mean that the last bit is 1<br/>
<!-- -->now for second bit<br/>
<!-- -->was thinking of finding 4th root of 1 in modulo p<br/>
<!-- -->there are 4 possible roots<br/>
<!-- -->two of them are -1 and 1 which we won’t use here<br/>
<!-- -->the other two we pass it into the oracle<br/>
<!-- -->if we get different, the second bit is 1<br/>
<!-- -->otherwise 0</p>
</blockquote>
<p>However, it turns out there are only 2 n-th roots of 1 modulo <code>p</code> if <code>n = pow(2, k)</code>. At this point I began to search for property of <code>p</code>, which surprisingly belongs to an OEIS:</p>
<p><img src="/static/images/wolvsec-ctf/cpa/sequence.png" alt="Sequence"/></p>
<p>We noticed that <code>p = pow(2, 521) - 1</code> and is a Mersenne prime. (I later saw there is a hint in the source code: <code>All the homies hate 521</code>, but I did not realize it before solving the challenge.) With some research, I found a statement “breaking the Diffie-Hellman Key Exchange Protocol is easy for Fermat primes and Mersenne primes” - which convinced me this might be the right path.</p>
<p>My first finding: if we let <code>A = 2</code>, we can get</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>s</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>A</mi><mi>b</mi></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> </mtext><mi>s</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mn>2</mn><mrow><mn>521</mn><mo>×</mo><mi>k</mi><mo>+</mo><mi>l</mi></mrow></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><msup><mn>2</mn><mn>521</mn></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> </mtext><mi>s</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mn>2</mn><mrow><mn>521</mn><mo>×</mo><mi>k</mi></mrow></msup><mo>×</mo><msup><mn>2</mn><mi>l</mi></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><msup><mn>2</mn><mn>521</mn></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> </mtext><mi>s</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mn>2</mn><mi>l</mi></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
  s &amp;= A^{b} \bmod p \\\
  s &amp;= 2^{521\times k + l} \bmod 2^{521}-1 \\\
  s &amp;= 2^{521\times k} \times 2^{l} \bmod 2^{521}-1 \\\
  s &amp;= 2^{l}
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.2364em;vertical-align:-2.8682em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3682em"><span style="top:-5.4691em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord mathnormal">s</span></span></span><span style="top:-2.3509em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord mathnormal">s</span></span></span><span style="top:-0.7918em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace"> </span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8682em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3682em"><span style="top:-5.4691em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em"></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em"></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">521</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em"></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em"></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">521</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-2.3509em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">521</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em"></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em"></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">521</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-0.7918em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8682em"><span></span></span></span></span></span></span></span></span></span></span></span></div>
<p>Where we let <code>b = 521*k+l</code> and <code>l &lt; 521</code>. Since there are only 521 possible <code>l</code>, we can brute force hmac and find if it matches the hmac result on the website. From this we know <code>b mod 521</code>.</p>
<p>It turns out this can work for all small primes of <code>p-1</code>. Our attack is as follows:</p>
<ol>
<li>Factorize <code>p-1</code>, and get an array of <code>q</code> such that <code>q | p - 1</code>.</li>
<li>If <code>q | p - 1</code>, we want to find a number <code>x</code> such that <code>x^q = 1 (mod p)</code>. Example: <code>521 | p - 1</code>, we find that <code>2^521 = 1 (mod p)</code></li>
<li>Let <code>A = x</code> and get hmac output from the website. Now we can simply enumerate <code>key = 1, A, A^2, ..., A^(q-1)</code> to get our calculated hmac results, and find the one that matches the one shown on website. <strong>In this way we know <code>b % q</code></strong>.</li>
<li>Do this for all prime factors of <code>p - 1</code>. Since enumeration is on <code>q</code>, <code>q</code> cannot be too large, so we might need to stop at some point, but that should be enough.</li>
<li>Once we get all <code>b % q</code> we can use <code>crt</code> to solve modular equation system. We finally call <code>long_to_bytes_flag</code> to get flag.</li>
</ol>
<p>Note that this solution will work as <code>p</code> is a Mersenne prime and factorization of <code>p - 1</code> yields smooth primes. Let us code each part.</p>
<h3 id="factorization"><a href="#factorization" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Factorization</h3>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">from</span> factordb<span class="token punctuation">.</span>factordb <span class="token keyword">import</span> FactorDB
</span><span class="code-line"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> <span class="token operator">*</span>
</span><span class="code-line">
</span><span class="code-line">p <span class="token operator">=</span> <span class="token number">6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span>
</span><span class="code-line">
</span><span class="code-line">f <span class="token operator">=</span> FactorDB<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">f<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">factors <span class="token operator">=</span> f<span class="token punctuation">.</span>get_factor_list<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>factors<span class="token punctuation">)</span> <span class="token comment"># [2, 3, 5, 5, 11, 17, 31, 41, 53, 131, 157, 521, 1613, 2731, 8191, 42641, 51481, 61681, 409891, 858001, 5746001, 7623851, 34110701, 308761441, 2400573761, 65427463921, 108140989558681, 145295143558111, 173308343918874810521923841]</span>
</span></code></pre></div>
<h3 id="get-array-of-a"><a href="#get-array-of-a" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Get array of A</h3>
<p>Let us stop at prime 7623851. Each <code>nth_root(q)</code> will return <code>q</code> solutions, we just need to pick a random one that is NOT 1.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">qs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">1613</span><span class="token punctuation">,</span> <span class="token number">2731</span><span class="token punctuation">,</span> <span class="token number">8191</span><span class="token punctuation">,</span> <span class="token number">42641</span><span class="token punctuation">,</span> <span class="token number">51481</span><span class="token punctuation">,</span> <span class="token number">61681</span><span class="token punctuation">,</span> <span class="token number">409891</span><span class="token punctuation">,</span> <span class="token number">858001</span><span class="token punctuation">,</span> <span class="token number">5746001</span><span class="token punctuation">,</span> <span class="token number">7623851</span><span class="token punctuation">]</span>
</span><span class="code-line">As <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> q <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>qs<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">assert</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> q <span class="token operator">==</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token comment"># find A such that A^q = 1 (mod p)</span>
</span><span class="code-line">    A <span class="token operator">=</span> mod<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">.</span>nth_root<span class="token punctuation">(</span>q<span class="token punctuation">,</span> <span class="token builtin">all</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token comment"># print(len(A))</span>
</span><span class="code-line">    As<span class="token punctuation">.</span>append<span class="token punctuation">(</span>A<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>Next we plug these <code>As</code> on the website and make queries to get hmacs. e.g. <code>https://dhe-medium-bvel4oasra-uc.a.run.app?A=2</code></p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">hmacs <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token number">90955237956961005126189890739708800567014836931403058445375855242389099585701</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">20622406187866361184960795196046480859426473595059025902341280993971771378288</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">91368064761969554193146310664428696779669778217293388427175887610826255556020</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">74021593115437125724024446523467719290309892636225095633323251957292028007132</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">10716258788641479259594529780635715860349212776071528807400384532061573153008</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">110510228817758736818252789151915040195413986812322691047390564789478326973050</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">65262770926857981885448926437679422618994233854053849290222210849227212897520</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">57435813898663542619087859683488085284323482381057842568122199304476971950523</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">9967846880058967842313047192978638601339192853624560939100516409504228047626</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">34967325199632989453867820562138113005051555475875808882359441344461422450499</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">91368064761969554193146310664428696779669778217293388427175887610826255556020</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">31743099937462953838420138089826239234058887936841257999333341042640277908838</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">91675905941987675878239782917111661679692464439705001658016439827716618545165</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">105753927392692241661624046469843247134214934184588590022760687820963468567616</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">23901054353629274832410860711360758784125475837395501853661319179438740190165</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">102557550478192355354391076861234563743000999800502420626135097732567720012327</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">69212182994459464439026839995716859251160492847604538040515680157299030133365</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">65002122913494568498218268818219782603905118449754877723534048019066958627760</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">39832404137779429258931968594173145831388800981461808550758491797445688935686</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">31851101972958182833519147171046031144906686288554760230152812880237129795757</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token number">13343204244345352896009532737013092899621868990191685708915515624011831103237</span>
</span><span class="code-line"><span class="token punctuation">]</span>
</span></code></pre></div>
<h3 id="find-b--q"><a href="#find-b--q" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Find <code>b % q</code></h3>
<p>Next step is to find <code>b % q</code> for all <code>q</code> in <code>qs</code>. This can be easily done by brute-forcing hmacs.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
</span><span class="code-line"><span class="token keyword">from</span> hmac <span class="token keyword">import</span> new
</span><span class="code-line"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
</span><span class="code-line">
</span><span class="code-line">message <span class="token operator">=</span> <span class="token string">b&#x27;My totally secure message to Alice&#x27;</span>
</span><span class="code-line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>As<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    A <span class="token operator">=</span> As<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
</span><span class="code-line">    q <span class="token operator">=</span> qs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword">assert</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> q <span class="token operator">==</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">assert</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># enumerate A^0 to A^(q-1)</span>
</span><span class="code-line">    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> j<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
</span><span class="code-line">        password <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        my_hmac <span class="token operator">=</span> new<span class="token punctuation">(</span>key<span class="token operator">=</span>password<span class="token punctuation">,</span> msg <span class="token operator">=</span> message<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>sha256<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>my_hmac<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">str</span><span class="token punctuation">(</span>hmacs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;b % &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>The output:</p>
<div class="relative"><pre><code class="code-highlight"><span class="code-line">b % 2 = 1
</span><span class="code-line">b % 3 = 1
</span><span class="code-line">b % 5 = 0
</span><span class="code-line">b % 11 = 2
</span><span class="code-line">b % 17 = 15
</span><span class="code-line">b % 31 = 9
</span><span class="code-line">b % 41 = 29
</span><span class="code-line">b % 53 = 45
</span><span class="code-line">b % 131 = 1
</span><span class="code-line">b % 157 = 84
</span><span class="code-line">b % 521 = 0
</span><span class="code-line">b % 521 = 4
</span><span class="code-line">b % 521 = 9
</span><span class="code-line">b % 521 = 18
</span><span class="code-line">b % 521 = 27
</span><span class="code-line">b % 521 = 36
</span><span class="code-line">b % 521 = 45
</span><span class="code-line">b % 521 = 54
</span><span class="code-line">b % 521 = 63
</span><span class="code-line">b % 521 = 72
</span><span class="code-line">b % 521 = 77
</span><span class="code-line">b % 521 = 81
</span><span class="code-line">b % 521 = 86
</span><span class="code-line">b % 521 = 95
</span><span class="code-line">b % 521 = 104
</span><span class="code-line">b % 521 = 113
</span><span class="code-line">b % 521 = 122
</span><span class="code-line">b % 521 = 131
</span><span class="code-line">b % 521 = 140
</span><span class="code-line">b % 521 = 149
</span><span class="code-line">b % 521 = 154
</span><span class="code-line">b % 521 = 163
</span><span class="code-line">b % 521 = 172
</span><span class="code-line">b % 521 = 181
</span><span class="code-line">b % 521 = 190
</span><span class="code-line">b % 521 = 199
</span><span class="code-line">b % 521 = 208
</span><span class="code-line">b % 521 = 217
</span><span class="code-line">b % 521 = 226
</span><span class="code-line">b % 521 = 231
</span><span class="code-line">b % 521 = 240
</span><span class="code-line">b % 521 = 249
</span><span class="code-line">b % 521 = 258
</span><span class="code-line">b % 521 = 267
</span><span class="code-line">b % 521 = 276
</span><span class="code-line">b % 521 = 285
</span><span class="code-line">b % 521 = 294
</span><span class="code-line">b % 521 = 299
</span><span class="code-line">b % 521 = 303
</span><span class="code-line">b % 521 = 308
</span><span class="code-line">b % 521 = 317
</span><span class="code-line">b % 521 = 326
</span><span class="code-line">b % 521 = 335
</span><span class="code-line">b % 521 = 344
</span><span class="code-line">b % 521 = 353
</span><span class="code-line">b % 521 = 362
</span><span class="code-line">b % 521 = 371
</span><span class="code-line">b % 521 = 376
</span><span class="code-line">b % 521 = 385
</span><span class="code-line">b % 521 = 394
</span><span class="code-line">b % 521 = 403
</span><span class="code-line">b % 521 = 412
</span><span class="code-line">b % 521 = 421
</span><span class="code-line">b % 521 = 430
</span><span class="code-line">b % 521 = 439
</span><span class="code-line">b % 521 = 448
</span><span class="code-line">b % 521 = 453
</span><span class="code-line">b % 521 = 462
</span><span class="code-line">b % 521 = 471
</span><span class="code-line">b % 521 = 480
</span><span class="code-line">b % 521 = 489
</span><span class="code-line">b % 521 = 498
</span><span class="code-line">b % 521 = 507
</span><span class="code-line">b % 521 = 516
</span><span class="code-line">b % 1613 = 758
</span><span class="code-line">b % 2731 = 1566
</span><span class="code-line">b % 8191 = 4693
</span><span class="code-line">b % 42641 = 40709
</span><span class="code-line">b % 51481 = 18367
</span><span class="code-line">b % 61681 = 60431
</span><span class="code-line">b % 409891 = 231910
</span><span class="code-line">b % 858001 = 6110
</span><span class="code-line">b % 5746001 = 5113228
</span><span class="code-line">b % 7623851 = 2550195
</span></code></pre></div>
<p>Oops, it seems that 521 is the cursed number as it has so many modulos! We can just throw it away.</p>
<h3 id="get-flag"><a href="#get-flag" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Get flag</h3>
<p>Finally, we do a <code>crt</code> with the help of sage and get (the smallest possible value of) <code>b</code>. Hopefully this can be transformed into the flag.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">key <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token string">&#x27;0&#x27;</span> <span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token string">&#x27;1&#x27;</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string">&#x27;2&#x27;</span> <span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">,</span> <span class="token string">&#x27;3&#x27;</span> <span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">,</span> <span class="token string">&#x27;4&#x27;</span> <span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">,</span> <span class="token string">&#x27;5&#x27;</span> <span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">,</span> <span class="token string">&#x27;6&#x27;</span> <span class="token punctuation">:</span> <span class="token number">6</span> <span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;a&#x27;</span> <span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">&#x27;b&#x27;</span> <span class="token punctuation">:</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token string">&#x27;c&#x27;</span> <span class="token punctuation">:</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token string">&#x27;d&#x27;</span> <span class="token punctuation">:</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token string">&#x27;e&#x27;</span> <span class="token punctuation">:</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token string">&#x27;f&#x27;</span> <span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token string">&#x27;g&#x27;</span> <span class="token punctuation">:</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token string">&#x27;h&#x27;</span> <span class="token punctuation">:</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token string">&#x27;i&#x27;</span> <span class="token punctuation">:</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token string">&#x27;j&#x27;</span> <span class="token punctuation">:</span> <span class="token number">79</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k&#x27;</span> <span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">&#x27;l&#x27;</span> <span class="token punctuation">:</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token string">&#x27;m&#x27;</span> <span class="token punctuation">:</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token string">&#x27;n&#x27;</span> <span class="token punctuation">:</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token string">&#x27;o&#x27;</span> <span class="token punctuation">:</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token string">&#x27;p&#x27;</span> <span class="token punctuation">:</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token string">&#x27;q&#x27;</span> <span class="token punctuation">:</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token string">&#x27;r&#x27;</span> <span class="token punctuation">:</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token string">&#x27;s&#x27;</span> <span class="token punctuation">:</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token string">&#x27;t&#x27;</span> <span class="token punctuation">:</span> <span class="token number">89</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;u&#x27;</span> <span class="token punctuation">:</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token string">&#x27;v&#x27;</span> <span class="token punctuation">:</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token string">&#x27;w&#x27;</span> <span class="token punctuation">:</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token string">&#x27;x&#x27;</span> <span class="token punctuation">:</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token string">&#x27;y&#x27;</span> <span class="token punctuation">:</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token string">&#x27;z&#x27;</span> <span class="token punctuation">:</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token string">&#x27;_&#x27;</span> <span class="token punctuation">:</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token string">&#x27;#&#x27;</span> <span class="token punctuation">:</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token string">&#x27;$&#x27;</span> <span class="token punctuation">:</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token string">&#x27;!&#x27;</span> <span class="token punctuation">:</span> <span class="token number">99</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">long_to_bytes_flag</span><span class="token punctuation">(</span>long_in<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    new_map <span class="token operator">=</span> <span class="token punctuation">{</span>v<span class="token punctuation">:</span> k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> key<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</span><span class="code-line">    list_long_in <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_in<span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line">    str_out <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">    i <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_long_in<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">if</span> list_long_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">:</span>
</span><span class="code-line">            str_out <span class="token operator">+=</span> new_map<span class="token punctuation">[</span>list_long_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">            str_out <span class="token operator">+=</span> new_map<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>list_long_in<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>list_long_in<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line">            i <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">        i <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">    <span class="token keyword">return</span> str_out<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;utf_8&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 2 = 1
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 3 = 1
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 5 = 0
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 11 = 2
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 17 = 15
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 31 = 9
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 41 = 29
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 53 = 45
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 131 = 1
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 157 = 84
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 1613 = 758
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 2731 = 1566
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 8191 = 4693
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 42641 = 40709
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 51481 = 18367
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 61681 = 60431
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 409891 = 231910
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 858001 = 6110
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 5746001 = 5113228
</span></span><span class="code-line"><span class="token triple-quoted-string string">b % 7623851 = 2550195
</span></span><span class="code-line"><span class="token triple-quoted-string string">&#x27;&#x27;&#x27;</span>
</span><span class="code-line">
</span><span class="code-line">b <span class="token operator">=</span> CRT_list<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">758</span><span class="token punctuation">,</span><span class="token number">1566</span><span class="token punctuation">,</span><span class="token number">4693</span><span class="token punctuation">,</span><span class="token number">40709</span><span class="token punctuation">,</span><span class="token number">18367</span><span class="token punctuation">,</span><span class="token number">60431</span><span class="token punctuation">,</span><span class="token number">231910</span><span class="token punctuation">,</span><span class="token number">6110</span><span class="token punctuation">,</span><span class="token number">5113228</span><span class="token punctuation">,</span><span class="token number">2550195</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">131</span><span class="token punctuation">,</span><span class="token number">157</span><span class="token punctuation">,</span><span class="token number">1613</span><span class="token punctuation">,</span><span class="token number">2731</span><span class="token punctuation">,</span><span class="token number">8191</span><span class="token punctuation">,</span><span class="token number">42641</span><span class="token punctuation">,</span><span class="token number">51481</span><span class="token punctuation">,</span><span class="token number">61681</span><span class="token punctuation">,</span><span class="token number">409891</span><span class="token punctuation">,</span><span class="token number">858001</span><span class="token punctuation">,</span><span class="token number">5746001</span><span class="token punctuation">,</span><span class="token number">7623851</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes_flag<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># b&#x27;5m4l1_5ub_gr0up5&#x27;</span>
</span></code></pre></div>
<p>And this is the flag! <code>wsc{5m4l1_5ub_gr0up5}</code>. (The flag implied this is small subgroup attack which I never heard of.)</p>
<p>Huge thanks to @Utaha for giving me hints and directions to solve this challenge. I would not have thought of this attack without their help. :)</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fsekai.team%2Fblog%2Fwolvsec-ctf%2Fcpa">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/blueset/sekai.team/blob/master/data/blog/wolvsec-ctf/cpa.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/wolvsec-ctf/">WolvSec-CTF</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/crypto/">Crypto</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/diffie-hellman/">Diffie-Hellman</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/prime/">Prime</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/mersenne/">Mersenne</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/factorization/">Factorization</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/davinci-ctf-2022/osint/">DaVinci CTF 2022 – OSINT Compilation</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ritsec-ctf-2022/hamxor/">RITSEC CTF 2022 – Hamxor</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:project.sekai@sekai.team"><span class="sr-only"><span class="w-6">mail</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/project-sekai-ctf"><span class="sr-only"><span class="w-6">github</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/project-sekai-ctf/"><span class="sr-only"><span class="w-6">linkedin</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ProjectSEKAIctf"><span class="sr-only"><span class="w-6">twitter</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/169557"><span class="sr-only"><span class="w-6">ctftime</span></span><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M24 0v24H0V0h24Zm-3.077 3.077L7.067 3.076 16 12.816 10.369 19l-2.195-2.612 3.476-3.573-8.574-9.609v17.717h17.847V3.077Z" fill="currentColor" fill-rule="evenodd"></path></svg></a></div></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><a href="/">Project SEKAI</a><div> • </div><div>© 2024</div><div> • </div><div><a href="https://1a23.com">1A23 Studio</a></div></div><div class="mb-8 text-xs text-center text-gray-200 dark:text-gray-700">This website is in no way affiliated with any of the following individuals or organizations.<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a> © Timothy Lim and contributors; <a target="_blank" rel="noopener noreferrer" href="https://pjsekai.sega.jp/">Project SEKAI: Colorful Stage! feat. Hatsune Miku</a> © SEGA / © Craft Egg Inc. Developed by Colorful Palette; <a target="_blank" rel="noopener noreferrer" href="https://ec.crypton.co.jp/pages/prod/virtualsinger">Character Vocal Series</a> © Crypton Future Media, INC. <a target="_blank" rel="noopener noreferrer" href="https://www.piapro.net">www.piapro.net</a> All rights reserved.</div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var o=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!h.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026l(a,e,{get:()=\u003es[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=\u003ek(t(l(a!=null?o(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=u((v,i)=\u003e{i.exports=_jsx_runtime});var f={};N(f,{default:()=\u003ew,frontmatter:()=\u003eb});var n=g(r()),b={title:\"WolvSec CTF \\u2013 CPA-Secure Diffie\\u2013Hellman?\",date:\"2022-03-26\",draft:!1,authors:[\"sahuang\"],tags:[\"WolvSec CTF\",\"Crypto\",\"Diffie-Hellman\",\"Prime\",\"Mersenne\",\"Factorization\"],summary:\"Small subgroup attack on Diffie-Hellman...?\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",pre:\"pre\",code:\"code\",img:\"img\",br:\"br\",div:\"div\",math:\"math\",semantics:\"semantics\",mtable:\"mtable\",mtr:\"mtr\",mtd:\"mtd\",mstyle:\"mstyle\",mi:\"mi\",mrow:\"mrow\",mo:\"mo\",msup:\"msup\",mtext:\"mtext\",mn:\"mn\",annotation:\"annotation\",ol:\"ol\",li:\"li\",strong:\"strong\",h3:\"h3\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"cpa-secure-diffiehellman\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#cpa-secure-diffiehellman\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"CPA-Secure Diffie\\u2013Hellman?\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"Alice and Bob have implemented their own CPA-Secure Diffie\\u2013Hellman key exchange in an effort to ensure nobody can send messages to Alice that appear to be signed by Bob. Their prime is large and they are using sha-256. Despite this someone is impersonating Bob. He is convinced someone has constructed a second pre-image attack on sha-256. Do you agree with his conclusion?\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://dhe-medium-bvel4oasra-uc.a.run.app/\",children:\"https://dhe-medium-bvel4oasra-uc.a.run.app/\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Personally I think this is the best challenge in the whole CTF \\u2013 The only Crypto problem that I learned something new. Most of their other challenges are either boring or guessy.\"}),`\n`,(0,n.jsx)(e.p,{children:\"We were provided with the following script. I removed website part for simplicity.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" Crypto\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Util\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"number \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" bytes_to_long\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` long_to_bytes\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" hashlib \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sha256\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" hmac \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` new\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# ephemerals live on as seeds!\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# wrap flag in wsc{}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Someone has cracked sha-256 and has started impersonating me to Alice on the internet!\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Here's the oracle they proved sha-256 is forgeable on\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Guess the internet will just have to move on to sha-512 or more likely sha-3\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'0'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'1'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'2'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'3'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'4'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'5'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'6'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"6\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'a'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"70\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'b'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"71\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'c'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"72\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'d'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"73\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'e'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"74\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"75\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'g'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"76\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'h'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"77\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'i'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"78\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'j'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"79\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'k'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'l'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"81\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'m'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"82\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'n'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"83\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'o'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"84\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'p'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"85\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'q'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"86\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'r'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"87\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'s'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"88\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'t'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"89\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'u'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"90\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'v'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"91\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'w'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"92\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'x'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"93\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'y'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"94\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'z'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"95\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'_'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"96\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'#'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"97\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'$'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"98\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'!'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"99\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"bytes_to_long_flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bytes_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    long_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" b \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" bytes_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        long_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"chr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"long_out\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"long_to_bytes_flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    new_map \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"v\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" k \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" v \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"items\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    list_long_in \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" x \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    str_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"while\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            str_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" new_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            str_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" new_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" str_out\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"utf_8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"diffie_hellman\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    p \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    g \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5016207480195436608185086499540165384974370357935113494710347988666301733433042648065896850128295520758870894508726377746919372737683286439372142539002903041\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    B \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"pow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"g\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#unused in our protocal\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"pow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'My totally secure message to Alice'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    password \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" long_to_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    my_hmac \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" new\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"password\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" msg \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" message\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" digestmod\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"sha256\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bytes_to_long\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"my_hmac\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"digest\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token decorator annotation punctuation\",children:[\"@app\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"route\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"home\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    A \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'A'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Missing required query string parameter: A\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            result \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" diffie_hellman\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` result\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"except\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"A must be an integer: \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"f \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"open\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"flag.txt\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"r\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"flag \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" f\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" bytes_to_long_flag\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"flag\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'utf-8'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Someone mentioned CPA-Security to me... No idea what that has to do with this\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# All the homies hate 521\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Let us first check each function.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"bytes_to_long_flag\"}),\" \\u2013 Takes flag as byte string and turns it into a long number \",(0,n.jsx)(e.code,{children:\"b\"}),\" according to the \",(0,n.jsx)(e.code,{children:\"key\"}),\" map.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"long_to_bytes_flag\"}),\" \\u2013 We will use it in the end to convert the number \",(0,n.jsx)(e.code,{children:\"b\"}),\" back to flag.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"diffie_hellman\"}),\" \\u2013 This is the function we need to focus on. We are given an encryption scheme where \",(0,n.jsx)(e.code,{children:\"p\"}),\" is known. We can choose arbitrary \",(0,n.jsx)(e.code,{children:\"A\"}),\" and the server will compute the following:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"pow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# b is what we need to attack\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'My totally secure message to Alice'\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Fixed message\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"password \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" long_to_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"my_hmac \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" new\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"password\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" msg \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" message\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" digestmod\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"sha256\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# hmac on the fixed message\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bytes_to_long\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"my_hmac\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"digest\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"On the website, we can provide chosen \",(0,n.jsx)(e.code,{children:\"A\"}),\" and it will return the value of \",(0,n.jsx)(e.code,{children:\"diffie_hellman(A)\"}),\" which is the digest of hmac.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Spent some time playing around with the website, we observed that inputting \",(0,n.jsx)(e.code,{children:\"A = 1\"}),\" and \",(0,n.jsx)(e.code,{children:\"A = -1\"}),\" yield different results, meaning that \",(0,n.jsx)(e.code,{children:\"b\"}),\" is odd. (Since \",(0,n.jsx)(e.code,{children:\"pow(A,b,p)\"}),\" needs to be different.) Our intuition was to do some oracle kind of attack, which sounds like a good starting point.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/wolvsec-ctf/cpa/discord_chat.png\",alt:\"Discord chat\"})}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"the way to solve this would be\",(0,n.jsx)(e.br,{}),`\n`,\"first put 1 and then -1\",(0,n.jsx)(e.br,{}),`\n`,\"you get different outputs mean that the last bit is 1\",(0,n.jsx)(e.br,{}),`\n`,\"now for second bit\",(0,n.jsx)(e.br,{}),`\n`,\"was thinking of finding 4th root of 1 in modulo p\",(0,n.jsx)(e.br,{}),`\n`,\"there are 4 possible roots\",(0,n.jsx)(e.br,{}),`\n`,\"two of them are -1 and 1 which we won\\u2019t use here\",(0,n.jsx)(e.br,{}),`\n`,\"the other two we pass it into the oracle\",(0,n.jsx)(e.br,{}),`\n`,\"if we get different, the second bit is 1\",(0,n.jsx)(e.br,{}),`\n`,\"otherwise 0\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"However, it turns out there are only 2 n-th roots of 1 modulo \",(0,n.jsx)(e.code,{children:\"p\"}),\" if \",(0,n.jsx)(e.code,{children:\"n = pow(2, k)\"}),\". At this point I began to search for property of \",(0,n.jsx)(e.code,{children:\"p\"}),\", which surprisingly belongs to an OEIS:\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/static/images/wolvsec-ctf/cpa/sequence.png\",alt:\"Sequence\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We noticed that \",(0,n.jsx)(e.code,{children:\"p = pow(2, 521) - 1\"}),\" and is a Mersenne prime. (I later saw there is a hint in the source code: \",(0,n.jsx)(e.code,{children:\"All the homies hate 521\"}),\", but I did not realize it before solving the challenge.) With some research, I found a statement \\u201Cbreaking the Diffie-Hellman Key Exchange Protocol is easy for Fermat primes and Mersenne primes\\u201D - which convinced me this might be the right path.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My first finding: if we let \",(0,n.jsx)(e.code,{children:\"A = 2\"}),\", we can get\"]}),`\n`,(0,n.jsx)(e.div,{className:\"math math-display\",children:(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsx)(e.mi,{children:\"s\"})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mrow,{}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"A\"}),(0,n.jsx)(e.mi,{children:\"b\"})]}),(0,n.jsx)(e.mtext,{children:\"\\u200A\"}),(0,n.jsx)(e.mo,{lspace:\"0.22em\",rspace:\"0.22em\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"m\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"o\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"d\"})]})}),(0,n.jsx)(e.mtext,{children:\"\\u200A\"}),(0,n.jsx)(e.mi,{children:\"p\"})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:\"\\xA0\"}),(0,n.jsx)(e.mi,{children:\"s\"})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mrow,{}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"521\"}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"l\"})]})]}),(0,n.jsx)(e.mtext,{children:\"\\u200A\"}),(0,n.jsx)(e.mo,{lspace:\"0.22em\",rspace:\"0.22em\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"m\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"o\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"d\"})]})}),(0,n.jsx)(e.mtext,{children:\"\\u200A\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsx)(e.mn,{children:\"521\"})]}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:\"\\xA0\"}),(0,n.jsx)(e.mi,{children:\"s\"})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mrow,{}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"521\"}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"k\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsx)(e.mi,{children:\"l\"})]}),(0,n.jsx)(e.mtext,{children:\"\\u200A\"}),(0,n.jsx)(e.mo,{lspace:\"0.22em\",rspace:\"0.22em\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"m\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"o\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"d\"})]})}),(0,n.jsx)(e.mtext,{children:\"\\u200A\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsx)(e.mn,{children:\"521\"})]}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:\"\\xA0\"}),(0,n.jsx)(e.mi,{children:\"s\"})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mrow,{}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsx)(e.mi,{children:\"l\"})]})]})})})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`\\\\begin{aligned}\n  s \u0026= A^{b} \\\\bmod p \\\\\\\\\\\\\n  s \u0026= 2^{521\\\\times k + l} \\\\bmod 2^{521}-1 \\\\\\\\\\\\\n  s \u0026= 2^{521\\\\times k} \\\\times 2^{l} \\\\bmod 2^{521}-1 \\\\\\\\\\\\\n  s \u0026= 2^{l}\n\\\\end{aligned}`})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"6.2364em\",verticalAlign:\"-2.8682em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsxs)(e.span,{className:\"mtable\",children:[(0,n.jsx)(e.span,{className:\"col-align-r\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.3682em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-5.4691em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.91em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mspace\",children:\"\\xA0\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-2.3509em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mspace\",children:\"\\xA0\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-0.7918em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mspace\",children:\"\\xA0\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8682em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"col-align-l\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.3682em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-5.4691em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.0556em\"}}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.0556em\"}}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.91em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"521\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.0556em\"}}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.0556em\"}}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"521\"})})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"1\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-2.3509em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"521\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"})})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.0556em\"}}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"mord mathrm\",children:\"mod\"})})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.0556em\"}}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8641em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"521\"})})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"1\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-0.7918em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"})})})]})})})})})]})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8682em\"},children:(0,n.jsx)(e.span,{})})})]})})]})})]})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Where we let \",(0,n.jsx)(e.code,{children:\"b = 521*k+l\"}),\" and \",(0,n.jsx)(e.code,{children:\"l \u003c 521\"}),\". Since there are only 521 possible \",(0,n.jsx)(e.code,{children:\"l\"}),\", we can brute force hmac and find if it matches the hmac result on the website. From this we know \",(0,n.jsx)(e.code,{children:\"b mod 521\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"It turns out this can work for all small primes of \",(0,n.jsx)(e.code,{children:\"p-1\"}),\". Our attack is as follows:\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Factorize \",(0,n.jsx)(e.code,{children:\"p-1\"}),\", and get an array of \",(0,n.jsx)(e.code,{children:\"q\"}),\" such that \",(0,n.jsx)(e.code,{children:\"q | p - 1\"}),\".\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"If \",(0,n.jsx)(e.code,{children:\"q | p - 1\"}),\", we want to find a number \",(0,n.jsx)(e.code,{children:\"x\"}),\" such that \",(0,n.jsx)(e.code,{children:\"x^q = 1 (mod p)\"}),\". Example: \",(0,n.jsx)(e.code,{children:\"521 | p - 1\"}),\", we find that \",(0,n.jsx)(e.code,{children:\"2^521 = 1 (mod p)\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Let \",(0,n.jsx)(e.code,{children:\"A = x\"}),\" and get hmac output from the website. Now we can simply enumerate \",(0,n.jsx)(e.code,{children:\"key = 1, A, A^2, ..., A^(q-1)\"}),\" to get our calculated hmac results, and find the one that matches the one shown on website. \",(0,n.jsxs)(e.strong,{children:[\"In this way we know \",(0,n.jsx)(e.code,{children:\"b % q\"})]}),\".\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Do this for all prime factors of \",(0,n.jsx)(e.code,{children:\"p - 1\"}),\". Since enumeration is on \",(0,n.jsx)(e.code,{children:\"q\"}),\", \",(0,n.jsx)(e.code,{children:\"q\"}),\" cannot be too large, so we might need to stop at some point, but that should be enough.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Once we get all \",(0,n.jsx)(e.code,{children:\"b % q\"}),\" we can use \",(0,n.jsx)(e.code,{children:\"crt\"}),\" to solve modular equation system. We finally call \",(0,n.jsx)(e.code,{children:\"long_to_bytes_flag\"}),\" to get flag.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Note that this solution will work as \",(0,n.jsx)(e.code,{children:\"p\"}),\" is a Mersenne prime and factorization of \",(0,n.jsx)(e.code,{children:\"p - 1\"}),\" yields smooth primes. Let us code each part.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"factorization\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#factorization\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Factorization\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" factordb\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"factordb \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` FactorDB\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" tqdm \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"p \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"f \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" FactorDB\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"f\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"connect\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"factors \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" f\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get_factor_list\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"factors\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# [2, 3, 5, 5, 11, 17, 31, 41, 53, 131, 157, 521, 1613, 2731, 8191, 42641, 51481, 61681, 409891, 858001, 5746001, 7623851, 34110701, 308761441, 2400573761, 65427463921, 108140989558681, 145295143558111, 173308343918874810521923841]\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h3,{id:\"get-array-of-a\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#get-array-of-a\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Get array of A\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Let us stop at prime 7623851. Each \",(0,n.jsx)(e.code,{children:\"nth_root(q)\"}),\" will return \",(0,n.jsx)(e.code,{children:\"q\"}),\" solutions, we just need to pick a random one that is NOT 1.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"qs \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"11\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"17\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"31\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"41\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"53\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"131\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"157\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"521\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1613\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2731\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8191\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"42641\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"51481\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"61681\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"409891\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"858001\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5746001\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"7623851\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"As \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" q \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" tqdm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"qs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"assert\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" q \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# find A such that A^q = 1 (mod p)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    A \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" mod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"nth_root\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"q\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"all\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# print(len(A))\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    As\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Next we plug these \",(0,n.jsx)(e.code,{children:\"As\"}),\" on the website and make queries to get hmacs. e.g. \",(0,n.jsx)(e.code,{children:\"https://dhe-medium-bvel4oasra-uc.a.run.app?A=2\"})]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"hmacs \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"90955237956961005126189890739708800567014836931403058445375855242389099585701\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"20622406187866361184960795196046480859426473595059025902341280993971771378288\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"91368064761969554193146310664428696779669778217293388427175887610826255556020\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"74021593115437125724024446523467719290309892636225095633323251957292028007132\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"10716258788641479259594529780635715860349212776071528807400384532061573153008\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"110510228817758736818252789151915040195413986812322691047390564789478326973050\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"65262770926857981885448926437679422618994233854053849290222210849227212897520\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"57435813898663542619087859683488085284323482381057842568122199304476971950523\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"9967846880058967842313047192978638601339192853624560939100516409504228047626\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"34967325199632989453867820562138113005051555475875808882359441344461422450499\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"91368064761969554193146310664428696779669778217293388427175887610826255556020\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"31743099937462953838420138089826239234058887936841257999333341042640277908838\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"91675905941987675878239782917111661679692464439705001658016439827716618545165\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"105753927392692241661624046469843247134214934184588590022760687820963468567616\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"23901054353629274832410860711360758784125475837395501853661319179438740190165\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"102557550478192355354391076861234563743000999800502420626135097732567720012327\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"69212182994459464439026839995716859251160492847604538040515680157299030133365\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"65002122913494568498218268818219782603905118449754877723534048019066958627760\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"39832404137779429258931968594173145831388800981461808550758491797445688935686\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"31851101972958182833519147171046031144906686288554760230152812880237129795757\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token number\",children:\"13343204244345352896009532737013092899621868990191685708915515624011831103237\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h3,{id:\"find-b--q\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#find-b--q\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Find \",(0,n.jsx)(e.code,{children:\"b % q\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Next step is to find \",(0,n.jsx)(e.code,{children:\"b % q\"}),\" for all \",(0,n.jsx)(e.code,{children:\"q\"}),\" in \",(0,n.jsx)(e.code,{children:\"qs\"}),\". This can be easily done by brute-forcing hmacs.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" hashlib \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sha256\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" hmac \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` new\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" Crypto\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Util\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"number \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" bytes_to_long\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` long_to_bytes\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'My totally secure message to Alice'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"As\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    A \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" As\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    q \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" qs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"assert\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"p\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" q \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"assert\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"pow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" q\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# enumerate A^0 to A^(q-1)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" j \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" q\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"pow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"A\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        password \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" long_to_bytes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        my_hmac \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" new\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"password\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" msg \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" message\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" digestmod\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"sha256\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bytes_to_long\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"my_hmac\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"digest\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"hmacs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"b % \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"q\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\" = \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"The output:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 2 = 1\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 3 = 1\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 5 = 0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 11 = 2\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 17 = 15\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 31 = 9\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 41 = 29\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 53 = 45\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 131 = 1\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 157 = 84\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 4\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 9\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 18\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 27\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 36\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 45\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 54\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 63\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 72\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 77\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 81\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 86\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 95\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 104\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 113\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 122\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 131\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 140\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 149\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 154\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 163\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 172\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 181\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 190\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 199\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 208\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 217\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 226\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 231\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 240\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 249\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 258\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 267\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 276\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 285\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 294\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 299\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 303\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 308\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 317\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 326\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 335\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 344\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 353\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 362\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 371\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 376\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 385\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 394\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 403\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 412\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 421\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 430\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 439\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 448\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 453\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 462\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 471\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 480\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 489\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 498\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 507\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 521 = 516\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 1613 = 758\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 2731 = 1566\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 8191 = 4693\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 42641 = 40709\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 51481 = 18367\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 61681 = 60431\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 409891 = 231910\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 858001 = 6110\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 5746001 = 5113228\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b % 7623851 = 2550195\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Oops, it seems that 521 is the cursed number as it has so many modulos! We can just throw it away.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"get-flag\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#get-flag\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Get flag\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Finally, we do a \",(0,n.jsx)(e.code,{children:\"crt\"}),\" with the help of sage and get (the smallest possible value of) \",(0,n.jsx)(e.code,{children:\"b\"}),\". Hopefully this can be transformed into the flag.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"key \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'0'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'1'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'2'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'3'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'4'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'5'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'6'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"6\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'a'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"70\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'b'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"71\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'c'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"72\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'d'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"73\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'e'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"74\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"75\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'g'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"76\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'h'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"77\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'i'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"78\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'j'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"79\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'k'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'l'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"81\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'m'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"82\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'n'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"83\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'o'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"84\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'p'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"85\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'q'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"86\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'r'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"87\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'s'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"88\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'t'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"89\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'u'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"90\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'v'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"91\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'w'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"92\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'x'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"93\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'y'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"94\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'z'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"95\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'_'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"96\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'#'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"97\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'$'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"98\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'!'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"99\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"long_to_bytes_flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    new_map \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"v\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" k \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" v \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"items\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    list_long_in \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" x \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    str_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"while\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            str_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" new_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            str_out \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" new_map\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"list_long_in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" str_out\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"utf_8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`'''\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 2 = 1\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 3 = 1\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 5 = 0\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 11 = 2\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 17 = 15\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 31 = 9\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 41 = 29\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 53 = 45\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 131 = 1\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 157 = 84\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 1613 = 758\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 2731 = 1566\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 8191 = 4693\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 42641 = 40709\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 51481 = 18367\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 61681 = 60431\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 409891 = 231910\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 858001 = 6110\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 5746001 = 5113228\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`b % 7623851 = 2550195\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:\"'''\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" CRT_list\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"15\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"29\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"45\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"84\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"758\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1566\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"4693\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"40709\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"18367\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"60431\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"231910\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"6110\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5113228\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2550195\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"11\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"17\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"31\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"41\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"53\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"131\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"157\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1613\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2731\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"8191\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"42641\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"51481\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"61681\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"409891\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"858001\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5746001\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"7623851\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"long_to_bytes_flag\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# b'5m4l1_5ub_gr0up5'\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"And this is the flag! \",(0,n.jsx)(e.code,{children:\"wsc{5m4l1_5ub_gr0up5}\"}),\". (The flag implied this is small subgroup attack which I never heard of.)\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Huge thanks to @Utaha for giving me hints and directions to solve this challenge. I would not have thought of this attack without their help. :)\"})]})}}var w=y;return f;})();\n;return Component;","toc":[{"value":"CPA-Secure Diffie–Hellman?","url":"#cpa-secure-diffiehellman","depth":2},{"value":"Factorization","url":"#factorization","depth":3},{"value":"Get array of A","url":"#get-array-of-a","depth":3},{"value":"Find b % q","url":"#find-b--q","depth":3},{"value":"Get flag","url":"#get-flag","depth":3}],"frontMatter":{"readingTime":{"text":"18 min read","minutes":17.21,"time":1032600,"words":3442},"slug":"wolvsec-ctf/cpa","fileName":"wolvsec-ctf/cpa.md","title":"WolvSec CTF – CPA-Secure Diffie–Hellman?","date":"2022-03-26T00:00:00.000Z","draft":false,"authors":["sahuang"],"tags":["WolvSec CTF","Crypto","Diffie-Hellman","Prime","Mersenne","Factorization"],"summary":"Small subgroup attack on Diffie-Hellman...?"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["sahuang"],"fileName":"sahuang.md","name":"sahuang","avatar":"https://www.gravatar.com/avatar/740255f8ddc8f903d3addafb219ea077?d=identicon\u0026s=256","specialties":["Crypto","Reverse"],"github":"https://github.com/sahuang","linkedin":"https://www.linkedin.com/in/xiaohai-xu-1a8884138/","member":true,"order":0,"description":"Rhythm Gamer. Also the team founder.","date":null}],"prev":{"title":"DaVinci CTF 2022 – OSINT Compilation","date":"2022-03-13T00:00:00.000Z","draft":false,"authors":["sahuang"],"tags":["DaVinci CTF 2022","OSINT"],"summary":"Write-ups for all OSINT problems in DaVinci CTF 2022.","slug":"davinci-ctf-2022/osint"},"next":{"title":"RITSEC CTF 2022 – Hamxor","date":"2022-04-03T00:00:00.000Z","draft":false,"authors":["sahuang"],"tags":["RITSEC CTF 2022","Misc","XOR","Hamming Code"],"summary":"Error correction with xor for the win.","slug":"ritsec-ctf-2022/hamxor"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["wolvsec-ctf","cpa"]},"buildId":"zs4rZRwOZcgSj8qsc8Zvy","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>