{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var l=a=>t(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!m.call(a,e)&&e!==\"default\"&&t(a,e,{get:()=>s[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=>k(l(t(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((v,i)=>{i.exports=_jsx_runtime});var f={};N(f,{default:()=>y,frontmatter:()=>w});var n=g(o()),w={title:\"BRICS+ CTF Quals 2023 \\u2013 FlagCMP\",date:\"2023-09-26\",draft:!1,authors:[\"thebadgod\"],tags:[\"BRICSCTF Quals 2023\",\"Reverse\",\"Wasm\",\"VM\"],summary:\"Wasm reversing; and pwning (kind of)\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",h2:\"h2\",code:\"code\",pre:\"pre\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"flagcmp-reverse-1-solve\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#flagcmp-reverse-1-solve\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"FlagCMP (Reverse, 1 solve)\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"Thanks to modern technologies we finally have a crossplatform way to check that your flag is, indeed, correct.\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://flagcmp-b8f9ceaf86d7846a.brics-ctf.ru/\",children:\"https://flagcmp-b8f9ceaf86d7846a.brics-ctf.ru/\"})}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/C4T-BuT-S4D/bricsctf-2023-stage1/tree/master/tasks/rev/flagcmp\",children:\"Attachment & official solution\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"first-analysis\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#first-analysis\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"First Analysis\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We are given a zip file which contains a folder with docker container and sources for local testing. It contains the \",(0,n.jsx)(e.code,{children:\"app.js\"}),\" backend, which basically just renders a template or invokes the \",(0,n.jsx)(e.code,{children:\"flagcmp.run\"}),\" method if you give it some string.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Looking at the \",(0,n.jsx)(e.code,{children:\"impl.js\"}),\" which defines said run method we see that it first passes the string to wasm, then calls the wasm \",(0,n.jsx)(e.code,{children:\"run\"}),\" method and takes whatever we write to the first argument (as an address) as pointer/length to a string.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Generally there\\u2019s a lot of strings (which are just a \",(0,n.jsx)(e.code,{children:\"char*\"}),\" and an \",(0,n.jsx)(e.code,{children:\"int\"}),\" to store where and how long it is). There are also vectors, which are two pointers and some other various representations.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"But well first of all we need to see the wasm code, I did so by using \",(0,n.jsx)(e.a,{href:\"https://github.com/nneonneo/ghidra-wasm-plugin\",children:\"nneoneo\\u2019s wasm plugin\"}),\". This immediatly tells us where the exported run method is, also the \",(0,n.jsx)(e.code,{children:\"set_flag\"}),\" method, which is called inside \",(0,n.jsx)(e.code,{children:\"app.js\"}),\" with the flag from the environment vars.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"encoding-the-input\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#encoding-the-input\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Encoding the input\"]}),`\n`,(0,n.jsx)(e.p,{children:`By looking how we call the run method we see the first argument is a return pointer, the second the char pointer and the last the size. We can see that we have a string constructor as first thing in the wasm implementation. It\nuses the char pointer and size to construct the string. We then pass in the string (as two args) into the flag checking function. After that we free the string, move the result string from the check into the output and write the result pointer. (At least that\\u2019s what normal code generation would do, so I just assumed it was like that.)`}),`\n`,(0,n.jsxs)(e.p,{children:[\"Then in the check function we first construct a new datatype (might be a vector or an iterator), which is then moved and used as argument to another function. I just assumed that this is another string constructor, however it turns out that it might\\u2019ve been a \",(0,n.jsx)(e.code,{children:\"Program\"}),\" constructor, compiling the \",(0,n.jsx)(e.code,{children:\"String\"}),\" from befunge to bytecode.\"]}),`\n`,(0,n.jsxs)(\"details\",{children:[(0,n.jsx)(\"summary\",{children:\"Spoiler alert\"}),(0,n.jsx)(e.p,{children:\"The whole thing is basically just a befunge VM.\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Then we create a program buffer, where we insert the opcode \",(0,n.jsx)(e.code,{children:\"0xe\"}),\", then the instance we created earlier using our input (aka the compiled befunge), followed by another \",(0,n.jsx)(e.code,{children:\"0xe\"}),\". Then it inserts the flag checking portion (which is generated in the \",(0,n.jsx)(e.code,{children:\"set_flag\"}),\" method, not really relevant how exactly it\\u2019s done, but basically it first has to create a constant for every char, for some reason it does not use befunges string mode here which would always be 3 opcodes but instead goes the extra mile to calculate the values using mathematical operations. Then for every char it inserts the constant generating code followed by a subtract and negate and finally a mult with whatever is at memory \",(0,n.jsx)(e.code,{children:\"0,0\"}),\". Effectively building an and gate out of all the negated differences).\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Finally in the program it inserts opcoded \",(0,n.jsx)(e.code,{children:\"0x118\"}),\" (push 1) and \",(0,n.jsx)(e.code,{children:\"0x12\"}),\" (which outputs the popped value as an int). This output does not seem to be used. Then we insert some lazy static value (which seems to generate the constant 10) and output that as a character (so a newline).\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Then the final bytecode is pushed which loads the value at \",(0,n.jsx)(e.code,{children:\"0,0\"}),\" and outputs that as an int and terminates the program.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"formatting-the-input\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#formatting-the-input\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Formatting the input\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Now with the input in the program we need to convert the 1D string of bytecode into a 2D string of befunge. To do so we just create a 80 by 25 array and then set our position to \",(0,n.jsx)(e.code,{children:\"0,0\"}),\" with deltax being 1. Then we start inserting our bytecode. At the last position in the first row, 79, we insert the opcode 10 to go to the next row, negate deltax and move a row down. There we first insert the opcode 7 or 8 (right / left) to change the direction accordingly. If we run out of space in the 80x25 we exit without output, which allows us to leak the flag length by just sending chars until we don\\u2019t get any more output and then do some math (basically just calculating how many operations are used if we don\\u2019t use any input, then do 2000-input-x to get the amount of instructions to encode the flag). Sadly because of the special encoding of the constants this yields a not entirely accurate result, as such I first got approximatly 58 characters.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Anyhow, after we fill the array we allocate a string, then pass in the array and the string into a constructor for the VM, which sets x,y to zero, moving direction to the right, sets the state to normal execution and the output string to the string we just allocated. The struct looks something like this:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"language-c code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Instruction\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" opcode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" extra_data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// for 0x18 and 0x19 (push ascii and push digit)\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// size == 2\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"VM\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    Instruction \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"prog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    string unused_but_probably_input_string\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    string output_string\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    random rng_instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// used for the random opcode which makes us move in a random direction\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" dx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" dy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Then we just call the step function, if that returns false we break or we stop if we hit 200,000 instructions executed. Else we just execute the bytecode. I have already mentioned a few opcodes, but here\\u2019s them all:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`0  => a = pop(); b = pop(); push(b + a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`1  => a = pop(); b = pop(); push(b - a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`2  => a = pop(); b = pop(); push(b * a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`3  => a = pop(); b = pop(); if(a == 0) return 0; push(b / a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`4  => a = pop(); b = pop(); if(a == 0) return 0; push(b % a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`5  => a = pop(); push(!a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`6  => a = pop(); b = pop(); push(a < b)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`7  => dx, dy =  1,  0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`8  => dx, dy = -1,  0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`9  => dx, dy =  0,  1\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`a  => dx, dy =  0, -1\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`b  => dx, dy = directions[randint(0, 3)]; // directions = [(1,0),(-1,0),(0,-1),(0,1)]\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`c  => dx, dy = (1 if pop() == 0 else -1), 0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`d  => dx, dy = 0, (1 if pop() == 0 else -1)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`e  => state = 1\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`f  => dup => a = pop(); push(a); push(a)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`10 => swap => a = pop(); b = pop(); push(a); push(b)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`11 => pop => pop()\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`12 => outputint => output += int(pop())\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`13 => outputchar => output += chr(pop())\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`14 => Bridge => skip next field\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`15 => Get => push(mem[(pop(), pop())]) # pops might be in wrong order\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`16 => Put => mem[(pop(), pop())] = pop() # pops might be in wrong order\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`17 => End => exit vm\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`18 => const Number => high byte contains value\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`19 => const Char => high byte contains value\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Apart from the const char all the instructions are actually in order in a single string you can find using strings on the wasm binary\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`AddSubtractMultiplyDivideModuloNotGreaterRightLeftUpDownRandomHorizontalIfVerticalIfStringModeDupSwapPopOutputIntOutputCharBridgeGetPutEndNumber\n`})})}),`\n`,(0,n.jsx)(e.p,{children:\"Which obviously was found before I looked through all the opcode handlers...\"}),`\n`,(0,n.jsx)(e.p,{children:\"After the execution is done we just check the output string. I don\\u2019t know the exact details, but it looks like it splits it at newlines, then uses the first to check the size of the second, but at this point I didn\\u2019t bother to see how this check specifically works, until I get the flag (or the program which encodes the flag) in the output string.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"the-exploit\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#the-exploit\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"The exploit\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Well now we just have to somehow inject some befunge. Imagine wasting time trying to use non-ascii chars (which get filtered by the js) or by pushing out the flag checking part such that the last row will go into the string data and execute it as code (which does not work due to multiple reasons, easiest being that the input string is encoded using \",(0,n.jsx)(e.code,{children:\"0x18\"}),\").\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Well as it turns out I already spoiled the exploit and well it\\u2019s actually really easy. We can just send the code we want. I eventually noticed that if we send \",(0,n.jsx)(e.code,{children:'\"@'}),\" we don\\u2019t get any output (by bruteforcing chars basically). Then looking at the bytecode generated revealed that it was indeed just executing the input as code.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"So all we had to do was to get the program, we can just write a short for loop to get the program like this:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" pwn \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" requests \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` post\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"URL \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"https://flagcmp-b8f9ceaf86d7846a.brics-ctf.ru\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'#URL = \"http://localhost:80\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"prog \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" j \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"25\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:`b'\"'`}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# escape\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"//\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"'}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"9*\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'+\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# x coord\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" j\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" j\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"//\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"'}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"9*\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:'+\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# y coord\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:\"b'''1.52*,g,@'''\"}),\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# don't know if necessary, but do the same thing as the original by printing 1 then newline and then the read char\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"+\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"%2b\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# goddam url encode\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        guess \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"7\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" post\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"URL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"             headers\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Content-Type\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"application/x-www-form-urlencoded\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"             data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"guess=\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),`guess\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`content\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"result\"'}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            result \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"Comparison result: \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"split\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"</span>\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            prog \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),` result\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"prog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"This will slowly print the program row-by-row. Luckily for us this already deals with the encoding being zig-zag as we get the actual program. Unluckily this takes some time, however since I then need to interpret the program i figured i could just let it run and write the interpreter in the meantime. Like mentioned I assume that the first line is the length of the second line, however I didn\\u2019t confirm that, but if you want to optimize the befunge a bit feel free to.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Anyhow I finished this interpreter before I leaked the entire program:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"b'leaked prog'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# this goddamn html again\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"&quot;\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\\\\\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"&gt;\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\">\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"replace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'b\"&lt;\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"<\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# fill up to 2000 instructions\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\" \"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2000\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`\"\"\"\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`s = bytearray(s)\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`for r in range(2, 25, 2):\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`    for i in range(40):\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:`        s[80*r+i], s[80*r+79-i] = s[80*r+79-i],s[80*r+i]\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token triple-quoted-string string\",children:'\"\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"s \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"decode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ss \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"while\"}),\" ss\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ss\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    ss \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" ss\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"stack \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"str_mode \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"24\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"y \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"dx \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"dy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"flag \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'b\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"prev \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"while\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    o \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"y\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"80\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\"o\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" str_mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" o \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:`'\"'`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" str_mode \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"ord\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"continue\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" o \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"0123456789\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"match\"}),\" o\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:`'\"'`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"str_mode \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'*'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'+'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'/'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"//\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'-'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                prev \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" p8\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\".\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\",\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"g\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                flag \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),` prev\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"flag\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"p\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\":\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"!\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"append\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" stack\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"pop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"v\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                dx \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                dy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"<\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                dx \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                dy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\">\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                dx \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                dy \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"_\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"unimplemented:\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" o\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                exit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),` dx\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    y \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),` dy\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:['Which was enough to \"execute\" the program and give us the flag ',(0,n.jsx)(e.code,{children:\"brics+{c3rtif1ed_es0l4ng_expl0it_d3vel0per_c65596e73d72cac7}\"}),\".\"]})]})}}var y=b;return f;})();\n;return Component;","toc":[{"value":"FlagCMP (Reverse, 1 solve)","url":"#flagcmp-reverse-1-solve","depth":1},{"value":"First Analysis","url":"#first-analysis","depth":2},{"value":"Encoding the input","url":"#encoding-the-input","depth":2},{"value":"Formatting the input","url":"#formatting-the-input","depth":2},{"value":"The exploit","url":"#the-exploit","depth":2}],"frontMatter":{"readingTime":{"text":"13 min read","minutes":12.57,"time":754200,"words":2514},"slug":"bricsctf-quals-2023/flagcmp","fileName":"bricsctf-quals-2023/flagcmp.md","title":"BRICS+ CTF Quals 2023 – FlagCMP","date":"2023-09-26T00:00:00.000Z","draft":false,"authors":["thebadgod"],"tags":["BRICSCTF Quals 2023","Reverse","Wasm","VM"],"summary":"Wasm reversing; and pwning (kind of)"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.2,"time":12000,"words":40},"slug":["thebadgod"],"fileName":"thebadgod.md","name":"TheBadGod","avatar":"https://www.gravatar.com/avatar/17fe95d3ab94df64d28ff20042e58df3?d=identicon&s=256","specialties":["Reverse","Pwn","Web"],"github":"https://github.com/TheBadGod/","twitter":"https://twitter.com/HodelAaron","web":"https://spclr.ch/","linkedin":"https://www.linkedin.com/in/aaron-hodel-17a77415a/","member":true,"description":"I do rev, also sometimes studying.","order":12,"date":null}],"prev":{"title":"Intigriti 0823 – August XSS Challenge","date":"2023-08-29T00:00:00.000Z","draft":false,"authors":["iyed"],"tags":["Intigriti 0823","XSS","Web","JavaScript"],"summary":"Writeup for Intigriti August XSS challenge by huli.","slug":"intigriti-0823/writeup"},"next":{"title":"IrisCTF 2024 – Sharing is Caring","date":"2024-01-07T00:00:00.000Z","draft":false,"authors":["legoclones"],"tags":["IrisCTF 2024","Misc","RF","Networks"],"summary":"Use DS-CDMA to isolate multiple signals being sent over the same communication channel","canonical":"https://justinapplegate.me/2024/irisctf-sharingiscaring","slug":"irisctf-2024/sharing-is-caring"}},"__N_SSG":true}