{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of p(s))!m.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>s[e],enumerable:!(c=d(s,e))||c.enumerable});return a},g=a=>k(t(l(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((_,i)=>{i.exports=_jsx_runtime});var y={};N(y,{default:()=>w,frontmatter:()=>f});var n=g(o()),f={title:\"Knight CTF 2022 \\u2013 Most Secure Calculator\",date:\"2022-01-21\",draft:!1,authors:[\"blueset\"],tags:[\"Knight CTF 2022\",\"PHP\",\"eval\"],summary:\"Do not ever eval() user input, even you thought you have sanitized.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",br:\"br\",code:\"code\",pre:\"pre\",ul:\"ul\",li:\"li\",strong:\"strong\",ol:\"ol\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"most-secure-calculator-1-50-points\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#most-secure-calculator-1-50-points\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Most Secure Calculator 1 (50 points)\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Challenge Link: \",(0,n.jsx)(e.a,{href:\"http://198.211.115.81:9003/\",children:\"http://198.211.115.81:9003/\"}),(0,n.jsx)(e.br,{}),`\n`,\"Flag Format: \",(0,n.jsx)(e.code,{children:\"KCTF{something_here}\"}),(0,n.jsx)(e.br,{}),`\n`,\"Note: Burte Force/Fuzzing not required and not allowed.\",(0,n.jsx)(e.br,{}),`\n`,\"Author: NomanProdhan\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Webpage has a form with a text box and a submit button. The form sends a POST request to \",(0,n.jsx)(e.code,{children:\"/\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A comment is found in the HTML source of the webpage.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-html\",children:(0,n.jsxs)(e.code,{className:\"language-html code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`<!-- \n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`    Hi Selina, \n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`    I learned about eval today and tomorrow I will learn about regex. I have build a calculator for your child.\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`    I have hidden some interesting things in flag.txt and I know you can read that file.\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"-->\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"The webpage uses \",(0,n.jsx)(e.code,{children:\"eval\"}),\" to \\u201Cdo calculations\\u201D.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Flag is stored in \",(0,n.jsx)(e.code,{children:\"flag.txt\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Submit \",(0,n.jsx)(e.code,{children:'system(\"cat flag.txt\");'}),\" to get the flag.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"most-secure-calculator-2-250-points\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#most-secure-calculator-2-250-points\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Most Secure Calculator 2 (250 points)\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Challenge Link: \",(0,n.jsx)(e.a,{href:\"http://198.211.115.81:9004/\",children:\"http://198.211.115.81:9004/\"}),(0,n.jsx)(e.br,{}),`\n`,\"Flag Format: \",(0,n.jsx)(e.code,{children:\"KCTF{something_here}\"}),(0,n.jsx)(e.br,{}),`\n`,\"Note: Burte Force/Fuzzing not required and not allowed.\",(0,n.jsx)(e.br,{}),`\n`,\"Author: NomanProdhan\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Webpage has a form with a text box and a submit button. The form sends a POST request to \",(0,n.jsx)(e.code,{children:\"/\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A comment is found in the HTML source of the webpage.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`<!-- \n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    Hi Selina, \n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    I learned about regex today. I have upgraded the previous calculator. Now its the most secure calculator ever.\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    The calculator accepts only numbers and symbols. \n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    I have hidden some interesting things in flag.txt and I know you can create an interesting equation to read that file.\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`-->\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Again,\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"The webpage uses \",(0,n.jsx)(e.code,{children:\"eval\"}),\" to \\u201Cdo calculations\\u201D.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Filters are put in place to only accept \\u201Cnumbers and symbols\\u201D.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Flag is stored in \",(0,n.jsx)(e.code,{children:\"flag.txt\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Through trial and error, the following characters are found to be accepted:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`!\"#%'()*+,-./:;?@[\\\\]^_\\`{|}~0123456789\n`})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Specifically, \",(0,n.jsx)(e.code,{children:\"$\"}),\", \",(0,n.jsx)(e.code,{children:\"<\"}),\" and \",(0,n.jsx)(e.code,{children:\">\"}),\" are not accepted.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Vulnerabilities:\"})}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"PHP allows to use a string literal as a function name.\"}),`\n`,(0,n.jsx)(e.li,{children:\"PHP allows bit-wise XOR operation of strings.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Making use of feature 1, we can rewrite \",(0,n.jsx)(e.code,{children:'system(\"cat flag.txt\");'}),\" as \",(0,n.jsx)(e.code,{children:'(\"system\")(\"cat flag.txt\");'}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Making use of feature 2, we can construct the words \",(0,n.jsx)(e.code,{children:\"system\"}),\", \",(0,n.jsx)(e.code,{children:\"cat\"}),\", \",(0,n.jsx)(e.code,{children:\"flag\"}),\", and \",(0,n.jsx)(e.code,{children:\"txt\"}),\" using bit-wise XOR of 2 strings from the allowed character set.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For example, to construct the word \",(0,n.jsx)(e.code,{children:\"'sekai'\"}),\", we can have \",(0,n.jsx)(e.code,{children:\"'(%+!)' ^ '[@@@@'\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`(%+!)   00101000 00100101 00101011 00100001 00101001\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`     xor\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`[@@@@   01011011 01000000 01000000 01000000 01000000\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`      =\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`sekai   01110011 01100101 01101011 01100001 01101001\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"A Python script was written to find the XOR pairs and build the payload.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"chars \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"!#%()*+,-./:;?@[]^_`{|}~&0123456789\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ascii_chars \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"join\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"chr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"32\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"127\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"diff \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"set\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ascii_chars\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"set\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"chars\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"mapping \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" chars\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" j \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" chars\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        k \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"chr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"ord\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"^\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"ord\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" k \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" diff \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"and\"}),\" k \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" mapping\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            mapping\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"transform\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"mapping\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" c \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    b \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"mapping\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" c \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"(\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"repr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"join\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"^\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"repr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"join\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\")\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"_system \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" transform\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"system\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"_cat \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" transform\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"cat\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"_flag \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" transform\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"flag\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"_txt \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" transform\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"txt\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token string-interpolation\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'f\"'}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"_system\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"_cat\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\".' '.\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"_flag\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\".'.'.\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"_txt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:');\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Submit this payload to get the flag.\"})]})}}var w=b;return y;})();\n;return Component;","toc":[{"value":"Most Secure Calculator 1 (50 points)","url":"#most-secure-calculator-1-50-points","depth":2},{"value":"Most Secure Calculator 2 (250 points)","url":"#most-secure-calculator-2-250-points","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.445,"time":206700,"words":689},"slug":"knight-ctf-2021/most-secure-calculator","fileName":"knight-ctf-2021/most-secure-calculator.md","title":"Knight CTF 2022 – Most Secure Calculator","date":"2022-01-21T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Knight CTF 2022","PHP","eval"],"summary":"Do not ever eval() user input, even you thought you have sanitized."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null}],"prev":{"title":"Hello World","date":"2022-01-01T00:00:00.000Z","tags":["uncategorized"],"draft":false,"summary":"Welcome to WordPress. This is your first post.","slug":"hello-world"},"next":{"title":"Knight CTF 2022 – Find Pass Code","date":"2022-01-21T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Knight CTF 2022","PHP","Type juggling"],"summary":"Always use === if you can.","slug":"knight-ctf-2021/find-pass-code"}},"__N_SSG":true}