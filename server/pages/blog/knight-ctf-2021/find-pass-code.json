{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var r=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var m=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},N=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of r(s))!u.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>s[e],enumerable:!(c=d(s,e))||c.enumerable});return a},g=a=>N(t(l(a!=null?p(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var i=m((P,o)=>{o.exports=_jsx_runtime});var y={};k(y,{default:()=>w,frontmatter:()=>b});var n=g(i()),b={title:\"Knight CTF 2022 \\u2013 Find Pass Code\",date:\"2022-01-21\",draft:!1,authors:[\"blueset\"],tags:[\"Knight CTF 2022\",\"PHP\",\"Type juggling\"],summary:\"Always use === if you can.\"};function f(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",h3:\"h3\",blockquote:\"blockquote\",p:\"p\",br:\"br\",code:\"code\",pre:\"pre\",strong:\"strong\",em:\"em\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"find-pass-code-1-50-points\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#find-pass-code-1-50-points\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Find Pass Code 1 (50 points)\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"description\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#description\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Description\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Challenge Link: \",(0,n.jsx)(e.a,{href:\"http://find-pass-code-one.kshackzone.com/\",children:\"http://find-pass-code-one.kshackzone.com/\"}),(0,n.jsx)(e.br,{}),`\n`,\"Flag Format: \",(0,n.jsx)(e.code,{children:\"KCTF{something_here}\"}),(0,n.jsx)(e.br,{}),`\n`,\"Note: Burte Force/Fuzzing not required and not allowed.\",(0,n.jsx)(e.br,{}),`\n`,\"Author: NomanProdhan\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Webpage has a form with a text box and a submit button. The form sends a POST request to \",(0,n.jsx)(e.code,{children:\"/\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A comment is found in the HTML source of the webpage.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-html\",children:(0,n.jsxs)(e.code,{className:\"language-html code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`<!-- Hi Serafin, I learned something new today. \n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`I build this website for you to verify our KnightCTF 2022 pass code. You can view the source code by sending the source param\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"-->\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Visiting \",(0,n.jsx)(e.a,{href:\"https://find-pass-code-one.kshackzone.com/?source\",children:\"https://find-pass-code-one.kshackzone.com/?source\"}),\" gives the PHP source code.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-php\",children:(0,n.jsxs)(e.code,{className:\"language-php code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token delimiter important\",children:\"<?php\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"require\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"flag.php\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"isset\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"strcmp\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"echo\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string double-quoted-string\",children:['\"KCTF Flag : ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token variable\",children:\"$flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"echo\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"Oh....My....God. You entered the wrong pass code.<br>\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"isset\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_GET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"source\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"show_source\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"__FILE__\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token php language-php\",children:`\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token php language-php\",children:(0,n.jsx)(e.span,{className:\"token delimiter important\",children:\"?>\"})}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Vulnerability:\"}),\" When comparing non-string values, \",(0,n.jsx)(e.code,{children:\"strcmp()\"}),\" returns \",(0,n.jsx)(e.code,{children:\"null\"}),\", which is \",(0,n.jsx)(e.code,{children:\"== 0\"}),\" but not \",(0,n.jsx)(e.code,{children:\"=== 0\"}),\" in PHP. We need to make \",(0,n.jsx)(e.code,{children:'$_POST[\"pass_code\"]'}),\" a non-string value.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"One way to do this is to supply an array argument in the Post Payload.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`pass_code[]=value\n`})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"In this way, \",(0,n.jsx)(e.code,{children:'$_POST[\"pass_code\"]'}),\" will be assigned as \",(0,n.jsx)(e.code,{children:'array(0 => \"value\")'}),\", thus allowing us to bypass the check.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"find-pass-code-2-150-points\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#find-pass-code-2-150-points\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Find Pass Code 2 (150 points)\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Challenge Link: \",(0,n.jsx)(e.a,{href:\"http://find-pass-code-two.kshackzone.com/\",children:\"http://find-pass-code-two.kshackzone.com/\"}),(0,n.jsx)(e.br,{}),`\n`,\"Flag Format: \",(0,n.jsx)(e.code,{children:\"KCTF{something_here}\"}),(0,n.jsx)(e.br,{}),`\n`,\"Note: Burte Force/Fuzzing not required and not allowed.\",(0,n.jsx)(e.br,{}),`\n`,\"Author: NomanProdhan\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Webpage has a form with a text box and a submit button. The form sends a POST request to \",(0,n.jsx)(e.code,{children:\"/\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A comment is found in the HTML source of the webpage.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-html\",children:(0,n.jsxs)(e.code,{className:\"language-html code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`<!-- Hi Serafin, I think you already know how you can view the source code :P\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"-->\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Again, visiting \",(0,n.jsx)(e.a,{href:\"https://find-pass-code-two.kshackzone.com/?source\",children:\"https://find-pass-code-two.kshackzone.com/?source\"}),\" gives the PHP source code.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-php\",children:(0,n.jsxs)(e.code,{className:\"language-php code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token delimiter important\",children:\"<?php\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"require\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"flag.php\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_codes\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"array\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"0e215962017\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"0e730083352\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"0e807097110\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"0e840922711\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_flag\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant boolean\",children:\"false\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"isset\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"is_array\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"foreach\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_codes\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"as\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_code\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"===\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_code\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_flag\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"break\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token variable\",children:\"$old_pass_flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"echo\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:`\"Sorry ! It's an old pass code.\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"md5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_POST\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"pass_code\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"echo\"}),\" \",(0,n.jsxs)(e.span,{className:\"token string double-quoted-string\",children:['\"KCTF Flag : ',(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token variable\",children:\"$flag\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),'\"']}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"echo\"}),\" \",(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"Oh....My....God. You entered the wrong pass code.<br>\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"isset\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token global\",children:\"$_GET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string double-quoted-string\",children:'\"source\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"show_source\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"__FILE__\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token php language-php\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token php language-php\",children:`\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token php language-php\",children:(0,n.jsx)(e.span,{className:\"token delimiter important\",children:\"?>\"})}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Vulnerability:\"}),\" When comparing strings using \",(0,n.jsx)(e.code,{children:\"==\"}),\", PHP will try to attempt to parse the string as a number. Hence, strings like \",(0,n.jsx)(e.code,{children:'\"0e1\"'}),\" and \",(0,n.jsx)(e.code,{children:'\"0e2\"'}),\" will be considered as the value \",(0,n.jsx)(e.code,{children:\"0\"}),\" in scientific notation. We need to find a string which both the string itself and its MD5 hash match the pattern \",(0,n.jsx)(e.code,{children:\"0e[0-9]+\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"$old_pass_codes\"}),\" has blacklisted some known strings that have this property.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Searching online, \",(0,n.jsx)(e.em,{children:(0,n.jsx)(e.a,{href:\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Type%20Juggling/README.md\",children:\"PHP Juggling type and magic hashes\"})}),\" provided another string \\u2013 \",(0,n.jsx)(e.code,{children:\"0e1137126905\"}),\" \\u2013 that also has this property but not blacklisted.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Submitting this code, and we can get the flag.\"})]})}}var w=f;return y;})();\n;return Component;","toc":[{"value":"Find Pass Code 1 (50 points)","url":"#find-pass-code-1-50-points","depth":2},{"value":"Description","url":"#description","depth":3},{"value":"Find Pass Code 2 (150 points)","url":"#find-pass-code-2-150-points","depth":2}],"frontMatter":{"readingTime":{"text":"5 min read","minutes":4.09,"time":245400,"words":818},"slug":"knight-ctf-2021/find-pass-code","fileName":"knight-ctf-2021/find-pass-code.md","title":"Knight CTF 2022 – Find Pass Code","date":"2022-01-21T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Knight CTF 2022","PHP","Type juggling"],"summary":"Always use === if you can."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null}],"prev":{"title":"Knight CTF 2022 – Most Secure Calculator","date":"2022-01-21T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Knight CTF 2022","PHP","eval"],"summary":"Do not ever eval() user input, even you thought you have sanitized.","slug":"knight-ctf-2021/most-secure-calculator"},"next":{"title":"Insomni'hack teaser 2022 – PimpMyVariant","date":"2022-01-30T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Insomni'hack teaser 2022","Web","PHP","Serialize","XML","XXE","JWT"],"summary":"Host header, XXE, JWT, and serialization.","slug":"insomni-hack-teaser-2022/pimpmyvariant"}},"__N_SSG":true}