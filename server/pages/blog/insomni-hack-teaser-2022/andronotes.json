{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var c=Object.create;var s=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>s(a,\"__esModule\",{value:!0});var g=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports),f=(a,t)=>{i(a);for(var o in t)s(a,o,{get:t[o],enumerable:!0})},u=(a,t,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let n of h(t))!m.call(a,n)&&n!==\"default\"&&s(a,n,{get:()=>t[n],enumerable:!(o=l(t,n))||o.enumerable});return a},b=a=>u(i(s(a!=null?c(p(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=g((_,d)=>{d.exports=_jsx_runtime});var w={};f(w,{default:()=>N,frontmatter:()=>x});var e=b(r()),x={title:\"Insomni'hack teaser 2022 \\u2013 AndroNotes\",date:\"2022-01-30\",draft:!1,authors:[\"blueset\"],tags:[\"Insomni'hack teaser 2022\",\"Forensics\",\"Android\"],summary:\"A rooted Android phone could be handy sometimes.\"};function y(a={}){let{wrapper:t}=a.components||{};return t?(0,e.jsx)(t,Object.assign({},a,{children:(0,e.jsx)(o,{})})):o();function o(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",br:\"br\",code:\"code\",pre:\"pre\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"andronotes\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#andronotes\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"AndroNotes\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"by Dai\"}),`\n`,(0,e.jsx)(n.p,{children:\"Our Forensic experts dumped the mobile device of a criminal, can you identify what the thugs are up to...\"}),`\n`,(0,e.jsx)(n.p,{children:\"This challenge can be solved offline.\"}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://static.insomnihack.ch/media/dump-23a51cd1a485489bc9913641c06de94f85cd2a358b573f965ce59d928acb6297.img\",children:\"dump.img\"}),(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(n.a,{href:\"https://mega.nz/file/SDpCxIwb#YI7BP2P22Pya75n_gx86bwX5Ic5U9qcL2lGAE1_2JHo\",children:\"mirror of dump.img\"})]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Mounting the IMG, we can see an entire Android filesystem.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Looking at the SMS database (SQLite) at \",(0,e.jsx)(n.code,{children:\"/data/data/com.android.providers.telephony/databases/mmssms.db\"}),\", we can find the following messages:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`sqlite> select * from sms;\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`1|3|6505551212||1640171169759|1640171169000|0|1|-1|1|0||Hi James, I've configured the server please keep the password in a safe place mate! The website contains sensitive information about mrna-1273!\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Best||0|1|0|com.google.android.apps.messaging|1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2|3|6505551212||1640171277362|0||1|-1|2|||Hi H, it is in my Safe Note app. One of the most secure with military grade encryption mechanisms. \\u{1F4AF}\\u{1F4AF}||0|1|-1|com.google.android.apps.messaging|1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`3|3|6505551212||1640171303660|1640171303000|0|1|-1|1|0||Nice, Funds are Safu !||0|1|0|com.google.android.apps.messaging|1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`4|3|6505551212||1640171330546|0||1|-1|2|||\\u{1F61C}\\u{1F637}\\u{1F911}\\u{1F468}\\u200D\\u{1F52C}||0|1|-1|com.google.android.apps.messaging|1\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"The second message is referring to the \",(0,e.jsx)(n.a,{href:\"https://play.google.com/store/apps/details?id=com.protectedtext.android&hl=en_US&gl=US\",children:\"Safe Notes\"}),\" app which is also installed in the dumped device.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Install the app on a rooted Android device, write some notes, and observe the data folder of the app (\",(0,e.jsx)(n.code,{children:\"/data/data/com.protectedtext.android\"}),\"), it is easy to see that the notes are encrypted and stored in \",(0,e.jsx)(n.code,{children:\"shared_prefs/com.protectedtext.n2.xml\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Look for the same file in the dump image, copy it over and overwrite it on your device and restart the app. The flag can be found a note in the app.\"})]})}}var N=y;return w;})();\n;return Component;","toc":[{"value":"AndroNotes","url":"#andronotes","depth":2}],"frontMatter":{"readingTime":{"text":"2 min read","minutes":1.205,"time":72300,"words":241},"slug":"insomni-hack-teaser-2022/andronotes","fileName":"insomni-hack-teaser-2022/andronotes.md","title":"Insomni'hack teaser 2022 – AndroNotes","date":"2022-01-30T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Insomni'hack teaser 2022","Forensics","Android"],"summary":"A rooted Android phone could be handy sometimes."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.21,"time":12600,"words":42},"slug":["blueset"],"fileName":"blueset.md","name":"Eana","avatar":"https://www.gravatar.com/avatar/bee48ae645948fe70368ae0fb73ee2b2?d=identicon&s=256","specialties":["Misc","Web"],"web":"https://1a23.com/","twitter":"https://twitter.com/blueset","github":"https://github.com/blueset","description":"A Vocaloid (and other singing synth) fan.","order":1,"member":true,"date":null}],"prev":{"title":"Insomni'hack teaser 2022 – ExPiltration","date":"2022-01-30T00:00:00.000Z","draft":false,"authors":["blueset"],"tags":["Insomni'hack teaser 2022","Misc","Python","CV","Video","Binary"],"summary":"Leak data via LED lights.","slug":"insomni-hack-teaser-2022/expiltration"},"next":{"title":"Insomni'hack teaser 2022 – Vault","date":"2022-01-31T00:00:00.000Z","draft":false,"authors":["thebish0p"],"tags":["Insomni'hack teaser 2022","Web","Prototype Pollution","SQLi","Error Based Injection","JavaScript","JSON"],"summary":"Prototype pollution which allows to run arbitrary js in admin context and retrieve the flag through the sql injection with an error based injection.","slug":"insomni-hack-teaser-2022/vault"}},"__N_SSG":true}