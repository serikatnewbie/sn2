{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!h.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>s[e],enumerable:!(c=p(s,e))||c.enumerable});return a},G=a=>k(t(l(a!=null?r(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((y,i)=>{i.exports=_jsx_runtime});var b={};N(b,{default:()=>C,frontmatter:()=>T});var n=G(o()),T={title:\"Insomni'hack teaser 2022 \\u2013 DrJeb\",date:\"2022-01-31\",draft:!1,authors:[\"thebish0p\"],tags:[\"Insomni'hack teaser 2022\",\"Misc\",\"Git\",\"OSINT\"],summary:\"Git repo secret.\"};function A(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",pre:\"pre\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"drjeb\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#drjeb\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"DrJeb\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsx)(e.p,{children:\"by 123Soleil\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Dr. Jeb was able to analyze the virus in depth. He believes in the power of open source so his disassembler is publicly available \",(0,n.jsx)(e.a,{href:\"https://github.com/doctor-jebaited/research\",children:\"here\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"It's time to check his research with \",(0,n.jsx)(e.a,{href:\"https://static.insomnihack.ch/media/VirusINC-2f2decd2db45ea7368eeab89d0134afce30254f7f7f4e6a0d6d5e7ff91618569.png\",children:\"practice\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The GitHub repository provided explains how to use the \",(0,n.jsx)(e.code,{children:\"Virus Disassembler\"}),\" by providing it an image of the virus:\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`python3 VirusDisassembler.py virus.png\n`})})}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" numpy \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"as\"}),` np\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" PIL \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` Image\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sys\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Very important\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" doctorsecret\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"const \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` SECRET\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Dissasemble\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"img_path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    img \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"open\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"img_path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'r'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" np\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"array\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"list\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"img\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"getdata\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"SECRET\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tot_pixels \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tmp_bits \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" p \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tot_pixels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        tmp_bits \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"bin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tmp_bits \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        newchar \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"chr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),` newchar\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` message\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"__main__\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"argv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Example: python3 VirusDissasembler.py <image_path>\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"Dissasemble\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"argv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"After running the script and providing it the image we get a weird output as shown below:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`D:\\\\CTF\\\\Insomni>python VirusDisassembler.py virus.png\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`J\\xC8u)\\xAF$\\xE6\\xB6\\xB6:f\\u21A8c\\xA8\\xB3\\x94#[}\\xA5\\xF4\\xF6\\x90q\\u25AC$\\xC4\\u2193;\\u25B2\\xA5\\xE4\\xAD\\x80\\x92z\\xF9\\u221F1l?\\xCC\\xCC1\\u263B\\xC4(=\\\\\\xA3\\xA8k \\xF5\\xE0\\\\\\x8D\\xB9\\xC9\\xAE\\xD0Z#\\xC4\\xC9\\u26424\\xA4\\x88\\x87\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:` \\xE0\\xEAgM\\x99\\xD3Q\\xA1T\\xA7\\xBD1X'\\x8A5V'\\u2642P\\u263B^\\x89\\x81{\\u2191\\u2642]H\\xBE\\x87\\x9C\\xD2\\x9E\\xC2\\xE6\\xCF\\x8C_\\x97\\xBB\\xE0\\u2191I@\\xA8g2$\\xDCP\\u2194\\xD2\\xD0W)X\\u2665*d\\xD1\\u2195\\xA7L\\x81\\xC0r\\x86@\\xCA\\u25B2\\x83\\xD4[\\u2642)\\xB0o\\xF6\\xBC\\xD8\\xE3\\xE1M\\xB7g^x\\x9CQ=SL\\xC1\\xE4\\xBB\\xF8\\xC1G\\xA7\\xA5\\u25B2\\xC4\\xDA\\xD3\\xFE?\\xEB\\xB9\\x8B\\u2642\\x96:J\\x89y\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:\"5\\xA0\\xA9|\\x9B\\xB2\\xA3x\\xB4>g\\u2302k=>\\xA4\\xF2\\xAE?\\xD0\\xA8\\xF5Y&\\xC1\\xF0\\xF7\\x8A{\\x99\\xFC\\xB5\\xD4\\xC9\\u25AC8\\xA5)\\xE0\\xF1\\u25B2#DX\\x87\\x88\\xA0>I)\\xDC$\\x8DC\\xF4\\xF5z\\xA9\\xEFb\\xE8\\x8B\\xD9\\x8B#\\u2666\\x9B\\x9F\\x91\\x8Br$\\xF1v\\x95\\x93\\xDE\\xDB\\u263A)\\xA4\\xAAG\\u263B\\u266Bl\\u2663\\xA4J\\x8D\\x93\\x9Ao\\xC6\\xC7\\xB4:\\xC7\\xD2\\x95w\\xEF\\xFB\\x9Cv\\x8D\\x93\\xCF\\x98\\u221F\\x89)^\\xAF\\x80x\\xA7\\u25BA6&%\\xC6\\u2193\\xDEG\\xAD\\xAD ~\\x8A\\x8AX\\xB5\\u2191b\\x86\\xE3\\x87\\x98\\xCC^8\\u21A8\\xFFP\\xCD\\xA0L\\x89\\x91\\xB1\\x92x\\xE88\\xED\\u2660\\xF4(0`n\\u25BA\\xF9d\\xA7zG\\xD0 k\\xB2\\xBF@/\\xD7\\xB7l_M(\\xFE\\xF3\\xECY\\x94\\x98\\x84S\\xC6\\xDF=\\xBA\\u2642nt|\\xA19\\x94t\\xF8{\\xA5:\\xCB\\xB8`Z\\xFA\\xED\\x9C\\x88=P\\x8D\\x84iwi\\xF8\\xF7\\xF1\\xBDR\\xA5\\xEA\\xB4\\u2666\\xF8\\x95\\xBB\\xAF\\xC8r*Cs\\xD5\\x84\\xD4\\u2665b\\xF8\\xF9\\xFFd\\xB8\\u263B\\xD17\\xD5\\xCC\\xE6\\x91\\xB1\\n\"}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2665\\u2190\\u2666\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:\"\\xEB\\xDB\\xE6\\xCF|j}\\x95\\xAB\\u221F\\xAB\\x8D|28\\xE8\\xE8)\\xC10A\\xF2\\xAD\\x90\\xD0\\u221Fd\\xFA3\\x92cJ\\xB3fd\\xDD\\u266B\\xB4#\\xE6\\xFE\\u25AC\\xBC\\xFE\\xC6N\\xF9%(\\xED\\xA3\\x9D\\x9C\\xB6\\xA2hub\\xFA\\x83\\u25AC\\x9B\\xB0\\xCC\\u2302g\\xE0\\xD9\\xCA;\\xC5,1\\xEF\\u263A\\u2666H\\xBB\\xB72\\xE7\\xA1\\xA5\\xEC\\xF1\\xF1\\xB1\\xB6\\xD4/\\xB7\\xD9]\\u263BU4)\\x8B6 a=\\x97\\xC2v\\xF2\\u2642\\x98\\xE7\\x87\\xAC\\x92\\x97\\xBC\\xA7\\u25AC \\xAD\\u26639u`\\xA9\\u2190\\xB6)\\xF3\\u21A8J\\xB7\\u2194\\u263A\\xAA   C\\xA3\\xA1\\u2193b\\u266B\\xE7l\\n\"}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\xB80\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:\"q\\xCA\\xDB\\x9B\\xEB2`\\xA9q\\xA1gN\\xED\\xDC4\\xE6\\x9F\\xD0\\xEE[\\u2191L\\u2302-$P\\u203C)\\xA4\\xC0\\u2193\\u25BC\\xD3\\u25B2!\\xB8vGY\\xCA\\xD5=\\xA1L\\x9F}\\xB2 \\xCD\\xAF\\x8A\\xCB\\u2191(\\u2193\\x9C\\xF4\\x96\\x9D\\xA7\\xC5~h\\xC1 \\x89\\xC8%\\xC6#!P\\xCC+\\xF7\\xD3G/\\xA1\\xC1\\xF3\\xF7Fm%k\\xB2\\u2666\\x90\\xB0\\xF5\\xA7e\\xF9\\x9F\\xE1\\u25BC\\xB5T\\xC8\\xC7:;\\xE3o<e\\u2666\\xAD\\xC6\\x88o0\\xC7\\xDF\\xF6;o\\xE3c\\xD9\\xAC\\xBC'\\xC0\\xF7\\xD6\\xABpi\\xAD\\xE6\\xEB\\xFD\\u2302\\xED\\xD7~\\xBF\\xF7\\xEC?G\\x91t\\xEE%\\xC2<\\xB7\\xA8\\xD4~[\\xED\\xEC\\u25BC\\xA3\\xFF\\xB2^N\\xEF\\xB9o\\xAC\\xB1\\x96z\\xE4\\xDE\\u25BC\\xB7\\xF0?\\xFF\\xE2\\xFB\\x9F\\xDF\\xF0\\xF4\\xFBUK\\xA9U'\\xB4_\\xAF\\xA0v\\x9E\\xC3\\xDE~\\xCF\\xD1\\xF5>\\x87\\xC2\\xF2\\u25BC\\u203C\\xE0\\xFF_\\xEB\\xFC\\u2302\\xE7\\xEC\\x9F\\u2660\\xF3\\xFD?\\xF4\\xF2\\xBF\\xF7\\xCA\\xF1\\\\\\xBA\\xC5Z\\xEBEH-'\\x84\\xF1\\x9E\\x93\\x90|_\\xC3\\xF1~/)\\xF0?7\\xE2\\xF0\\xDC\\n\"}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Q\\xE6,e\\x98\\xB7\\x86\\xD0\\x8E\\x92\\x92JIXI l%E\\xBA\\xD5N\\xB3]H\\x8DQ\\xE3?g\\xCC\\xFD\\u2194#\\xF6\\u2302\\x8F\\xB9\\xC7=\\xE7\\xD8\\xF3\\xBFG\\xCE\\xBD\\xDB#\\xE5\\xE8\\x8D[\\xA3pn\\x8C\\u2660\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We notice that in the \",(0,n.jsx)(e.code,{children:\"requirements.txt\"}),\" there is a secret repo:\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`numpy\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`# My years of research are contained in this doctorsecret package\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`git+https://github.com/doctor-jebaited/secret1234.git@f464e6774efe95ff3fc0fdf7464659240cfff09f\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"By accessing \",(0,n.jsx)(e.code,{children:\"https://github.com/doctor-jebaited/secret1234/blob/master/doctorsecret/\"}),\" we can see a \",(0,n.jsx)(e.code,{children:\"const.py\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"SECRET \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"133\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"GetSecret\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` SECRET\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"We replace the \",(0,n.jsx)(e.code,{children:\"SECRET\"}),\" in our script to \",(0,n.jsx)(e.code,{children:\"133\"}),\", run it again and get the flag:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-python\",children:(0,n.jsxs)(e.code,{className:\"language-python code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" numpy \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"as\"}),` np\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" PIL \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` Image\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` sys\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Very important\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" doctorsecret\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"const \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),` SECRET\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Dissasemble\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"img_path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    img \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"open\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"img_path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'r'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" np\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"array\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"list\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"img\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"getdata\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"133\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tot_pixels \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"shape\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tmp_bits \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" p \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tot_pixels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        tmp_bits \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"bin\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"p\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tmp_bits \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"range\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        newchar \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"chr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tmp_bits\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        message \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),` newchar\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` message\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"__main__\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"len\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"argv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Example: python3 VirusDissasembler.py <image_path>\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"print\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"Dissasemble\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sys\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"argv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`D:\\\\CTF\\\\Insomni>python VirusDisassembler.py virus.png\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`ATAATGATAATCGATGTTTATGCGCCTGCGGATCATAACTAAAATAAATTCTCAAAAGTACAACGGGTTTCGCGGCGAAGGATTACACACACGGATGGTGGCCGAGCGGTTTATAGTTATTTTCCCATCGGGGATACGTCCGAAATTCATCACTGAGGGGAGTCTCTCAGTCCACCGGACGTCAAGATCGCAGGTGGCTCAGACTACGAGGGTGTCGTTCATGGGTGGAGCCTGTTCGTCTGACCTTAGGCTGTGACTCAGCAAGACATGGTCTCGAGTTCGTCGTTCAGTAGGCGAGGGGCINS{W3LCOME_2o22_1NS0_B3_Car3fuL}GGAAAGTAAGACGTCAGTGTCCTTCTGCTTAGCTCCTAAGGTATGCCGTCTGTTAGTATGTTGCAGAGACTGACTCCGAGAACATCACGATATTCTTGACTATGCGAAAGTGAAGCGACACCTCGGATGGATTCCAGGACTCCGTATTTCCACGTGAAGACCATTGAGAGCGGGGTTCATTGAGAGTGAGGAGGTCTCAAAACGGTGTAATTTAACGACACTGATTGATTTCCGAGCCTCTGAGTGCCAACGACTACATTTTAAGTCCCATGACATCGGACCGAAATGTACGTCCCTCCAAT\n`})]})})]})}}var C=A;return b;})();\n;return Component;","toc":[{"value":"DrJeb","url":"#drjeb","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.485,"time":209100,"words":697},"slug":"insomni-hack-teaser-2022/drjeb","fileName":"insomni-hack-teaser-2022/drjeb.md","title":"Insomni'hack teaser 2022 – DrJeb","date":"2022-01-31T00:00:00.000Z","draft":false,"authors":["thebish0p"],"tags":["Insomni'hack teaser 2022","Misc","Git","OSINT"],"summary":"Git repo secret."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.18,"time":10800,"words":36},"slug":["thebish0p"],"fileName":"thebish0p.md","name":"thebish0p","avatar":"https://www.gravatar.com/avatar/4bbe2c02b2eb4589f0ef3c2d0e39a640?d=identicon&s=256","specialties":["Web"],"linkedin":"https://linkedin.com/in/eliemoutran","github":"https://github.com/eliemoutran","member":true,"retired":true,"description":"Security, Programming and Mathematics","order":2,"date":null}],"prev":{"title":"Insomni'hack teaser 2022 – Vault","date":"2022-01-31T00:00:00.000Z","draft":false,"authors":["thebish0p"],"tags":["Insomni'hack teaser 2022","Web","Prototype Pollution","SQLi","Error Based Injection","JavaScript","JSON"],"summary":"Prototype pollution which allows to run arbitrary js in admin context and retrieve the flag through the sql injection with an error based injection.","slug":"insomni-hack-teaser-2022/vault"},"next":{"title":"DICE CTF 2022 – knock-knock","date":"2022-02-06T00:00:00.000Z","draft":false,"authors":["thebish0p"],"tags":["DICE CTF 2022","Web","Crypto","JavaScript","Signature"],"summary":"Make sure to call your functions :)","slug":"dice-ctf-2022/knock"}},"__N_SSG":true}