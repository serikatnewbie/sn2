{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var c=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var l=i=>c(i,\"__esModule\",{value:!0});var u=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports),g=(i,a)=>{l(i);for(var s in a)c(i,s,{get:a[s],enumerable:!0})},f=(i,a,s)=>{if(a&&typeof a==\"object\"||typeof a==\"function\")for(let n of h(a))!p.call(i,n)&&n!==\"default\"&&c(i,n,{get:()=>a[n],enumerable:!(s=r(a,n))||s.enumerable});return i},N=i=>f(l(c(i!=null?d(m(i)):{},\"default\",i&&i.__esModule&&\"default\"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var t=u((T,o)=>{o.exports=_jsx_runtime});var w={};g(w,{default:()=>b,frontmatter:()=>y});var e=N(t()),y={title:\"UT CTF 2023 \\u2013 What Time Is It?\",date:\"2023-03-12\",draft:!1,authors:[\"legoclones\"],tags:[\"UTCTF 2023\",\"Forensics\",\"Email\"],summary:\"Decode a timestamp hidden in Gmail Content-Type boundary to determine the time the email was sent.\",canonical:\"https://justinapplegate.me/2023/utctf-whattimeisit/\"};function v(i={}){let{wrapper:a}=i.components||{};return a?(0,e.jsx)(a,Object.assign({},i,{children:(0,e.jsx)(s,{})})):s();function s(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",blockquote:\"blockquote\",p:\"p\",code:\"code\",h3:\"h3\",pre:\"pre\",strong:\"strong\"},i.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"what-time-is-it-forensics-911-points\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#what-time-is-it-forensics-911-points\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"What Time Is It? (Forensics, 911 Points)\"]}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Super Secure Company\\u2019s database was recently breached. One of the employees self reported a potential phishing event that could be related. Unfortunately, our Linux email server does not report receiving any emails on March 2, 2023.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Can you identify when this email was actually sent? The flag format is \",(0,e.jsx)(n.code,{children:\"utflag{MM/DD/YYYY-HH:MM}\"}),\" in UTC time.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"By Aadhithya (@aadhi0319 on Discord)\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Attachment: \",(0,e.jsx)(n.a,{href:\"https://raw.githubusercontent.com/Legoclones/website/main/source/static/utctf-whattimeisit/phishing.eml\",children:\"phishing.eml\"}),\".\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"initial-analysis\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#initial-analysis\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Initial Analysis\"]}),`\n`,(0,e.jsx)(n.p,{children:\"The provided phishing EML file looked like this:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`MIME-Version: 1.0\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Date: Thu, 2 Mar 2023 03:12:42 +0000\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Message-ID: <CAODBzaAPrwTP=oDe6fkOv1a7LApXzv1m+YrYG9RHZM7tbBJRbw@mail.gmail.com>\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Subject: Critical Security Incident - Action Required ASAP!\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`From:  Security Division <admin-notifications@supersecurecompany.com>\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`To: Jim Browning <jim.browning@supersecurecompany.com>\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Content-Type: multipart/alternative; boundary=\"00000000000093882205f60cdcdb\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--00000000000093882205f60cdcdb\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Content-Type: text/plain; charset=\"UTF-8\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Jim,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`We have reason to believe that your Google account may have been\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`compromised. Please login as soon as possible at the following link in\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`order to secure your account. Thank you for your cooperation and swift\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`action to address this issue. Please feel free to reply to this email if\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`you have any questions. Do not email IT about this email as they are not in\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`the loop on account authorization issues.\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`https://supersecurecompany.gooogle.com/login/\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Sincerely,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Security Division\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Super Secure Company\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--00000000000093882205f60cdcdb\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Content-Type: text/html; charset=\"UTF-8\"\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Content-Transfer-Encoding: quoted-printable\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`<div dir=3D\"ltr\"><div dir=3D\"ltr\"><div dir=3D\"ltr\"><div dir=3D\"ltr\"><div di=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`r=3D\"ltr\"><div dir=3D\"ltr\"><div dir=3D\"ltr\"><div>Jim,</div><div><br></div><=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`div>We have reason to believe that your=20\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Google account may have been compromised. Please login as soon as=20\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`possible at the following link in order to secure your account. Thank=20\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`you for your cooperation and swift action to address this issue. Please=20\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`feel free to reply to this email if you have any questions. Do not email\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:` IT about this email as they are not in the loop on account=20\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`authorization issues.</div><div><br></div><div><a href=3D\"https://supersecu=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`recompany.gooogle.com/login/\">https://supersecurecompany.gooogle.com/login/=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`</a><br></div><div><br></div><div>Sincerely,</div><div>Security Division</d=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`iv><div>Super Secure Company<br></div></div></div></div></div></div></div><=\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`/div>\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--00000000000093882205f60cdcdb--\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"The flag is just when the email was sent. There\\u2019s a \",(0,e.jsx)(n.code,{children:\"Date\"}),\" header in the email, but it was too obvious (and wasn\\u2019t correct when I tried). After scanning the whole file, I figured the forensics trick was to reverse engineer some seemingly random text to determine when it was sent. There were only 2 pieces of information that fit into this category - the \",(0,e.jsx)(n.code,{children:\"Content-Type boundary\"}),\", and the \",(0,e.jsx)(n.code,{children:\"Message-ID\"}),\" header.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Doing a quick Google Search, I found \",(0,e.jsx)(n.a,{href:\"https://www.metaspike.com/dates-gmail-message-id-thread-id-timestamps/\",children:\"this great article\"}),\" about hiding timestamps in Gmail Message IDs. However, after looking through other articles and rereading this one a few times, I realized it wouldn\\u2019t work. One line says:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`Please note that the Gmail Message ID of a message is different than its Message-Id\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`header field which might look something like this:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Message-Id: <13eba327.EAAAAO8sA-QAAcgxWv4AAAd9o_wAAAAIijYAAAAAAAYklQBfFbYb@mailjet.com>\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"We had the Gmail message ID, which is different than the actual \",(0,e.jsx)(n.code,{children:\"Message-ID\"}),\" header, which is why the decoding process didn\\u2019t work.\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"boundary-timestamp\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#boundary-timestamp\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Boundary Timestamp\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Turning to the other piece of information, I found that \",(0,e.jsx)(n.a,{href:\"https://www.metaspike.com/gmail-mime-boundary-delimiter-timestamps/\",children:\"Part 2 in the series of the above article\"}),\" was actually about hidden timestamps in Gmail \",(0,e.jsx)(n.code,{children:\"Content-Type\"}),\" boundaries. The decoding process was fairly easy.\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`Given --> 00000000000093882205f60cdcdb\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`1. Extract numbers:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Part 1 --> 938822 (first 6 non-0 hex chars)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    Part 2 --> 05f60cdc (next 8 hex chars)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`2. Append Part 1 to Part 2:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    05f60cdc938822\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`3. Convert to decimal\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    0x05f60cdc938822 = 1677909984249890\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`4. Convert to timestamp (using epochconverter.com)\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    1677909984249890 = Saturday, March 4, 2023 6:06:24.249 AM\n`})]})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Flag:\"}),\" \",(0,e.jsx)(n.code,{children:\"utflag{03/04/2023-06:06}\"})]})]})}}var b=v;return w;})();\n;return Component;","toc":[{"value":"What Time Is It? (Forensics, 911 Points)","url":"#what-time-is-it-forensics-911-points","depth":2},{"value":"Initial Analysis","url":"#initial-analysis","depth":3},{"value":"Boundary Timestamp","url":"#boundary-timestamp","depth":3}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.06,"time":183600,"words":612},"slug":"utctf-2023/whattimeisit","fileName":"utctf-2023/whattimeisit.md","title":"UT CTF 2023 – What Time Is It?","date":"2023-03-12T00:00:00.000Z","draft":false,"authors":["legoclones"],"tags":["UTCTF 2023","Forensics","Email"],"summary":"Decode a timestamp hidden in Gmail Content-Type boundary to determine the time the email was sent.","canonical":"https://justinapplegate.me/2023/utctf-whattimeisit/"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.26,"time":15600,"words":52},"slug":["legoclones"],"fileName":"legoclones.md","name":"Legoclones","avatar":"https://www.gravatar.com/avatar/a6122f35bdc157fb5e76ef5f3de833a2?d=identicon&s=256","specialties":["Reverse","Web"],"twitter":"https://twitter.com/legoclones","github":"https://github.com/Legoclones","web":"https://justinapplegate.me","member":true,"description":"Just a simple man trying to make my way in the universe","order":16,"date":null}],"prev":{"title":"UT CTF 2023 – Zipper","date":"2023-03-12T00:00:00.000Z","draft":false,"authors":["legoclones"],"tags":["UTCTF 2023","Misc","Zip"],"summary":"Craft a malicious Zip file with identically-named files to bypass a filter and get RCE.","canonical":"https://justinapplegate.me/2023/utctf-zipper/","slug":"utctf-2023/zipper"},"next":{"title":"WolvCTF 2023 – WannaFlag Series","date":"2023-03-20T00:00:00.000Z","draft":false,"authors":["enscribe"],"tags":["WolvCTF 2023","OSINT"],"summary":"Hunting down a flag-stealing ransomware group—from Ethereum breadcrumbs to TF2 maps.","canonical":"https://enscribe.dev/ctfs/wolv23/osint/wannaflag/","slug":"wolvctf-2023/wannaflag"}},"__N_SSG":true}